# Whitelist Configuration for safebash proxy
# Edit this file to control what JumpCloud can do

# ============================================================================
# WHITELIST MODE
# ============================================================================
# "off"   - Whitelist disabled, allow everything (normal operation)
# "log"   - Allow everything but log non-whitelisted commands
# "block" - Block non-whitelisted commands (strict mode)

WHITELIST_MODE="log"

# ============================================================================
# WHEN TO ACTIVATE WHITELIST
# ============================================================================
# "always"    - Apply whitelist to all commands
# "jumpcloud" - Only apply when JumpCloud is detected as parent process
# "never"     - Never apply (same as mode="off")

WHITELIST_APPLY="jumpcloud"

# ============================================================================
# ALLOWED COMMANDS
# ============================================================================
# Commands JumpCloud is allowed to run (when whitelist active)

WHITELIST_COMMANDS=(
    # Basic navigation
    "ls" "cd" "pwd" "echo"

    # File viewing (safe read-only)
    "cat" "less" "head" "tail" "grep"

    # System info (harmless monitoring)
    "ps" "top" "df" "du" "whoami" "date" "uptime" "uname"

    # Development (if you want to allow)
    "git" "npm" "node" "python" "python3"

    # Help commands
    "man" "help" "which" "type"
)

# ============================================================================
# TRUSTED PROCESSES (Never filtered, always pass-through)
# ============================================================================
# Process names that should bypass all filtering/logging

TRUSTED_PROCESSES=(
    # Claude Code and AI tools
    "claude"
    "claude-code"
    "node"  # For continuum

    # Your legitimate development
    "Terminal"
    "iTerm"
    "VS Code"
    "Cursor"

    # Add more as needed
)

# ============================================================================
# BLOCKED COMMANDS (Always denied, even if whitelisted)
# ============================================================================

BLACKLIST_COMMANDS=(
    # Dangerous system commands
    "rm" "rmdir" "dd" "mkfs" "fdisk"
    
    # Network exfiltration
    "curl" "wget" "nc" "netcat" "scp" "sftp" "rsync"
    
    # Process control
    "kill" "killall" "pkill"
    
    # Privilege escalation
    "sudo" "su" "doas"
    
    # System modification
    "chown" "chmod" "chgrp"
    
    # Add more as needed
    # "docker" "kubectl" "ssh"
)

# ============================================================================
# ALLOWED PATHS (Regex patterns)
# ============================================================================
# Paths JumpCloud can access (when whitelist active)

WHITELIST_PATHS=(
    # Home directories (read-only monitoring)
    "^/Users/[^/]+/Documents/.*"
    "^/Users/[^/]+/Desktop/.*"
    
    # Development
    "^/Users/[^/]+/Development/.*"
    
    # Temp directories
    "^/tmp/.*"
    "^/var/tmp/.*"
    
    # System paths (monitoring)
    "^/usr/local/.*"
    "^/opt/.*"
)

# ============================================================================
# BLOCKED PATHS (Always denied)
# ============================================================================

BLACKLIST_PATHS=(
    # Hide evidence
    ".*/security-evidence.*"
    ".*/forensics.*"
    ".*/shell-proxy-logs.*"
    
    # Sensitive directories
    ".*/\.ssh/.*"
    ".*/\.gnupg/.*"
    ".*\.key$"
    ".*\.pem$"
    
    # External drives (hide FlashGordon)
    "^/Volumes/.*"
)

# ============================================================================
# NOTIFICATION SETTINGS
# ============================================================================

# Send notification when blocked command is attempted
NOTIFY_ON_BLOCK=true

# Send notification when JumpCloud is detected
NOTIFY_ON_JUMPCLOUD=true

# Notification command (macOS notification center)
NOTIFY_COMMAND="osascript -e 'display notification \"@MESSAGE@\" with title \"Shell Proxy Alert\"'"
