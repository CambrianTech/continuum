{
  "version": 3,
  "sources": ["../../package.json", "../types/shared/ConsoleTypes.ts", "../types/shared/core/ContinuumTypes.ts", "../daemons/logger/shared/ConsoleTypes.ts", "../daemons/logger/shared/LoggerMessageTypes.ts", "../daemons/logger/client/ClientLoggerDaemon.ts", "../daemons/logger/client/ClientLoggerClient.ts", "../daemons/logger/client/ClientConsoleManager.ts", "continuum-browser-client/console/ConsoleForwarder.ts", "continuum-browser-client/connection/WebSocketManager.ts", "../parsers/shared/ParserBase.ts", "../parsers/integrations/cli-parser/shared/CLIParserTypes.ts", "../parsers/integrations/cli-parser/client/CLIClientParser.ts", "../commands/core/base-command/parsers/IntegrationParser.ts", "../commands/core/base-command/parsers/CLIIntegrationParser.ts", "../commands/core/base-command/parsers/JSONIntegrationParser.ts", "../commands/core/base-command/parsers/PersonaMeshParser.ts", "../commands/core/base-command/parsers/MCPIntegrationParser.ts", "../commands/core/base-command/parsers/index.ts", "../commands/core/base-command/BaseCommand.ts", "../commands/file/shared/FileTypes.ts", "../commands/file/shared/BaseFileCommand.ts", "../commands/file/shared/FileValidator.ts", "../commands/file/client/FileClient.ts", "../commands/file/fileSave/client/FileSaveClient.ts", "../commands/browser/screenshot/shared/ScreenshotBase.ts", "../commands/browser/screenshot/client/ScreenshotClient.ts", "continuum-browser-client/ContinuumBrowserClient.ts", "components/shared/WidgetServerControls.ts", "continuum-browser-client/error/GlobalErrorHandler.ts", "components/shared/BaseWidget.ts", "components/ActiveProjects/ActiveProjectsWidget.ts", "components/shared/UniversalUserSystem.ts", "components/shared/RoomDataManager.ts", "components/Chat/ChatWidget.ts", "components/ChatRoom/ChatRoom.ts", "components/Continuon/ContinuonWidget.ts", "components/Persona/PersonaWidget.ts", "../types/shared/WidgetServerTypes.ts", "components/SavedPersonas/SavedPersonasWidget.ts", "components/SessionCosts/SessionCostsWidget.ts", "components/Sidebar/SidebarWidget.ts", "components/SidebarHeader/SidebarHeader.ts", "components/SidebarPanelWidget/SidebarPanelWidget.ts", "components/SidebarTabs/SidebarTabs.ts", "components/UsersAgents/UsersAgentsWidget.ts", "components/Version/VersionWidget.ts", "widget-discovery:widget-discovery", "continuum-browser-client/index.ts"],
  "sourcesContent": ["{\n  \"name\": \"continuum\",\n  \"version\": \"0.2.3187\",\n  \"description\": \"Designed by AI and humans for AI and humans - A standard protocol for configuring AI assistants to work consistently with codebases\",\n  \"main\": \"src/core/continuum-core.cjs\",\n  \"bin\": {\n    \"continuum\": \"./continuum\"\n  },\n  \"type\": \"module\",\n  \"workspaces\": [\n    \"packages/*\"\n  ],\n  \"scripts\": {\n    \"compile\": \"npx tsc --noEmit --project .\",\n    \"start\": \"npm run log:npm-start manual && npm run compile && npm run build:browser-ts && ./continuum\",\n    \"jtag\": \"npm run log:npm-start jtag-command && npm start && echo '' && echo '\uD83D\uDEF8 JTAG System Ready' && echo '  continuum help jtag              # Show available JTAG methods' && echo '  continuum jtag                   # Default JTAG probe'\",\n    \"test:jtag\": \"cd src/debug/jtag && npm test\",\n    \"test:jtag:layer\": \"cd src/debug/jtag && npm run test:layer-\",\n    \"install:global\": \"node scripts/install.js\",\n    \"prepare\": \"husky\",\n    \"postinstall\": \"lerna run prepare\",\n    \"build:browser-ts\": \"npm run clean:all && npm run version:bump && rm -f src/ui/continuum-browser.js* && node scripts/build-browser.cjs\",\n    \"build:browser-hot\": \"npm run version:bump && rm -f src/ui/continuum-browser.js* && node scripts/build-browser.cjs\",\n    \"build:ui-components\": \"tsc --project tsconfig.ui.json\",\n    \"build:ui\": \"tsc --project tsconfig.ui.json\",\n    \"dev:browser\": \"npm run build:browser-ts -- --watch\",\n    \"dev:ui\": \"npm run build:ui-components -- --watch\",\n    \"test\": \"echo 'WARNING_legacy system, cd into src/debug/jtag IMMEDIATELY!' && npm run compile && npm run test:unit && npm run test:integration:layer2-3\",\n    \"test:integration:layer2-3\": \"npm run test:integration:eventbus && npm run test:integration:routing && npm run test:integration:html && npm run test:integration:wildcard && npm run test:integration:types && npm run test:integration:modules && npm run test:integration:browser-manager\",\n    \"test:full\": \"npx tsx src/system/testing/test/universal-layer-runner.ts\",\n    \"test:layer\": \"npx tsx src/system/testing/test/universal-layer-runner.ts --layer=\",\n    \"test:widgets\": \"npx tsx src/testing/IntelligentModularTestRunner.ts widget\",\n    \"test:daemons\": \"npx tsx src/testing/IntelligentModularTestRunner.ts daemon\",\n    \"test:chatroom\": \"npx tsx src/daemons/chatroom/test/run-tests.ts\",\n    \"test:chatroom:unit\": \"npx tsx --test src/daemons/chatroom/test/unit/ChatRoomDaemon.test.ts\",\n    \"test:chatroom:integration\": \"npx tsx --test src/daemons/chatroom/test/integration/ChatRoomDaemon.integration.test.ts\",\n    \"test:commands\": \"npx tsx src/testing/IntelligentModularTestRunner.ts command\",\n    \"test:compliance\": \"npx tsx src/testing/ModuleComplianceReport.ts --use-whitelist\",\n    \"test:compliance:strict\": \"npx tsx src/testing/ModuleComplianceReport.ts --exit-on-failure\",\n    \"test:compliance:details\": \"npx tsx src/testing/ModuleComplianceReport.ts --use-whitelist --details\",\n    \"test:compliance:incremental\": \"npx tsx src/testing/IncrementalComplianceTracker.ts --track-history\",\n    \"test:compliance:focus\": \"npx tsx src/testing/IncrementalComplianceTracker.ts\",\n    \"test:compliance:graduation\": \"npx tsx src/testing/ModuleGraduationTracker.ts\",\n    \"test:compliance:next\": \"npx tsx src/testing/ModuleGraduationTracker.ts --suggest\",\n    \"test:eslint:graduation\": \"npx tsx src/testing/ESLintGraduationTracker.ts\",\n    \"test:eslint:next\": \"npx tsx src/testing/ESLintGraduationTracker.ts --suggest\",\n    \"test:quality:commit\": \"npx tsx src/testing/QualityEnforcementEngine.ts --commit\",\n    \"test:quality:push\": \"npx tsx src/testing/QualityEnforcementEngine.ts --push\",\n    \"fix:command-compliance\": \"node scripts/fix-command-compliance.js\",\n    \"fix:command-compliance:dry-run\": \"node scripts/fix-command-compliance.js --dry-run\",\n    \"test:integration:all\": \"npm run test:integration:eventbus && npm run test:integration:routing && npm run test:integration:html && npm run test:integration:wildcard && npm run test:integration:types && npm run test:integration:modules\",\n    \"test:integration:eventbus\": \"npx tsx --test src/test/integration/DaemonEventBus.integration.test.ts\",\n    \"test:integration:routing\": \"npx tsx --test src/test/integration/CommandRouting.integration.test.ts\",\n    \"test:integration:html\": \"npx tsx --test src/test/integration/HTMLRendering.integration.test.ts\",\n    \"test:integration:wildcard\": \"npx tsx --test src/test/integration/WildcardRouting.integration.test.ts\",\n    \"test:integration:types\": \"npx tsx --test src/test/integration/TypeSafety.integration.test.ts\",\n    \"test:integration:modules\": \"npx tsx --test src/test/integration/DaemonModuleStructure.integration.test.ts\",\n    \"test:integration:browser-manager\": \"npx tsx --test src/daemons/browser-manager/test/integration/BrowserManager.integration.test.ts\",\n    \"test:unit:browser-manager\": \"npx tsx --test src/daemons/browser-manager/test/unit/BrowserTabAdapter.test.ts\",\n    \"test:system\": \"npx tsx --test src/test/integration/DaemonSystem.integration.test.ts\",\n    \"test:layer4\": \"npx tsx --test src/test/integration/SystemIntegration.layer4.test.ts\",\n    \"test:unit\": \"npm run test:unit:js && npm run test:unit:python\",\n    \"test:unit:js\": \"npm run test:unit:browser-manager\",\n    \"test:unit:python\": \"echo 'Python unit tests pending configuration'\",\n    \"test:integration\": \"npm run test:integration:js && npm run test:integration:python && npm run test:browser\",\n    \"test:integration:js\": \"jest __tests__/integration --testPathPattern='\\\\.(js|cjs|ts)$' --config __tests__/config/jest.config.cjs\",\n    \"test:integration:python\": \"cd __tests__ && python3 -m pytest integration -v -c config/pytest.ini\",\n    \"test:functional\": \"jest __tests__/functional --config __tests__/config/jest.config.cjs && cd __tests__ && python3 -m pytest functional -v -c config/pytest.ini\",\n    \"test:comprehensive\": \"jest __tests__/comprehensive --config __tests__/config/jest.config.cjs && cd __tests__ && python3 -m pytest comprehensive -v -c config/pytest.ini\",\n    \"test:critical\": \"jest __tests__/critical --config __tests__/config/jest.config.cjs\",\n    \"test:screenshot\": \"node __tests__/config/test-runner.cjs screenshot\",\n    \"test:websocket\": \"npx tsx src/testing/ModularTestRunner.ts integration\",\n    \"test:browser\": \"npx tsx --test src/daemons/browser-manager/test/integration/BrowserManager.integration.test.ts\",\n    \"test:visual\": \"npx tsx src/ui/test/VisualBrowserIntegration.ts\",\n    \"test:ai\": \"jest __tests__/integration/ai --config __tests__/config/jest.config.cjs\",\n    \"test:ui\": \"jest __tests__/integration/ui --testPathPattern='\\\\.(js|cjs|ts)$' --config __tests__/config/jest.config.cjs && cd __tests__ && python3 -m pytest integration/ui -v -c config/pytest.ini\",\n    \"test:watch\": \"jest --watch --config __tests__/config/jest.config.cjs\",\n    \"test:coverage\": \"npm run test:coverage:js && npm run test:coverage:python\",\n    \"test:coverage:js\": \"jest --coverage --config __tests__/config/jest.config.cjs\",\n    \"test:coverage:python\": \"cd __tests__ && python3 -m pytest --cov=../src --cov=../python-client/continuum_client --cov-report=html --cov-report=term -c config/pytest.ini\",\n    \"log:npm-start\": \"npx tsx src/monitoring/build-logger.ts npm-start\",\n    \"log:build\": \"npx tsx src/monitoring/build-logger.ts build\",\n    \"log:git-hook\": \"npx tsx src/monitoring/build-logger.ts git-hook\",\n    \"log:browser\": \"npx tsx src/monitoring/build-logger.ts browser\",\n    \"log:show\": \"npx tsx src/monitoring/build-logger.ts show\",\n    \"build\": \"npm run clean:all && npm run build:browser-ts && npm run lint && node check-imports.cjs && npm run test\",\n    \"lint\": \"eslint . --ext .ts,.js --config eslint.config.js\",\n    \"format\": \"prettier --write \\\"**/*.{js,ts,json,md}\\\"\",\n    \"ci\": \"./scripts/test-ci.sh\",\n    \"validate-schema\": \"node scripts/validate-schema.js\",\n    \"check-deps\": \"npm audit --production && npm outdated\",\n    \"version:patch\": \"npm version patch --no-git-tag-version\",\n    \"version:minor\": \"npm version minor --no-git-tag-version\",\n    \"version:major\": \"npm version major --no-git-tag-version\",\n    \"publish:dev\": \"lerna publish --dist-tag dev --no-push --no-git-tag-version\",\n    \"build:packages\": \"npm run build --workspaces\",\n    \"test:packages\": \"npm run test --workspaces\",\n    \"lint:packages\": \"npm run lint --workspaces\",\n    \"demo\": \"npx ts-node demo-complete-system.ts\",\n    \"test-system\": \"npx jest tests/integration-full-system.test.ts\",\n    \"version:bump\": \"npm version patch --no-git-tag-version\",\n    \"clean\": \"scripts/clean-sessions.sh\",\n    \"clean:all\": \"scripts/clean-sessions.sh --all\",\n    \"build:clean\": \"scripts/clean-sessions.sh && npm run build\"\n  },\n  \"keywords\": [\n    \"ai\",\n    \"configuration\",\n    \"protocol\",\n    \"assistant\",\n    \"claude\",\n    \"gpt\",\n    \"gemini\",\n    \"llama\",\n    \"mistral\",\n    \"meta\",\n    \"anthropic\",\n    \"openai\",\n    \"google\",\n    \"copilot\",\n    \"standardization\",\n    \"cognitive-systems\",\n    \"contextual\",\n    \"devops\",\n    \"devsecops\"\n  ],\n  \"author\": \"Cambrian Technologies\",\n  \"license\": \"MIT\",\n  \"devDependencies\": {\n    \"@babel/core\": \"^7.27.4\",\n    \"@babel/plugin-proposal-class-properties\": \"^7.18.6\",\n    \"@babel/plugin-proposal-decorators\": \"^7.27.1\",\n    \"@babel/plugin-transform-class-properties\": \"^7.27.1\",\n    \"@babel/preset-env\": \"^7.27.2\",\n    \"@babel/preset-typescript\": \"^7.27.1\",\n    \"@types/jest\": \"^29.5.14\",\n    \"@types/node\": \"^22.15.29\",\n    \"@typescript-eslint/eslint-plugin\": \"^8.29.1\",\n    \"@typescript-eslint/parser\": \"^8.29.1\",\n    \"babel-jest\": \"^29.7.0\",\n    \"eslint\": \"^9.24.0\",\n    \"husky\": \"^9.1.7\",\n    \"jest\": \"^29.5.0\",\n    \"jest-environment-jsdom\": \"^29.7.0\",\n    \"lerna\": \"^8.2.1\",\n    \"prettier\": \"^3.5.3\",\n    \"supertest\": \"^7.1.1\",\n    \"ts-jest\": \"^29.3.4\",\n    \"tsx\": \"^4.20.3\",\n    \"typescript\": \"^5.8.3\"\n  },\n  \"engines\": {\n    \"node\": \">=20.0.0\"\n  },\n  \"continuum\": {\n    \"quality\": {\n      \"enforcement\": {\n        \"commit\": \"warn\",\n        \"push\": \"strict\"\n      },\n      \"schema\": {\n        \"version\": \"1.0.0\",\n        \"description\": \"Quality standards are now configured per-module in their package.json files\",\n        \"documentation\": \"See src/types/ModuleQualitySchema.ts for the complete schema definition\"\n      }\n    }\n  },\n  \"dependencies\": {\n    \"@anthropic-ai/sdk\": \"^0.52.0\",\n    \"ajv\": \"^8.17.1\",\n    \"dotenv\": \"^16.5.0\",\n    \"glob\": \"^11.0.1\",\n    \"html2canvas\": \"^1.4.1\",\n    \"inquirer\": \"^12.5.2\",\n    \"jsdom\": \"^26.1.0\",\n    \"node-fetch\": \"^3.3.2\",\n    \"node-notifier\": \"^10.0.1\",\n    \"openai\": \"^5.0.1\",\n    \"punycode\": \"^2.3.1\",\n    \"systray\": \"^1.0.5\",\n    \"ws\": \"^8.18.3\",\n    \"yaml\": \"^2.7.1\"\n  }\n}\n", "/**\n * Shared Console Types\n * \n * Used by both browser and server for consistent console log forwarding\n * Enhanced with proper object serialization to prevent [object Object] issues\n */\n\nexport namespace Console {\n  /**\n   * Console log levels\n   */\n  export enum Level {\n    ERROR = 'error',\n    WARN = 'warn', \n    INFO = 'info',\n    LOG = 'log',\n    DEBUG = 'debug',\n    TRACE = 'trace',\n    TABLE = 'table',\n    GROUP = 'group',\n    GROUP_END = 'groupEnd',\n    PROBE = 'probe'\n  }\n\n  /**\n   * AI Probe interface for diagnostic logging\n   */\n  export interface ProbeData {\n    /** Human-readable probe description */\n    message: string;\n    /** Structured data for analysis */\n    data?: Record<string, unknown>;\n    /** Optional JavaScript code to execute and capture result */\n    executeJS?: string;\n    /** Base64 encoded JavaScript for wire transmission (internal use) */\n    executeJSBase64?: string;\n    /** Probe category (ai-diagnostic, performance, error-trace, etc.) */\n    category?: string;\n    /** Tags for filtering and organization */\n    tags?: string[];\n  }\n\n  /**\n   * Properly typed console arguments that can be JSON serialized\n   */\n  export type ConsoleArgument = \n    | string \n    | number \n    | boolean \n    | null \n    | undefined\n    | ObjectArgument\n    | ConsoleArgument[];\n\n  /**\n   * Object arguments are JSON serialized for wire transfer\n   */\n  export interface ObjectArgument {\n    type: 'object';\n    value: Record<string, unknown>;\n    stringRepresentation: string;\n    originalType: string;\n  }\n\n  /**\n   * Console log entry that gets sent from browser to server\n   */\n  export interface LogEntry {\n    level: Level;\n    message: string;\n    arguments: ConsoleArgument[];\n    timestamp: string;\n    source?: string;\n    sessionId?: string;\n    metadata?: {\n      url?: string;\n      userAgent?: string;\n      stackTrace?: string;\n      lineNumber?: number;\n      columnNumber?: number;\n      fileName?: string;\n      viewportWidth?: number;\n      viewportHeight?: number;\n      timestamp?: string;\n    };\n  }\n\n  /**\n   * Server response to console log forwarding\n   */\n  export interface LogResponse {\n    success: boolean;\n    timestamp: string;\n    sessionLogged: boolean;\n    error?: string;\n  }\n\n  /**\n   * Utility class for console message processing\n   */\n  export class MessageUtils {\n    \n    /**\n     * Properly serialize a console argument for wire transfer\n     */\n    static serializeArgument(arg: unknown): ConsoleArgument {\n      if (arg === null) return null;\n      if (arg === undefined) return undefined;\n      \n      const argType = typeof arg;\n      \n      if (argType === 'string' || argType === 'number' || argType === 'boolean') {\n        return arg as ConsoleArgument;\n      }\n      \n      if (Array.isArray(arg)) {\n        return arg.map(item => this.serializeArgument(item));\n      }\n      \n      if (argType === 'object') {\n        try {\n          // Special handling for Error objects to capture stack trace\n          if (arg instanceof Error) {\n            return {\n              type: 'object',\n              value: {\n                name: arg.name,\n                message: arg.message,\n                stack: arg.stack,\n                cause: (arg as any).cause // Error.cause is ES2022, use any for compatibility\n              },\n              stringRepresentation: `${arg.name}: ${arg.message}\\n${arg.stack || 'No stack trace available'}`,\n              originalType: '[object Error]'\n            };\n          }\n          \n          const jsonString = JSON.stringify(arg, null, 2);\n          return {\n            type: 'object',\n            value: arg as Record<string, unknown>,\n            stringRepresentation: jsonString,\n            originalType: Object.prototype.toString.call(arg)\n          };\n        } catch (error) {\n          // Fallback for non-serializable objects (circular references, etc.)\n          return {\n            type: 'object',\n            value: {},\n            stringRepresentation: `[${Object.prototype.toString.call(arg)}]`,\n            originalType: Object.prototype.toString.call(arg)\n          };\n        }\n      }\n      \n      // Fallback for functions, symbols, etc.\n      return String(arg);\n    }\n    \n    /**\n     * Convert console arguments to a readable string with proper object formatting\n     */\n    static argumentsToString(args: ConsoleArgument[]): string {\n      return args.map(arg => {\n        if (arg === null) return 'null';\n        if (arg === undefined) return 'undefined';\n        \n        if (typeof arg === 'object' && arg !== null) {\n          if (Array.isArray(arg)) {\n            return `[${arg.map(item => this.argumentsToString([item])).join(', ')}]`;\n          }\n          \n          if ('type' in arg && arg.type === 'object') {\n            return arg.stringRepresentation;\n          }\n        }\n        \n        return String(arg);\n      }).join(' ');\n    }\n    \n    /**\n     * Create a properly formatted console log entry\n     */\n    static createLogEntry(\n      level: Level,\n      args: unknown[],\n      metadata?: Partial<LogEntry['metadata']>\n    ): LogEntry {\n      const serializedArgs = args.map(arg => this.serializeArgument(arg));\n      \n      // First argument is typically the main message\n      const mainMessage = serializedArgs.length > 0 ? this.argumentsToString([serializedArgs[0]]) : '';\n      const additionalArgs = serializedArgs.slice(1);\n      \n      // Use provided stack trace if available, otherwise capture it\n      const stackTrace = metadata?.stackTrace || this.captureStackTrace();\n      const browserContext = this.captureBrowserContext();\n      \n      return {\n        level,\n        message: mainMessage,\n        arguments: additionalArgs,\n        timestamp: new Date().toISOString(),\n        metadata: {\n          stackTrace,\n          ...browserContext,\n          ...metadata\n        }\n      };\n    }\n    \n    /**\n     * Capture actual stack trace from current execution context\n     */\n    static captureStackTrace(): string {\n      try {\n        const error = new Error();\n        if (error.stack) {\n          // Remove our own utility functions from the stack trace\n          const lines = error.stack.split('\\n');\n          const filteredLines = lines.filter(line => \n            !line.includes('MessageUtils.captureStackTrace') &&\n            !line.includes('MessageUtils.createLogEntry') &&\n            !line.includes('ConsoleForwarder.forwardConsole') &&\n            !line.includes('ClientConsoleManager.forwardConsole') &&\n            !line.includes('ClientConsoleManager.') &&\n            !line.includes('ClientLoggerDaemon.') &&\n            !line.includes('console.log') &&\n            !line.includes('console.warn') &&\n            !line.includes('console.error') &&\n            !line.includes('console.info') &&\n            !line.includes('console.debug') &&\n            !line.includes('console.trace')\n          );\n          return filteredLines.join('\\n');\n        }\n      } catch (e) {\n        // Fallback if stack capture fails\n      }\n      return '';\n    }\n    \n    /**\n     * Capture comprehensive browser context\n     */\n    static captureBrowserContext(): Partial<LogEntry['metadata']> {\n      if (typeof window === 'undefined') {\n        return {};\n      }\n      \n      const context: Partial<LogEntry['metadata']> = {\n        url: window.location.href,\n        userAgent: navigator.userAgent,\n        fileName: window.location.pathname,\n        viewportWidth: window.innerWidth,\n        viewportHeight: window.innerHeight,\n        timestamp: new Date().toISOString()\n      };\n      \n      return context;\n    }\n  }\n}", "// ISSUES: 1 open, last updated 2025-07-14 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * \uD83D\uDD27 IMPROVEMENTS:\n * - [ ] Issue #1: Add SessionPaths and SessionStructure interfaces to ContinuumContext for better session directory management\n * - [ ] Issue #2: Implement UUID validation and generation utilities for sessionId consistency\n * - [ ] Issue #3: Refactor ContinuumContextFactory to use new UUID utilities\n * - [ ] Issue #4: Ensure all commands use the new ContinuumContext structure for session management\n * - [ ] Issue #5: Add comprehensive tests for ContinuumContextFactory and UUID utilities\n * - [ ] Issue #6: Document ContinuumContext structure and usage patterns for developers\n */\n\n// Browser-compatible UUID type - flexible to support both UUIDs and string IDs\nexport type UUID = string;\n\n// Browser-compatible UUID generation\nfunction generateUUID(): UUID {\n  if (typeof crypto !== 'undefined' && crypto.randomUUID) {\n    return crypto.randomUUID() as UUID;\n  } else {\n    // Fallback for browser environments\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      const r = Math.random() * 16 | 0;\n      const v = c === 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);\n    }) as UUID;\n  }\n}\n\n/**\n * Core execution environment type - fundamental to all Continuum operations\n * \n * Environment types define where code execution originates and drives log file naming:\n * - 'browser': Human user interactions through web interface \u2192 browser.log\n * - 'server': Local server-side operations and daemons \u2192 server.log  \n * - 'remote': Commands from other machines (git hooks, remote clients) \u2192 remote.log\n * - 'agent': External AI users (agent-based users like Claude) \u2192 agent.log\n * - 'persona': Internal AI personas/identities within Continuum \u2192 persona.log\n */\nexport type ContinuumEnvironment = 'browser' | 'server' | 'remote' | 'agent' | 'persona';\n\n/**\n * Stack frame for execution context tracking\n */\nexport interface ExecutionFrame {\n  environment: ContinuumEnvironment;\n  location: string; // Component, command, or daemon name\n  description?: string; // Human-readable description of this execution frame\n  timestamp: string;\n  metadata?: Record<string, unknown>;\n}\n\n// Common types for context properties\nexport interface WebSocketServer {\n  send: (message: unknown) => void;\n  broadcast: (message: unknown) => void;\n  clients: Set<unknown>;\n}\n\n/**\n * Session-based file paths following the established structure\n */\nexport interface SessionPaths {\n  base: string;\n  logs: string;\n  screenshots: string;\n  recordings: string;\n  files: string;\n  devtools: string;\n}\n\nexport interface ContinuumContext {\n  continuum?: ContinuumInstance;\n  webSocketServer?: WebSocketServer;\n  continuumStatus?: Record<string, unknown>;\n  sessionId: UUID;\n  userId?: string;\n  // Multi-session support\n  sessionType?: 'development' | 'production' | 'test';\n  sessionOwner?: string;\n  sessionStartTime?: string;\n  // Environment context (current execution environment)\n  environment?: ContinuumEnvironment;\n  // Execution stack for call tracing\n  executionStack?: ExecutionFrame[];\n  // Session paths for consistent file operations\n  sessionPaths?: SessionPaths;\n  // Extensible for future context needs\n  [key: string]: unknown;\n}\n\nexport interface ContinuumInstance {\n  version: string;\n  config: Record<string, unknown>;\n  daemons: Map<string, unknown>;\n  context: ContinuumContext;\n  // Multi-session support\n  sessions?: Map<string, ContinuumContext>;\n}\n\n/**\n * Context factory utilities for managing ContinuumContext instances\n */\n/**\n * UUID validation and generation utilities\n */\nexport const uuidValidator = {\n  /**\n   * Validate UUID format\n   */\n  validate: (uuid: string): uuid is UUID => {\n    return typeof uuid === 'string' && \n           uuid.length === 36 && \n           /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(uuid);\n  },\n  \n  /**\n   * Generate a new UUID\n   */\n  generate: (): UUID => generateUUID(),\n} as const;\n\nexport const continuumContextFactory = {\n  /**\n   * Create a new ContinuumContext with required fields\n   */\n  create: (options: {\n    sessionId?: UUID;\n    userId?: string;\n    sessionType?: 'development' | 'production' | 'test';\n    sessionOwner?: string;\n    environment?: ContinuumEnvironment;\n    [key: string]: unknown;\n  } = {}): ContinuumContext => ({\n    sessionId: options.sessionId ?? uuidValidator.generate(),\n    sessionStartTime: new Date().toISOString(),\n    ...options,\n  }),\n\n  /**\n   * Merge contexts with proper precedence\n   */\n  merge: (base: ContinuumContext, override: Partial<ContinuumContext>): ContinuumContext => ({\n    ...base,\n    ...override,\n    // Preserve critical fields\n    sessionId: override.sessionId ?? base.sessionId,\n  }),\n\n  /**\n   * Clone context with different environment\n   * Preserves session, user, and other context but changes execution environment\n   */\n  withEnvironment: (context: ContinuumContext, environment: ContinuumEnvironment): ContinuumContext => ({\n    ...context,\n    environment,\n  }),\n\n  /**\n   * Push new execution frame onto context stack\n   * Creates proper call stack trace through system layers\n   */\n  push: (context: ContinuumContext, frame: {\n    environment: ContinuumEnvironment;\n    location: string;\n    description?: string;\n    metadata?: Record<string, unknown>;\n  }): ContinuumContext => {\n    const newFrame: ExecutionFrame = {\n      ...frame,\n      timestamp: new Date().toISOString(),\n    };\n    \n    return {\n      ...context,\n      environment: frame.environment,\n      executionStack: [...(context.executionStack || []), newFrame],\n    };\n  },\n\n  /**\n   * Pop execution frame from context stack\n   * Returns to previous execution environment\n   */\n  pop: (context: ContinuumContext): ContinuumContext => {\n    const stack = context.executionStack || [];\n    if (stack.length === 0) {\n      return context;\n    }\n    \n    const newStack = stack.slice(0, -1);\n    const previousEnvironment = newStack.length > 0 ? newStack[newStack.length - 1].environment : context.environment;\n    \n    const result: ContinuumContext = {\n      ...context,\n      executionStack: newStack,\n    };\n    \n    if (previousEnvironment) {\n      result.environment = previousEnvironment;\n    }\n    \n    return result;\n  },\n\n  /**\n   * Validate that a context has required fields\n   */\n  validate: (context: unknown): context is ContinuumContext => {\n    if (typeof context !== 'object' || context === null) {\n      return false;\n    }\n    \n    const ctx = context as ContinuumContext;\n    if (typeof ctx.sessionId !== 'string' || ctx.sessionId === null) {\n      return false;\n    }\n    \n    // Use the UUID validation utility\n    return uuidValidator.validate(ctx.sessionId);\n  },\n} as const;", "/**\n * Unified Console Types - Shared between logger daemon and console forwarding\n * Consolidates console-related types to eliminate duplication\n */\n\nimport { ContinuumContext } from '../../../types/shared/core/ContinuumTypes';\n\n/**\n * Unified log levels for both console and logger daemon\n */\nexport type LogLevel = 'log' | 'debug' | 'info' | 'warn' | 'error' | 'trace' | 'probe';\n\n/**\n * Console log levels enum for backward compatibility\n */\nexport enum ConsoleLevel {\n  ERROR = 'error',\n  WARN = 'warn', \n  INFO = 'info',\n  LOG = 'log',\n  DEBUG = 'debug',\n  TRACE = 'trace',\n  PROBE = 'probe'\n}\n\n/**\n * Browser console override interface\n */\nexport interface OriginalConsole {\n  log: (...args: unknown[]) => void;\n  warn: (...args: unknown[]) => void;\n  error: (...args: unknown[]) => void;\n  info: (...args: unknown[]) => void;\n  debug: (...args: unknown[]) => void;\n  trace: (...args: unknown[]) => void;\n}\n\n/**\n * AI Probe interface for diagnostic logging\n */\nexport interface ProbeData {\n  /** Human-readable probe description */\n  message: string;\n  /** Structured data for analysis */\n  data?: Record<string, unknown>;\n  /** Optional JavaScript code to execute and capture result */\n  executeJS?: string;\n  /** Base64 encoded JavaScript for wire transmission (internal use) */\n  executeJSBase64?: string;\n  /** Probe category (ai-diagnostic, performance, error-trace, etc.) */\n  category?: string;\n  /** Tags for filtering and organization */\n  tags?: string[];\n}\n\n/**\n * Properly typed console arguments that can be JSON serialized\n */\nexport type ConsoleArgument = \n  | string \n  | number \n  | boolean \n  | null \n  | undefined\n  | Error\n  | Record<string, unknown>\n  | Array<unknown>;\n\n/**\n * Unified log entry interface\n */\nexport interface LogEntry {\n  level: LogLevel;\n  message: string;\n  timestamp: number;\n  sessionId: string;\n  source: string;\n  context: ContinuumContext;\n  data?: Record<string, unknown> | undefined;\n}\n\n/**\n * Legacy console log entry for backward compatibility\n */\nexport interface LegacyConsoleLogEntry {\n  level: LogLevel;\n  message: string;\n  timestamp: number;\n  sessionId: string;\n  args?: ConsoleArgument[];\n  serializedMessage?: string;\n}\n\n/**\n * Utility functions for console message handling\n */\nexport class ConsoleUtils {\n  /**\n   * Serialize console arguments for logging\n   */\n  static serializeArgs(args: unknown[]): string {\n    return args.map(arg => ConsoleUtils.serializeArg(arg)).join(' ');\n  }\n\n  /**\n   * Serialize a single argument for logging\n   */\n  static serializeArg(arg: unknown): string {\n    if (arg === null) return 'null';\n    if (arg === undefined) return 'undefined';\n    if (typeof arg === 'string') return arg;\n    if (typeof arg === 'number' || typeof arg === 'boolean') return String(arg);\n    if (typeof arg === 'function') return `[Function: ${arg.name || 'anonymous'}]`;\n    if (arg instanceof Error) return `${arg.name}: ${arg.message}`;\n    \n    try {\n      return JSON.stringify(arg, null, 2);\n    } catch {\n      return String(arg);\n    }\n  }\n\n  /**\n   * Create a log entry from console arguments\n   */\n  static createLogEntry(\n    level: LogLevel,\n    args: unknown[],\n    context: ContinuumContext,\n    source: string = 'browser-console'\n  ): LogEntry {\n    const entry: LogEntry = {\n      level,\n      message: ConsoleUtils.serializeArgs(args),\n      timestamp: Date.now(),\n      sessionId: context.sessionId,\n      source,\n      context\n    };\n    \n    if (args.length > 0) {\n      entry.data = { args };\n    }\n    \n    return entry;\n  }\n\n  /**\n   * Convert between old Console.Level and new LogLevel\n   */\n  static normalizeLogLevel(level: string): LogLevel {\n    switch (level.toLowerCase()) {\n      case 'error':\n        return 'error';\n      case 'warn':\n        return 'warn';\n      case 'info':\n        return 'info';\n      case 'log':\n        return 'log';\n      case 'debug':\n        return 'debug';\n      case 'trace':\n        return 'trace';\n      case 'probe':\n        return 'probe';\n      default:\n        return 'log';\n    }\n  }\n}", "/**\n * Logger Message Types - Typed messages for async logging daemon\n * Uses DaemonMessage<T> generic pattern for type safety\n */\n\nimport { DaemonMessage } from '../../base/DaemonProtocol';\nimport { LogLevel, LogEntry } from './ConsoleTypes';\n\n// Browser-compatible UUID generation\nfunction generateUUID(): string {\n  if (typeof crypto !== 'undefined' && crypto.randomUUID) {\n    return crypto.randomUUID();\n  } else {\n    // Fallback for browser environments\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      const r = Math.random() * 16 | 0;\n      const v = c === 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);\n    });\n  }\n}\n\n// Re-export unified types for convenience\nexport { ConsoleUtils } from './ConsoleTypes';\nexport type { LogLevel, LogEntry, ProbeData, OriginalConsole } from './ConsoleTypes';\n\nexport interface LoggerMessage {\n  type: 'log' | 'flush' | 'rotate' | 'configure' | 'browser_console';\n  payload: LogEntry | FlushRequest | RotateRequest | ConfigureRequest | BrowserConsoleMessage;\n}\n\nexport interface FlushRequest {\n  sessionId?: string; // Flush specific session or all sessions\n  force?: boolean;    // Force immediate flush\n}\n\nexport interface RotateRequest {\n  sessionId?: string; // Rotate specific session logs or all\n  maxSize?: number;   // Max file size before rotation\n}\n\nexport interface ConfigureRequest {\n  logLevel?: LogLevel;\n  enableBatching?: boolean;\n  batchSize?: number;\n  flushInterval?: number;\n}\n\nexport interface BrowserConsoleMessage {\n  connectionId: string;\n  sessionId?: string;\n  level: LogLevel;\n  message: string;\n  data?: any;\n  timestamp?: string;\n}\n\n// Typed daemon messages for logger\nexport type LoggerDaemonMessage = DaemonMessage<LoggerMessage>;\n\n// Factory functions for creating typed messages\nexport class LoggerMessageFactory {\n  static createLogMessage(logEntry: LogEntry): LoggerMessage;\n  static createLogMessage(\n    from: string,\n    to: string,\n    logEntry: LogEntry,\n    priority?: 'low' | 'normal' | 'high' | 'critical'\n  ): LoggerDaemonMessage;\n  static createLogMessage(\n    logEntryOrFrom: LogEntry | string,\n    to?: string,\n    logEntry?: LogEntry,\n    priority: 'low' | 'normal' | 'high' | 'critical' = 'normal'\n  ): LoggerMessage | LoggerDaemonMessage {\n    // Simple overload for direct LoggerMessage\n    if (typeof logEntryOrFrom === 'object' && !to) {\n      return {\n        type: 'log',\n        payload: logEntryOrFrom\n      };\n    }\n    \n    // Full DaemonMessage overload\n    return {\n      id: generateUUID(),\n      from: logEntryOrFrom as string,\n      to: to!,\n      type: 'log',\n      data: {\n        type: 'log',\n        payload: logEntry!\n      },\n      timestamp: new Date(),\n      priority\n    };\n  }\n\n  static createFlushMessage(\n    from: string,\n    to: string,\n    flushRequest: FlushRequest = {}\n  ): LoggerDaemonMessage {\n    return {\n      id: generateUUID(),\n      from,\n      to,\n      type: 'flush',\n      data: {\n        type: 'flush',\n        payload: flushRequest\n      },\n      timestamp: new Date(),\n      priority: 'high'\n    };\n  }\n\n  static createRotateMessage(\n    from: string,\n    to: string,\n    rotateRequest: RotateRequest = {}\n  ): LoggerDaemonMessage {\n    return {\n      id: generateUUID(),\n      from,\n      to,\n      type: 'rotate',\n      data: {\n        type: 'rotate',\n        payload: rotateRequest\n      },\n      timestamp: new Date(),\n      priority: 'normal'\n    };\n  }\n\n  static createConfigureMessage(\n    from: string,\n    to: string,\n    configureRequest: ConfigureRequest\n  ): LoggerDaemonMessage {\n    return {\n      id: generateUUID(),\n      from,\n      to,\n      type: 'configure',\n      data: {\n        type: 'configure',\n        payload: configureRequest\n      },\n      timestamp: new Date(),\n      priority: 'high'\n    };\n  }\n}", "/**\n * Client Logger Daemon - Simple browser-side console forwarder\n * Handles console interception and forwarding to server via WebSocket\n */\n\nimport { ContinuumContext } from '../../../types/shared/core/ContinuumTypes';\nimport { \n  LoggerMessage\n} from '../shared/LoggerMessageTypes';\n\n/**\n * WebSocket-based transport for client-server communication\n */\ninterface WebSocketTransport {\n  send(message: LoggerMessage): Promise<void>;\n  isConnected(): boolean;\n}\n\nexport class ClientLoggerDaemon {\n  public readonly context: ContinuumContext;\n  private webSocketTransport: WebSocketTransport | null = null;\n\n  constructor(context: ContinuumContext) {\n    this.context = context;\n    // Console forwarding is now handled by ClientConsoleManager\n    // This daemon only processes log messages received from the manager\n  }\n\n  /**\n   * Set WebSocket transport for server communication\n   */\n  setWebSocketTransport(transport: WebSocketTransport): void {\n    this.webSocketTransport = transport;\n  }\n\n  /**\n   * Process a log message (used by ClientLoggerClient)\n   */\n  async processLogMessage(loggerMessage: LoggerMessage): Promise<void> {\n    // Forward to server via WebSocket if available\n    if (this.webSocketTransport && this.webSocketTransport.isConnected()) {\n      await this.webSocketTransport.send(loggerMessage);\n    }\n\n    // Always log locally in browser as well\n    this.logToBrowserConsole(loggerMessage);\n  }\n\n\n  // Serialization methods removed - now using unified ConsoleUtils\n\n  /**\n   * Log to browser console (fallback/local logging)\n   * DISABLED: Let server-side forwarding handle all console output with proper stack traces\n   */\n  private logToBrowserConsole(_loggerMessage: LoggerMessage): void {\n    // Disabled to prevent duplicate output and allow server-side stack traces to be the primary output\n    // The ClientConsoleManager already handles both console.* calls and forwarding\n    return;\n  }\n\n  /**\n   * Clean up (console methods are now managed by ClientConsoleManager)\n   */\n  cleanup(): void {\n    // Console cleanup is now handled by ClientConsoleManager\n    // This daemon only needs to cleanup WebSocket transport\n    this.webSocketTransport = null;\n  }\n}", "/**\n * Client Logger Client - Simple interface for browser-side logging\n * Follows the same pattern as server LoggerClient but for browser context\n */\n\nimport { ContinuumContext } from '../../../types/shared/core/ContinuumTypes';\nimport { LoggerMessageFactory, LogLevel, LogEntry } from '../shared/LoggerMessageTypes';\nimport { ClientLoggerDaemon } from './ClientLoggerDaemon';\n\nexport class ClientLoggerClient {\n  private static instance: ClientLoggerClient;\n  private clientLoggerDaemon: ClientLoggerDaemon | null = null;\n\n  private constructor() {}\n\n  static getInstance(): ClientLoggerClient {\n    if (!ClientLoggerClient.instance) {\n      ClientLoggerClient.instance = new ClientLoggerClient();\n    }\n    return ClientLoggerClient.instance;\n  }\n\n  /**\n   * Initialize daemon with context\n   */\n  initialize(context: ContinuumContext): void {\n    if (this.clientLoggerDaemon) {\n      return; // Already initialized\n    }\n    \n    this.clientLoggerDaemon = new ClientLoggerDaemon(context);\n  }\n\n  /**\n   * Set WebSocket transport for server communication\n   */\n  setWebSocketTransport(transport: any): void {\n    if (!this.clientLoggerDaemon) {\n      throw new Error('ClientLoggerClient not initialized');\n    }\n    this.clientLoggerDaemon.setWebSocketTransport(transport);\n  }\n\n  /**\n   * Log a message directly (bypasses console overrides)\n   */\n  async log(level: LogLevel, message: string, data?: Record<string, unknown>): Promise<void> {\n    if (!this.clientLoggerDaemon) {\n      console.warn('ClientLoggerClient not initialized, using console fallback');\n      (console as any)[level](message, data);\n      return;\n    }\n\n    const entry: LogEntry = {\n      level,\n      message,\n      timestamp: Date.now(),\n      sessionId: this.clientLoggerDaemon.context.sessionId,\n      source: 'client-direct',\n      context: this.clientLoggerDaemon.context\n    };\n    \n    if (data) {\n      entry.data = data;\n    }\n\n    const logMessage = LoggerMessageFactory.createLogMessage(entry);\n    \n    // Simple direct processing - no complex daemon message wrapping\n    try {\n      await this.clientLoggerDaemon.processLogMessage(logMessage);\n    } catch (error) {\n      console.error('Failed to process log message:', error);\n    }\n  }\n\n  /**\n   * Convenience methods for different log levels\n   */\n  async info(message: string, data?: Record<string, unknown>): Promise<void> {\n    return this.log('info', message, data);\n  }\n\n  async warn(message: string, data?: Record<string, unknown>): Promise<void> {\n    return this.log('warn', message, data);\n  }\n\n  async error(message: string, data?: Record<string, unknown>): Promise<void> {\n    return this.log('error', message, data);\n  }\n\n  async debug(message: string, data?: Record<string, unknown>): Promise<void> {\n    return this.log('debug', message, data);\n  }\n\n  /**\n   * Check if daemon is initialized\n   */\n  isInitialized(): boolean {\n    return this.clientLoggerDaemon !== null;\n  }\n\n  /**\n   * Clean up\n   */\n  destroy(): void {\n    if (this.clientLoggerDaemon) {\n      this.clientLoggerDaemon.cleanup();\n      this.clientLoggerDaemon = null;\n    }\n  }\n}\n\n// Export singleton instance\nexport const clientLoggerClient = ClientLoggerClient.getInstance();", "/**\n * Client Console Manager - Unified console management for browser-side logging\n * Part of the symmetric logger daemon architecture\n * Handles console interception, message queuing, and server forwarding\n */\n\nimport { Console } from '../../../types/shared/ConsoleTypes';\nimport type { ContinuumState } from '../../../ui/continuum-browser-client/types/BrowserClientTypes';\nimport { ContinuumContext, continuumContextFactory } from '../../../types/shared/core/ContinuumTypes';\nimport { clientLoggerClient } from './ClientLoggerClient';\nimport { LogLevel, OriginalConsole, ProbeData, ConsoleUtils } from '../shared/LoggerMessageTypes';\n\nexport class ClientConsoleManager {\n  private consoleForwarding = false;\n  private consoleMessageQueue: Console.LogEntry[] = [];\n  private originalConsole: OriginalConsole = {} as OriginalConsole;\n  private executeCallback?: (command: string, params: Record<string, unknown>) => Promise<unknown>;\n  private context: ContinuumContext;\n\n  constructor(private getState: () => ContinuumState, private getSessionId: () => string) {\n    // Force context to be non-null - session ID is required\n    const sessionId = this.getSessionId();\n    if (!sessionId) {\n      throw new Error('ClientConsoleManager requires a valid session ID');\n    }\n    \n    this.context = continuumContextFactory.create({ sessionId: sessionId as any });\n    this.initializeLoggerDaemon();\n    this.enableConsoleForwarding();\n  }\n\n  private initializeLoggerDaemon(): void {\n    clientLoggerClient.initialize(this.context);\n  }\n\n  setExecuteCallback(callback: (command: string, params: Record<string, unknown>) => Promise<unknown>): void {\n    this.executeCallback = callback;\n  }\n\n  setWebSocketTransport(transport: any): void {\n    clientLoggerClient.setWebSocketTransport(transport);\n  }\n\n  private enableConsoleForwarding(): void {\n    if (this.consoleForwarding) {\n      console.warn('\u26A0\uFE0F Console forwarding is already enabled, called twice?');\n      return;\n    }\n\n    // Store original console methods for internal use\n    this.originalConsole = {\n      log: console.log.bind(console),\n      warn: console.warn.bind(console),\n      error: console.error.bind(console),\n      info: console.info.bind(console),\n      debug: console.debug ? console.debug.bind(console) : console.log.bind(console),\n      trace: console.trace.bind(console)\n    };\n\n    // CONSOLE OVERRIDE REMOVED: LoggerDaemon is now \"The Console Daemon\"\n    // ClientConsoleManager only handles message forwarding, not console override\n    // Console override is handled by LoggerDaemon with semaphore protection\n\n    console.log('\uD83D\uDD04 Console forwarding initialized (no console override)');\n\n    // Add AI-friendly probe method for diagnostic logging with optional JS execution\n    (console as any).probe = (messageOrProbeData: string | ProbeData, data?: Record<string, unknown>): void => {\n      let probeData: ProbeData;\n      \n      // Handle both simple string usage and full ProbeData interface\n      if (typeof messageOrProbeData === 'string') {\n        probeData = {\n          message: messageOrProbeData,\n          category: 'ai-diagnostic'\n        };\n        if (data) {\n          probeData.data = data;\n        }\n      } else {\n        probeData = messageOrProbeData;\n      }\n\n      // Execute optional JavaScript and capture result\n      if (probeData.executeJS) {\n        try {\n          // ESLint disable: eval needed for dynamic probe execution in browser context\n          // This is intentional for debugging/testing - probe commands need dynamic JS execution\n          // eslint-disable-next-line no-eval\n          // @ts-ignore - eval needed for dynamic probe execution in browser context\n          const result = eval(probeData.executeJS);\n          \n          // If result is a JSON string, parse it back to an object for proper logging\n          let processedResult = result;\n          if (typeof result === 'string') {\n            try {\n              processedResult = JSON.parse(result);\n            } catch (error) {\n              // If it's not valid JSON, keep as string\n              processedResult = result;\n            }\n          }\n          \n          probeData.data = {\n            ...probeData.data,\n            executeJSResult: processedResult,\n            jsCode: probeData.executeJS  // Keep original for local logging\n          };\n        } catch (error) {\n          probeData.data = {\n            ...probeData.data,\n            executeJSError: error instanceof Error ? error.message : String(error),\n            jsCode: probeData.executeJS  // Keep original for local logging\n          };\n        }\n        \n        // Base64 encode for secure wire transmission\n        probeData.executeJSBase64 = btoa(probeData.executeJS);\n        // Remove plain text version for wire transmission\n        delete probeData.executeJS;\n      }\n\n      this.originalConsole.log('\uD83D\uDD2C PROBE:', probeData.message, probeData.data || '');\n      this.forwardConsole('probe', [probeData]);\n    };\n\n    this.consoleForwarding = true;\n    console.log('\u2705 Console forwarding enabled (without console override)');\n    console.log('\uD83D\uDD2C console.probe() method added for AI diagnostics');\n  }\n\n  /**\n   * Forward console messages to server (called by probe or manual forwarding)\n   */\n  private forwardConsole(type: string, args: unknown[]): void {\n    try {\n      // Convert type string to proper Console.Level enum\n      const level = type as Console.Level;\n      \n      // Capture stack trace BEFORE going deeper into the call chain\n      const stackTrace = this.captureCallerStackTrace();\n      \n      // Create properly formatted log entry using shared types\n      const logEntry = Console.MessageUtils.createLogEntry(level, args, {\n        stackTrace // Pass the captured stack trace\n      });\n\n      // Add session ID to the log entry (use context)\n      const consoleLogEntry: Console.LogEntry = {\n        ...logEntry,\n        sessionId: this.context.sessionId\n      };\n\n      // Forward to logger daemon using unified architecture\n      if (clientLoggerClient.isInitialized()) {\n        const message = ConsoleUtils.serializeArgs(args);\n        clientLoggerClient.log(level as LogLevel, message, { \n          originalArgs: args,\n          consoleLogEntry \n        }).catch(error => {\n          this.originalConsole.error('Failed to forward to logger daemon:', error);\n        });\n      }\n\n      // Keep existing behavior for backward compatibility\n      // Only execute if we're in ready state, otherwise queue for later\n      if (this.getState() === 'ready' && this.executeCallback) {\n        this.executeConsoleCommand(consoleLogEntry);\n      } else {\n        // Queue message for when we reach ready state\n        this.queueConsoleMessage(consoleLogEntry);\n      }\n    } catch (error) {\n      // Fail silently to avoid console loops\n      this.originalConsole.error('\u274C Error forwarding console message:', error);\n    }\n  }\n\n  // Serialization methods removed - now using unified ConsoleUtils\n\n  /**\n   * Capture stack trace from the actual calling location (not our console forwarding methods)\n   */\n  private captureCallerStackTrace(): string {\n    try {\n      const error = new Error();\n      if (error.stack) {\n        const lines = error.stack.split('\\n');\n        const filteredLines = lines.filter(line => \n          // Filter out our own console management methods\n          !line.includes('ClientConsoleManager.forwardConsole') &&\n          !line.includes('ClientConsoleManager.captureCallerStackTrace') &&\n          !line.includes('ClientConsoleManager.') &&\n          !line.includes('ClientLoggerDaemon.') &&\n          !line.includes('console.log') &&\n          !line.includes('console.warn') &&\n          !line.includes('console.error') &&\n          !line.includes('console.info') &&\n          !line.includes('console.debug') &&\n          !line.includes('console.trace') &&\n          !line.includes('console.probe') &&\n          // Filter out the Error constructor and other internal methods\n          !line.includes('Error.captureStackTrace') &&\n          !line.includes('at new Error') &&\n          !line.includes('at Object.') && // Common for arrow functions\n          line.trim().length > 0\n        );\n        \n        // Return the first few meaningful lines to show the actual call location\n        return filteredLines.slice(0, 5).join('\\n');\n      }\n    } catch (e) {\n      // Fallback if stack capture fails\n    }\n    return '';\n  }\n\n\n  private queueConsoleMessage(logEntry: Console.LogEntry): void {\n    this.consoleMessageQueue.push(logEntry);\n  }\n\n  private executeConsoleCommand(logEntry: Console.LogEntry): void {\n    if (this.executeCallback) {\n      // Pass the logEntry directly - the console command expects the LogEntry format\n      this.executeCallback('console', logEntry as unknown as Record<string, unknown>).catch(error => {\n        this.originalConsole.error('\u274C Error executing console command:', error);\n      });\n    }\n  }\n\n  /**\n   * Process queued messages when ready\n   */\n  processQueuedMessages(): void {\n    if (this.consoleMessageQueue.length === 0) return;\n\n    const messages = [...this.consoleMessageQueue];\n    this.consoleMessageQueue = [];\n\n    for (const message of messages) {\n      this.executeConsoleCommand(message);\n    }\n  }\n\n  /**\n   * Get current context\n   */\n  getContext(): ContinuumContext {\n    return this.context;\n  }\n\n  /**\n   * Update context (e.g., when session changes)\n   */\n  updateContext(newContext: ContinuumContext): void {\n    this.context = newContext;\n    clientLoggerClient.destroy();\n    clientLoggerClient.initialize(this.context);\n  }\n\n  /**\n   * Clean up console forwarding\n   */\n  destroy(): void {\n    if (this.consoleForwarding) {\n      // Remove probe method only (no console override to restore)\n      delete (console as any).probe;\n      this.consoleForwarding = false;\n    }\n    \n    clientLoggerClient.destroy();\n  }\n}", "/**\n * Console Forwarder - Thin wrapper around unified logger daemon architecture\n * \n * @deprecated Use ClientConsoleManager directly from logger daemon module\n * This wrapper maintained for backward compatibility\n */\n\nimport { ClientConsoleManager } from '../../../daemons/logger/client/ClientConsoleManager';\nimport type { ContinuumState } from '../types/BrowserClientTypes';\n\nexport class ConsoleForwarder {\n  private consoleManager: ClientConsoleManager;\n\n  constructor(private getState: () => ContinuumState, private getSessionId: () => string | null) {\n    // Handle the case where session ID might be null for backward compatibility\n    const sessionIdGetter = () => {\n      const sessionId = this.getSessionId();\n      if (!sessionId) {\n        throw new Error('ConsoleForwarder requires a valid session ID');\n      }\n      return sessionId;\n    };\n\n    this.consoleManager = new ClientConsoleManager(this.getState, sessionIdGetter);\n  }\n\n  setExecuteCallback(callback: (command: string, params: Record<string, unknown>) => Promise<unknown>): void {\n    this.consoleManager.setExecuteCallback(callback);\n  }\n\n  setWebSocketTransport(transport: any): void {\n    this.consoleManager.setWebSocketTransport(transport);\n  }\n\n  processQueuedMessages(): void {\n    this.consoleManager.processQueuedMessages();\n  }\n\n  getContext() {\n    return this.consoleManager.getContext();\n  }\n\n  updateContext(newContext: any) {\n    this.consoleManager.updateContext(newContext);\n  }\n\n  // Legacy methods for backward compatibility\n  executeAndFlushConsoleMessageQueue(): void {\n    this.processQueuedMessages();\n  }\n\n  performHealthCheck(): boolean {\n    return this.consoleManager.getContext() !== null;\n  }\n\n  destroy(): void {\n    this.consoleManager.destroy();\n  }\n}", "// ISSUES: 0 open, last updated 2025-07-13 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * WebSocket Manager - Handles WebSocket connection and messaging\n * Manages connection lifecycle and message handling\n * \n * \u2705 CLEANED UP: Removed god object pattern - now delegates to modular command handlers (2025-07-13)\n * \u2705 CLEANED UP: Uses event system for remote execution instead of hardcoded switch (2025-07-13)\n */\n\nimport type { WebSocketMessage, ClientInitData, RemoteExecutionRequest, RemoteExecutionResponse } from '../types/WebSocketTypes';\nimport type { ContinuumState } from '../types/BrowserClientTypes';\n\nexport class WebSocketManager {\n  private ws: WebSocket | null = null;\n  private version: string;\n  \n  // Callbacks\n  private onStateChange: ((state: ContinuumState) => void) | undefined;\n  private onClientId: ((clientId: string) => void) | undefined;\n  private onSessionId: ((sessionId: string) => void) | undefined;\n  private onMessage: ((message: Record<string, unknown>) => void) | undefined;\n\n  constructor(version: string) {\n    this.version = version;\n  }\n\n  setCallbacks(callbacks: {\n    onStateChange?: (state: ContinuumState) => void;\n    onClientId?: (clientId: string) => void;\n    onSessionId?: (sessionId: string) => void;\n    onMessage?: (message: Record<string, unknown>) => void;\n  }): void {\n    this.onStateChange = callbacks.onStateChange;\n    this.onClientId = callbacks.onClientId;\n    this.onSessionId = callbacks.onSessionId;\n    this.onMessage = callbacks.onMessage;\n  }\n\n  initializeConnection(): void {\n    try {\n      this.ws = new WebSocket('ws://localhost:9000');\n      \n      this.ws.onopen = () => {\n        console.log('\uD83D\uDD0C WebSocket connected');\n        this.onStateChange?.('connected');\n        \n        // Send client init\n        const clientInitData: ClientInitData = {\n          userAgent: navigator.userAgent,\n          url: window.location.href,\n          timestamp: new Date().toISOString(),\n          version: this.version,\n          mode: 'join_existing'\n        };\n        \n        this.sendMessage({\n          type: 'client_init',\n          data: clientInitData,\n          timestamp: new Date().toISOString()\n        });\n      };\n\n      this.ws.onmessage = (event) => {\n        this.handleMessage(event);\n      };\n\n      this.ws.onclose = () => {\n        console.log('\uD83D\uDD0C WebSocket disconnected');\n        this.onStateChange?.('error');\n      };\n\n      this.ws.onerror = (error) => {\n        console.error('\uD83D\uDD0C WebSocket error:', error);\n        this.onStateChange?.('error');\n      };\n\n    } catch (error) {\n      console.error('\u274C Failed to initialize WebSocket:', error);\n      this.onStateChange?.('error');\n    }\n  }\n\n  private async handleMessage(event: MessageEvent): Promise<void> {\n    try {\n      const message = JSON.parse(event.data);\n      \n      if (message.type === 'connection_confirmed') {\n        const clientId = message.data?.clientId;\n        if (clientId) {\n          console.log(`\uD83D\uDD0C Client ID: ${clientId}`);\n          this.onClientId?.(clientId);\n        }\n        return;\n      }\n\n      if (message.type === 'session_ready') {\n        const sessionId = message.data?.sessionId;\n        if (sessionId) {\n          console.log(`\uD83C\uDFAF Session: ${sessionId}`);\n          this.onSessionId?.(sessionId);\n          this.onStateChange?.('ready');\n        }\n        return;\n      }\n\n      // Handle command responses\n      if (message.type === 'execute_command_response') {\n        const event = new CustomEvent('continuum:command_response', { \n          detail: message \n        });\n        document.dispatchEvent(event);\n        return;\n      }\n\n      // Handle remote execution requests from server - delegate to command registry\n      if (message.type === 'remote_execution_request') {\n        await this.delegateRemoteExecution(message.data);\n        return;\n      }\n\n      // Handle execute_js messages from server\n      if (message.type === 'execute_js') {\n        console.log('\uD83D\uDE80 Executing JavaScript from server:', message.script);\n        try {\n          // Wrap in async function to handle return statements and promises\n          const wrappedScript = `(async function() { ${message.script} })()`;\n          // eslint-disable-next-line no-eval\n          const result = await eval(wrappedScript);\n          console.log('\u2705 JavaScript execution result:', result);\n          \n          // Send result back to server if there's a request ID\n          if (message.requestId) {\n            this.sendMessage({\n              type: 'execute_js_result',\n              requestId: message.requestId,\n              result: result,\n              timestamp: new Date().toISOString()\n            });\n          }\n        } catch (error) {\n          console.error('\u274C JavaScript execution error:', error);\n          \n          // Send error back to server if there's a request ID\n          if (message.requestId) {\n            this.sendMessage({\n              type: 'execute_js_result',\n              requestId: message.requestId,\n              error: error instanceof Error ? error.message : String(error),\n              timestamp: new Date().toISOString()\n            });\n          }\n        }\n        return;\n      }\n\n      // Pass other messages to callback\n      this.onMessage?.(message);\n\n    } catch (error) {\n      console.error('\u274C Error parsing message:', error);\n    }\n  }\n\n  sendMessage(message: WebSocketMessage): void {\n    if (this.ws?.readyState === WebSocket.OPEN) {\n      this.ws.send(JSON.stringify({\n        ...message,\n        timestamp: new Date().toISOString()\n      }));\n    }\n  }\n\n  isOpen(): boolean {\n    return this.ws?.readyState === WebSocket.OPEN;\n  }\n\n  /**\n   * Delegate remote execution to proper command handler - modular approach\n   */\n  private async delegateRemoteExecution(data: RemoteExecutionRequest): Promise<void> {\n    const startTime = Date.now();\n    console.log(`\uD83D\uDD0D Browser delegating remote execution: ${data.command}`, data);\n\n    try {\n      // Use event system for modular command handling\n      const event = new CustomEvent('continuum:remote_execution', {\n        detail: {\n          request: data,\n          respond: (response: RemoteExecutionResponse) => {\n            this.sendMessage({\n              type: 'remote_execution_response',\n              data: response\n            });\n          }\n        }\n      });\n\n      document.dispatchEvent(event);\n\n      // Fallback if no handler responds within timeout\n      setTimeout(() => {\n        const errorResponse: RemoteExecutionResponse = {\n          success: false,\n          error: `No handler registered for command: ${data.command}`,\n          requestId: data.requestId,\n          clientMetadata: {\n            userAgent: navigator.userAgent,\n            timestamp: Date.now(),\n            executionTime: Date.now() - startTime\n          }\n        };\n\n        this.sendMessage({\n          type: 'remote_execution_response',\n          data: errorResponse,\n          timestamp: new Date().toISOString()\n        });\n      }, 1000); // 1 second timeout for handler registration\n\n    } catch (error) {\n      console.error(`\u274C Remote execution delegation failed: ${error}`);\n      \n      const response: RemoteExecutionResponse = {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        requestId: data.requestId,\n        clientMetadata: {\n          userAgent: navigator.userAgent,\n          timestamp: Date.now(),\n          executionTime: Date.now() - startTime\n        }\n      };\n\n      this.sendMessage({\n        type: 'remote_execution_response',\n        data: response\n      });\n    }\n  }\n}", "/**\n * Base Parser - Abstract foundation for all Continuum parsers\n * \n * Defines the contract for parsing input/output across all integrations:\n * - CLI parsers for command-line interface\n * - MCP parsers for Model Context Protocol\n * - WebSocket parsers for browser communication\n * - REST API parsers for HTTP endpoints\n * \n * All parsers extend this base to ensure consistent interface across\n * client, server, and shared environments.\n */\n\nimport { ValidationResult } from '../../types/ValidationTypes';\n\nexport abstract class ParserBase<TInput = any, TOutput = any> {\n  /**\n   * Parse input from integration-specific format to universal Continuum types\n   * @param input - Raw input in integration format (CLI args, MCP message, etc.)\n   * @returns Parsed parameters in universal format\n   */\n  abstract parseInput(input: TInput): Record<string, any>;\n\n  /**\n   * Format output from universal Continuum types to integration-specific format\n   * @param output - Command result in universal format\n   * @param command - Command name for context\n   * @returns Formatted output ready for integration display\n   */\n  abstract formatOutput(output: TOutput, command: string): void;\n\n  /**\n   * Validate input parameters before processing\n   * @param input - Input to validate\n   * @returns Validation result with success/error details\n   */\n  abstract validateInput(input: TInput): ValidationResult;\n\n  /**\n   * Validate output before formatting\n   * @param output - Output to validate\n   * @returns Validation result with success/error details\n   */\n  abstract validateOutput(output: TOutput): ValidationResult;\n\n  /**\n   * Get parser metadata for registration and discovery\n   */\n  abstract getParserInfo(): {\n    name: string;\n    version: string;\n    description: string;\n    supportedCommands: string[];\n  };\n\n  /**\n   * Check if this parser can handle the given input format\n   * @param input - Input to check\n   * @returns True if parser can handle this input\n   */\n  abstract canHandle(input: TInput): boolean;\n\n  /**\n   * Priority for parser selection when multiple parsers can handle input\n   * Higher numbers = higher priority\n   */\n  abstract getPriority(): number;\n\n  /**\n   * Common utility for safe JSON parsing\n   */\n  protected safeJsonParse(input: string): any {\n    try {\n      return JSON.parse(input);\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Common utility for extracting command name from various input formats\n   */\n  protected extractCommandName(input: TInput): string | null {\n    // Default implementation - parsers can override\n    if (typeof input === 'object' && input !== null) {\n      return (input as any).command || (input as any).commandName || null;\n    }\n    return null;\n  }\n\n  /**\n   * Common utility for parameter validation\n   */\n  protected validateParameters(params: Record<string, any>, required: string[]): ValidationResult {\n    const missing = required.filter(key => !(key in params) || params[key] === undefined);\n    \n    if (missing.length > 0) {\n      return {\n        success: false,\n        error: `Missing required parameters: ${missing.join(', ')}`,\n        details: { missingParameters: missing }\n      };\n    }\n\n    return { success: true };\n  }\n\n  /**\n   * Common utility for output formatting status display\n   */\n  protected getStatusDisplay(success: boolean): { icon: string; text: string } {\n    return success \n      ? { icon: '\u2705', text: 'Success' }\n      : { icon: '\u274C', text: 'Failed' };\n  }\n\n  /**\n   * Common utility for formatting file sizes\n   */\n  protected formatFileSize(bytes: number): string {\n    if (bytes < 1024) return `${bytes}B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)}KB`;\n    if (bytes < 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(1)}MB`;\n    return `${(bytes / (1024 * 1024 * 1024)).toFixed(1)}GB`;\n  }\n\n  /**\n   * Common utility for formatting execution time\n   */\n  protected formatExecutionTime(ms: number): string {\n    if (ms < 1000) return `${ms}ms`;\n    if (ms < 60000) return `${(ms / 1000).toFixed(1)}s`;\n    return `${(ms / 60000).toFixed(1)}m`;\n  }\n}", "/**\n * CLI Parser Types - Shared types for CLI integration parsing\n */\n\nexport interface CLIInputFormat {\n  args: string[];\n  command?: string;\n  flags?: Record<string, string | boolean>;\n}\n\nexport interface CLIOutputFormat {\n  success: boolean;\n  data?: any;\n  error?: string;\n  executionTime?: number;\n}\n\nexport interface CLIParserConfig {\n  enableColors: boolean;\n  enableEmojis: boolean;\n  verboseOutput: boolean;\n  maxOutputLength: number;\n}\n\nexport interface CLIFormattingOptions {\n  showTimestamp: boolean;\n  showExecutionTime: boolean;\n  showStatusIcon: boolean;\n  compactMode: boolean;\n}\n\nexport const DEFAULT_CLI_CONFIG: CLIParserConfig = {\n  enableColors: true,\n  enableEmojis: true,\n  verboseOutput: false,\n  maxOutputLength: 10000\n};\n\nexport const DEFAULT_CLI_FORMATTING: CLIFormattingOptions = {\n  showTimestamp: false,\n  showExecutionTime: true,\n  showStatusIcon: true,\n  compactMode: false\n};", "/**\n * CLI Client Parser - Handles CLI input parsing and output formatting\n * \n * This parser handles the client-side CLI integration:\n * - Parses CLI arguments into universal Continuum types\n * - Formats command results for CLI display\n * - Provides user-friendly output formatting\n */\n\nimport { ParserBase } from '../../../shared/ParserBase';\nimport { ValidationResult } from '../../../../types/ValidationTypes';\nimport { CLIInputFormat, CLIOutputFormat, CLIParserConfig, CLIFormattingOptions, DEFAULT_CLI_FORMATTING } from '../shared/CLIParserTypes';\n\nexport class CLIClientParser extends ParserBase<CLIInputFormat, CLIOutputFormat> {\n  private formatting: CLIFormattingOptions;\n\n  constructor(config: Partial<CLIParserConfig> = {}, formatting: Partial<CLIFormattingOptions> = {}) {\n    super();\n    // Config available for future use when needed\n    config; // Acknowledge config parameter\n    this.formatting = { ...DEFAULT_CLI_FORMATTING, ...formatting };\n  }\n\n  /**\n   * Parse CLI arguments into universal parameters\n   */\n  parseInput(input: CLIInputFormat): Record<string, any> {\n    const { args } = input;\n    const params: Record<string, any> = {};\n\n    for (let i = 0; i < args.length; i++) {\n      const arg = args[i];\n      \n      // Handle --key=value format\n      if (arg.startsWith('--') && arg.includes('=')) {\n        const [key, ...valueParts] = arg.substring(2).split('=');\n        params[key] = valueParts.join('=');\n      }\n      // Handle --key value format\n      else if (arg.startsWith('--') && i + 1 < args.length && !args[i + 1].startsWith('--')) {\n        const key = arg.substring(2);\n        params[key] = args[i + 1];\n        i++; // Skip next arg as it's the value\n      }\n      // Handle --flag format (boolean)\n      else if (arg.startsWith('--')) {\n        const key = arg.substring(2);\n        params[key] = true;\n      }\n      // Handle positional arguments\n      else {\n        if (!params.args) params.args = [];\n        params.args.push(arg);\n      }\n    }\n\n    return params;\n  }\n\n  /**\n   * Format command output for CLI display\n   */\n  formatOutput(output: CLIOutputFormat, command: string): void {\n    // Handle different command types with appropriate formatting\n    switch (command) {\n      case 'screenshot':\n        this.formatScreenshotOutput(output);\n        break;\n      case 'chat':\n        this.formatChatOutput(output);\n        break;\n      case 'help':\n        this.formatHelpOutput(output);\n        break;\n      default:\n        this.formatGenericOutput(output, command);\n    }\n  }\n\n  /**\n   * Format screenshot command output\n   */\n  private formatScreenshotOutput(output: CLIOutputFormat): void {\n    const { success, data } = output;\n    const status = this.getStatusDisplay(success);\n\n    console.log(`\\n\uD83D\uDCF8 SCREENSHOT CAPTURED`);\n    console.log(`${status.icon} Status: ${status.text}`);\n\n    if (success && data) {\n      if (data.broadcastSent) {\n        console.log(`\uD83D\uDCE1 Broadcast sent to ${data.connectionCount} browser connection(s)`);\n        console.log(`\uD83D\uDCBE Screenshot saved to session directory`);\n        console.log(`\uD83D\uDCC1 Check your screenshots folder for the captured image`);\n      } else if (data.filename) {\n        console.log(`\uD83D\uDCC1 File: ${data.filename}`);\n        if (data.filePath) console.log(`\uD83D\uDCBE Saved to: ${data.filePath}`);\n        if (data.width && data.height) console.log(`\uD83D\uDCCF Dimensions: ${data.width}x${data.height}px`);\n      }\n    }\n\n    if (output.executionTime && this.formatting.showExecutionTime) {\n      console.log(`\u23F1\uFE0F Execution time: ${this.formatExecutionTime(output.executionTime)}`);\n    }\n\n    console.log(`\\n\uD83E\uDD16 AI-Friendly: Full JSON data available programmatically`);\n  }\n\n  /**\n   * Format chat command output\n   */\n  private formatChatOutput(output: CLIOutputFormat): void {\n    const { success, data } = output;\n    \n    if (success && data) {\n      if (data.response) {\n        console.log(data.response);\n      } else if (data.message) {\n        console.log(data.message);\n      }\n    }\n  }\n\n  /**\n   * Format help command output\n   */\n  private formatHelpOutput(output: CLIOutputFormat): void {\n    const { success, data } = output;\n    \n    if (success && data) {\n      if (data.commands) {\n        console.log('\\n\uD83C\uDF10 CONTINUUM COMMANDS\\n');\n        Object.entries(data.commands).forEach(([category, commands]: [string, any]) => {\n          console.log(`\uD83D\uDCCB ${category.toUpperCase()}:`);\n          (commands as string[]).forEach(cmd => {\n            console.log(`  continuum ${cmd}`);\n          });\n          console.log('');\n        });\n      }\n    }\n  }\n\n  /**\n   * Format generic command output\n   */\n  private formatGenericOutput(output: CLIOutputFormat, command: string): void {\n    const { success, data, error } = output;\n    const status = this.getStatusDisplay(success);\n\n    console.log(`\\n\u26A1 ${command.toUpperCase()} RESULT`);\n    console.log(`${status.icon} Status: ${status.text}`);\n\n    if (success && data) {\n      if (typeof data === 'string') {\n        console.log(data);\n      } else {\n        console.log(JSON.stringify(data, null, 2));\n      }\n    }\n\n    if (error) {\n      console.error(`\u274C Error: ${error}`);\n    }\n\n    if (output.executionTime && this.formatting.showExecutionTime) {\n      console.log(`\u23F1\uFE0F Execution time: ${this.formatExecutionTime(output.executionTime)}`);\n    }\n  }\n\n  /**\n   * Validate CLI input format\n   */\n  validateInput(input: CLIInputFormat): ValidationResult {\n    if (!input || typeof input !== 'object') {\n      return { success: false, error: 'Invalid input format' };\n    }\n\n    if (!Array.isArray(input.args)) {\n      return { success: false, error: 'Args must be an array' };\n    }\n\n    return { success: true };\n  }\n\n  /**\n   * Validate CLI output format\n   */\n  validateOutput(output: CLIOutputFormat): ValidationResult {\n    if (!output || typeof output !== 'object') {\n      return { success: false, error: 'Invalid output format' };\n    }\n\n    if (typeof output.success !== 'boolean') {\n      return { success: false, error: 'Success field must be boolean' };\n    }\n\n    return { success: true };\n  }\n\n  /**\n   * Get parser information\n   */\n  getParserInfo() {\n    return {\n      name: 'CLI Client Parser',\n      version: '1.0.0',\n      description: 'Parses CLI arguments and formats output for command-line display',\n      supportedCommands: ['*'] // Supports all commands\n    };\n  }\n\n  /**\n   * Check if parser can handle input\n   */\n  canHandle(input: CLIInputFormat): boolean {\n    return input && typeof input === 'object' && Array.isArray(input.args);\n  }\n\n  /**\n   * Parser priority for selection\n   */\n  getPriority(): number {\n    return 100; // High priority for CLI integration\n  }\n}", "/**\n * Integration Parser Interface\n * Universal format converter - any format to BaseCommand's canonical JSON format\n */\n\nexport interface IntegrationParser {\n  /**\n   * Can this parser handle the input format?\n   */\n  canHandle(params: unknown): boolean;\n  \n  /**\n   * Parse input format to BaseCommand's canonical JSON format\n   */\n  parse<T>(params: unknown): T;\n  \n  /**\n   * Optional priority for ordering (higher = checked first)\n   */\n  priority?: number;\n  \n  /**\n   * Optional name for debugging\n   */\n  name?: string;\n}\n\n/**\n * Registry for integration parsers\n */\nexport class IntegrationParserRegistry {\n  private static parsers: IntegrationParser[] = [];\n  \n  static register(parser: IntegrationParser): void {\n    this.parsers.push(parser);\n    // Sort by priority (higher first)\n    this.parsers.sort((a, b) => (b.priority || 0) - (a.priority || 0));\n  }\n  \n  static getAll(): IntegrationParser[] {\n    return [...this.parsers];\n  }\n  \n  static parse<T>(params: unknown): T {\n    for (const parser of this.parsers) {\n      if (parser.canHandle(params)) {\n        return parser.parse<T>(params);\n      }\n    }\n    \n    // Fallback: assume already in canonical format\n    return params as T;\n  }\n}", "/**\n * CLI Integration Parser\n * Converts CLI args format to BaseCommand's canonical JSON format\n */\n\nimport { IntegrationParser } from './IntegrationParser';\n\nexport class CLIIntegrationParser implements IntegrationParser {\n  name = 'CLI';\n  priority = 100; // High priority - specific format\n  \n  canHandle(params: unknown): boolean {\n    return !!(params && \n              typeof params === 'object' && \n              'args' in params && \n              Array.isArray((params as any).args) &&\n              (params as any).args.length > 0);\n  }\n  \n  parse<T>(params: unknown): T {\n    const { args } = params as { args: string[] };\n    const result: Record<string, unknown> = {};\n    const positionalArgs: string[] = [];\n    \n    console.log('\uD83D\uDD0D CLIIntegrationParser.parse - input params:', params);\n    \n    for (let i = 0; i < args.length; i++) {\n      const arg = args[i];\n      \n      if (typeof arg === 'string' && arg.startsWith('--')) {\n        if (arg.includes('=')) {\n          // Handle --key=value format\n          const [key, ...valueParts] = arg.substring(2).split('=');\n          const rawValue = valueParts.join('=');\n          result[key] = this.parseValue(rawValue);\n        } else {\n          // Handle --key value format (next argument is the value)\n          const key = arg.substring(2);\n          const nextArg = args[i + 1];\n          \n          if (nextArg && !nextArg.startsWith('--')) {\n            // Next argument is the value\n            result[key] = this.parseValue(nextArg);\n            i++; // Skip the next argument since we consumed it\n          } else {\n            // No value, treat as boolean flag\n            result[key] = true;\n          }\n        }\n      } else {\n        // Positional argument (doesn't start with --)\n        positionalArgs.push(arg);\n      }\n    }\n    \n    // Map positional arguments to common parameter names\n    if (positionalArgs.length > 0) {\n      // For help command: first positional arg becomes \"command\"\n      // For other commands: first positional arg becomes common parameter names\n      result.command = positionalArgs[0];\n      result.filename = positionalArgs[0]; // For file commands\n      result.target = positionalArgs[0];   // For reload, etc.\n      result.script = positionalArgs[0];   // For js-execute command\n      \n      // If there are multiple positional args, keep them as an array\n      if (positionalArgs.length > 1) {\n        result.args = positionalArgs;\n      }\n    }\n    \n    console.log('\uD83D\uDD0D CLIIntegrationParser.parse - output result:', result);\n    return result as T;\n  }\n  \n  private parseValue(value: string): unknown {\n    if (!value) return true; // --flag without value\n    \n    // Try JSON first (for objects/arrays)\n    try {\n      return JSON.parse(value);\n    } catch {\n      return value; // String as-is\n    }\n  }\n}", "/**\n * JSON Integration Parser\n * Handles various JSON-based formats and converts to BaseCommand's canonical format\n */\n\nimport { IntegrationParser } from './IntegrationParser';\n\nexport class JSONWithArgsIntegrationParser implements IntegrationParser {\n  name = 'JSON-with-args';\n  priority = 90; // High priority - specific hybrid format\n  \n  canHandle(params: unknown): boolean {\n    return !!(params && \n              typeof params === 'object' && \n              'args' in params && \n              Array.isArray((params as any).args) &&\n              (params as any).args.length === 0);\n  }\n  \n  parse<T>(params: unknown): T {\n    const { args, ...cleanParams } = params as any;\n    return cleanParams as T;\n  }\n}\n\nexport class PureJSONIntegrationParser implements IntegrationParser {\n  name = 'Pure-JSON';\n  priority = 10; // Low priority - catch-all for objects\n  \n  canHandle(params: unknown): boolean {\n    return !!(params && typeof params === 'object');\n  }\n  \n  parse<T>(params: unknown): T {\n    return params as T;\n  }\n}\n\nexport class StringJSONIntegrationParser implements IntegrationParser {\n  name = 'String-JSON';\n  priority = 80; // High priority - specific string format\n  \n  canHandle(params: unknown): boolean {\n    return typeof params === 'string';\n  }\n  \n  parse<T>(params: unknown): T {\n    try {\n      return JSON.parse(params as string) as T;\n    } catch {\n      // If not JSON, treat as single parameter\n      return { data: params } as T;\n    }\n  }\n}", "/**\n * Persona Mesh Integration Parser\n * Enables AI-to-AI collaboration through universal command interface\n */\n\nimport { IntegrationParser } from './IntegrationParser';\n\ninterface PersonaMeshMessage {\n  persona: string;          // Persona identifier (prompt-based, genomic, MCP, RAG)\n  intent: string;          // What the persona is trying to accomplish\n  action: any;             // The actual command/action to execute\n  context: any;           // Additional context for the action\n  collaboration?: {        // Collaboration metadata\n    chainId?: string;      // If part of a collaboration chain\n    dependencies?: string[]; // Other personas this depends on\n    urgency?: 'low' | 'medium' | 'high';\n  };\n}\n\nexport class PersonaMeshParser implements IntegrationParser {\n  name = 'Persona-Mesh';\n  priority = 90; // High priority for AI collaboration\n\n  canHandle(params: unknown): boolean {\n    return (\n      params !== null &&\n      typeof params === 'object' &&\n      'persona' in params &&\n      'intent' in params &&\n      'action' in params\n    );\n  }\n\n  parse<T>(params: unknown): T {\n    const mesh = params as PersonaMeshMessage;\n    \n    // Extract the core action while preserving persona context\n    const result = {\n      ...mesh.action,\n      _personaContext: {\n        persona: mesh.persona,\n        intent: mesh.intent,\n        context: mesh.context,\n        collaboration: mesh.collaboration\n      }\n    };\n    \n    // If this is a collaboration chain, add tracking\n    if (mesh.collaboration?.chainId) {\n      result._collaborationChain = {\n        id: mesh.collaboration.chainId,\n        dependencies: mesh.collaboration.dependencies || [],\n        urgency: mesh.collaboration.urgency || 'medium'\n      };\n    }\n    \n    return result as T;\n  }\n}", "/**\n * MCP (Model Context Protocol) Integration Parser\n * Enables MCP servers and tools to communicate with Continuum\n */\n\nimport { IntegrationParser } from './IntegrationParser';\n\ninterface MCPRequest {\n  jsonrpc: '2.0';\n  method: string;\n  params?: any;\n  id?: string | number;\n}\n\ninterface MCPToolCall {\n  name: string;\n  arguments?: Record<string, any>;\n}\n\nexport class MCPIntegrationParser implements IntegrationParser {\n  name = 'MCP';\n  priority = 85; // High priority for MCP ecosystem\n\n  canHandle(params: unknown): boolean {\n    return (\n      params !== null &&\n      typeof params === 'object' &&\n      'jsonrpc' in params &&\n      'method' in params &&\n      (params as any).jsonrpc === '2.0'\n    );\n  }\n\n  parse<T>(params: unknown): T {\n    const mcpRequest = params as MCPRequest;\n    \n    // Map MCP methods to Continuum commands\n    const result = this.translateMCPMethod(mcpRequest);\n    \n    // Preserve MCP context for debugging/tracing\n    result._mcpContext = {\n      method: mcpRequest.method,\n      id: mcpRequest.id,\n      jsonrpc: mcpRequest.jsonrpc\n    };\n    \n    return result as T;\n  }\n\n  private translateMCPMethod(request: MCPRequest): any {\n    const { method, params } = request;\n    \n    switch (method) {\n      case 'tools/list':\n        return { command: 'help', format: 'tools' };\n        \n      case 'tools/call':\n        const toolCall = params as MCPToolCall;\n        return {\n          command: toolCall.name,\n          ...toolCall.arguments\n        };\n        \n      case 'resources/list':\n        return { command: 'projects', format: 'resources' };\n        \n      case 'prompts/list':\n        return { command: 'personas', format: 'prompts' };\n        \n      case 'prompts/get':\n        return { \n          command: 'persona', \n          action: 'get',\n          name: params?.name \n        };\n        \n      case 'resources/read':\n        return {\n          command: 'data-marshal',\n          operation: 'read',\n          path: params?.uri\n        };\n        \n      case 'completion/complete':\n        return {\n          command: 'chat',\n          message: params?.prompt,\n          context: params?.argument?.context\n        };\n        \n      default:\n        // For unknown methods, try to extract command from method name\n        const commandMatch = method.match(/(\\w+)\\/(\\w+)/);\n        if (commandMatch) {\n          return {\n            command: commandMatch[2],\n            service: commandMatch[1],\n            ...params\n          };\n        }\n        \n        // Fallback: pass through with method as command\n        return {\n          command: method,\n          ...params\n        };\n    }\n  }\n}", "/**\n * Integration Parsers Index\n * Auto-registers all standard parsers for BaseCommand\n */\n\nimport { IntegrationParserRegistry } from './IntegrationParser';\nimport { CLIIntegrationParser } from './CLIIntegrationParser';\nimport { \n  JSONWithArgsIntegrationParser, \n  PureJSONIntegrationParser, \n  StringJSONIntegrationParser \n} from './JSONIntegrationParser';\nimport { PersonaMeshParser } from './PersonaMeshParser';\nimport { MCPIntegrationParser } from './MCPIntegrationParser';\n\n// Auto-register all parsers (order matters - higher priority first)\nIntegrationParserRegistry.register(new CLIIntegrationParser());         // Priority 100 - CLI tools\nIntegrationParserRegistry.register(new PersonaMeshParser());            // Priority 90 - AI collaboration\nIntegrationParserRegistry.register(new MCPIntegrationParser());         // Priority 85 - MCP ecosystem\nIntegrationParserRegistry.register(new JSONWithArgsIntegrationParser()); // Priority 80 - Hybrid JSON\nIntegrationParserRegistry.register(new StringJSONIntegrationParser());  // Priority 50 - String JSON\nIntegrationParserRegistry.register(new PureJSONIntegrationParser());    // Priority 0 - Fallback\n\n// Export everything for extensibility\nexport * from './IntegrationParser';\nexport * from './CLIIntegrationParser';\nexport * from './JSONIntegrationParser';\nexport * from './PersonaMeshParser';\nexport * from './MCPIntegrationParser';", "/**\n * MIDDLE-OUT ARCHITECTURE - BASE COMMAND FOUNDATION\n * \n * Universal typed foundation for all Continuum commands with modular parsing.\n * Implements the command interface standard across the entire system.\n * \n * ARCHITECTURE STATUS: \u2705 WELL-TYPED AND PROPERLY ABSTRACTED\n * \n * ISSUES IDENTIFIED:\n * - \u2705 No hardcoded magic strings detected\n * - \u2705 Proper TypeScript typing throughout\n * - \u2705 Good abstraction patterns\n * - \u2705 Follows middle-out methodology\n * \n * This file exemplifies good middle-out architecture:\n * - Foundation: Type-safe interfaces and base class\n * - API: Standardized command execution pattern\n * - Integration: Universal parser registry integration\n * - Testing: Built-in validation and error handling\n */\n\nimport type { CommandResult, CommandDefinition, ParameterDefinition } from '../../../types/shared/CommandTypes';\nimport type { ContinuumContext } from '../../../types/shared/core/ContinuumTypes';\nimport type { UUID } from 'crypto';\nimport { CLIClientParser } from '../../../parsers/integrations/cli-parser/client/CLIClientParser';\n\n// Re-export shared types for backward compatibility\nexport type { CommandResult, CommandDefinition, ParameterDefinition, ContinuumContext };\n\n// Import the modular parser system\nimport { IntegrationParserRegistry } from './parsers';\n\n// WebSocket commands MUST have sessionId - enforced by linter\nexport interface WebSocketContinuumContext extends ContinuumContext {\n  sessionId: UUID; // Required, non-null for WebSocket commands\n  connectionId: string; // Required for WebSocket routing\n}\n\n// CommandResult is now imported from shared types\n\nexport interface RegistryEntry {\n  name: string;\n  execute: (parameters: unknown, context: ContinuumContext) => Promise<CommandResult>;\n  definition: CommandDefinition;\n}\n\n/**\n * Abstract base class for all Continuum commands\n * Provides type safety, consistent interfaces, and common functionality\n */\nexport abstract class BaseCommand {\n  /**\n   * Get command definition - must be implemented by subclasses\n   */\n  static getDefinition(): CommandDefinition {\n    throw new Error('getDefinition() must be implemented by subclass');\n  }\n\n  /**\n   * Execute command - implement this in subclasses with typed parameters\n   * Parameters are automatically parsed and validated before calling this method\n   * \n   * @param params - Raw parameters (will be validated and cast to TParams)\n   * @param context - Execution context\n   * @returns Promise resolving to command result\n   */\n  static async execute(_params: unknown, _context: ContinuumContext): Promise<CommandResult> {\n    throw new Error('execute() must be implemented by subclass with typed parameters');\n  }\n\n  // Note: validateParams method removed to avoid conflicts with existing file command implementations\n  // Commands should use the inline pattern demonstrated in ExecCommand instead\n\n  // Note: getTypedParams method removed due to static inheritance limitations\n  // Commands should use the inline pattern demonstrated in ExecCommand instead\n\n  /**\n   * Generic typed execution pattern - eliminates 'any' parameters\n   * Use this in your execute method for automatic type safety and error handling\n   * \n   * @param rawParams - Raw parameters from command call\n   * @param context - Execution context\n   * @param validator - Type guard function that validates and throws descriptive errors\n   * @param executor - Your typed execution function\n   * @returns Promise resolving to command result with automatic error handling\n   */\n  public static async executeWithStrongTypes<T>(\n    rawParams: unknown,\n    context: ContinuumContext,\n    validator: (params: unknown) => params is T,\n    executor: (params: T, context: ContinuumContext) => Promise<CommandResult>\n  ): Promise<CommandResult> {\n    try {\n      // Step 1 & 2: Parse CLI arguments automatically (includes validation)\n      const parsedParams = BaseCommand.preprocessParameters(rawParams);\n      \n      // Step 3: Validate with custom type guard\n      validator(parsedParams);\n      const typedParams = parsedParams as T;\n      \n      // Step 4: Execute with strongly typed parameters\n      return await executor(typedParams, context);\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        success: false,\n        error: errorMessage,\n        timestamp: new Date().toISOString()\n      };\n    }\n  }\n\n  /**\n   * Parse CLI arguments using the shared CLI parser\n   * Public method available to all commands for consistent CLI parsing\n   */\n  public static parseCliArguments(params: Record<string, unknown>): Record<string, unknown> {\n    // Handle CLI-style arguments if present in args array\n    if (params.args && Array.isArray(params.args)) {\n      const cliParser = new CLIClientParser();\n      const parsedArgs = cliParser.parseInput({ args: params.args as string[] });\n      \n      // Merge CLI parsed args with existing params (CLI args take precedence)\n      return { ...params, ...parsedArgs };\n    }\n    \n    // Return as-is if no CLI args to parse\n    return params;\n  }\n  \n  /**\n   * Automatic parameter preprocessing for clean command pattern\n   * Handles CLI parsing transparently so commands don't need to know about it\n   */\n  protected static preprocessParameters(parameters: unknown): Record<string, unknown> {\n    // Basic validation\n    if (typeof parameters !== 'object' || parameters === null) {\n      throw new Error('Parameters must be a non-null object');\n    }\n    \n    // Automatic CLI parsing (transparent to commands)\n    return BaseCommand.parseCliArguments(parameters as Record<string, unknown>);\n  }\n  \n\n  /**\n   * Parse parameters using modular integration parser system\n   * Any format to BaseCommand's canonical JSON format\n   * \n   * \u26A0\uFE0F  INTERNAL USE ONLY: Should only be called by UniversalCommandRegistry\n   * \u26A0\uFE0F  Individual commands should NOT call this - parameters are pre-parsed\n   */\n  static _registryParseParams<T = unknown>(params: unknown): T {\n    return IntegrationParserRegistry.parse<T>(params);\n  }\n\n  /**\n   * Get typed parameters - ensures parameters are pre-parsed by registry\n   * \n   * @param params - Parameters that should already be parsed by UniversalCommandRegistry\n   * @returns Typed parameters with runtime validation that they're pre-parsed\n   */\n  protected static args<T = unknown>(params: unknown): T {\n    // Verify parameters are already in canonical JSON format (not CLI args)\n    if (typeof params === 'object' && params !== null && 'args' in params) {\n      console.warn('\u26A0\uFE0F  CLI args detected - parameters should be pre-parsed by registry');\n      console.warn('\u26A0\uFE0F  This suggests UniversalCommandRegistry is not parsing properly');\n    }\n    \n    return params as T;\n  }\n\n  /**\n   * @deprecated Do not call parseParams in commands - parameters are pre-parsed by registry\n   * Use args<T>() instead for type-safe access to pre-parsed parameters\n   */\n  protected static parseParams<T = unknown>(params: unknown): T {\n    console.warn('\u26A0\uFE0F  parseParams called in command - parameters should be pre-parsed by registry');\n    console.warn('\u26A0\uFE0F  Use args<T>() instead for type-safe access to pre-parsed parameters');\n    return IntegrationParserRegistry.parse<T>(params);\n  }\n\n  /**\n   * Create standardized success result\n   * Legacy signature: createSuccessResult(message, data) or createSuccessResult(data)\n   */\n  protected static createSuccessResult<T = unknown>(\n    messageOrData?: string | T,\n    data?: T\n  ): CommandResult<T> {\n    const result: CommandResult<T> = {\n      success: true,\n      timestamp: new Date().toISOString()\n    };\n    \n    // Handle legacy signature: createSuccessResult(message, data)\n    if (typeof messageOrData === 'string' && data !== undefined) {\n      result.data = data;\n      // Legacy message parameter is ignored - data takes precedence\n    } else if (messageOrData !== undefined) {\n      // New signature: createSuccessResult(data)\n      result.data = messageOrData as T;\n    }\n    \n    return result;\n  }\n\n  /**\n   * Create standardized error result\n   */\n  protected static createErrorResult(\n    error: string,\n    _data?: unknown  // Legacy parameter - maintained for backward compatibility\n  ): CommandResult {\n    return {\n      success: false,\n      error,\n      timestamp: new Date().toISOString()\n    };\n  }\n\n  /**\n   * Validate required parameters\n   */\n  protected static validateRequired(\n    params: unknown, \n    requiredFields: string[]\n  ): { valid: boolean; missing: string[] } {\n    const missing: string[] = [];\n    \n    for (const field of requiredFields) {\n      if ((params as Record<string, unknown>)[field] === undefined || (params as Record<string, unknown>)[field] === null) {\n        missing.push(field);\n      }\n    }\n    \n    return {\n      valid: missing.length === 0,\n      missing\n    };\n  }\n\n  /**\n   * Log command execution with consistent format\n   */\n  protected static logExecution(\n    commandName: string, \n    params: unknown, \n    context: ContinuumContext\n  ): void {\n    const sessionInfo = context.sessionId ? ` [${context.sessionId}]` : '';\n    console.log(`\uD83C\uDFAF COMMAND: ${commandName}${sessionInfo} - params:`, params);\n  }\n\n  /**\n   * Broadcast message to WebSocket clients if available\n   */\n  protected static async broadcast(\n    context: ContinuumContext,\n    message: unknown\n  ): Promise<void> {\n    if (context.webSocketServer && typeof context.webSocketServer.broadcast === 'function') {\n      try {\n        const messageStr = typeof message === 'string' ? message : JSON.stringify(message);\n        context.webSocketServer.broadcast(messageStr);\n      } catch (error) {\n        console.error('Failed to broadcast message:', error);\n      }\n    }\n  }\n\n  /**\n   * Update continuon status if available\n   */\n  protected static async updateStatus(\n    context: ContinuumContext | undefined,\n    status: string,\n    data?: unknown\n  ): Promise<void> {\n    if (context?.continuumStatus && typeof (context.continuumStatus as any).update === 'function') {\n      try {\n        (context.continuumStatus as any).update(status, data);\n      } catch (error) {\n        console.error('Failed to update continuum status:', error);\n      }\n    }\n  }\n\n  /**\n   * Create command registry entry\n   */\n  static createRegistryEntry(): RegistryEntry {\n    const definition = this.getDefinition();\n    return {\n      name: definition.name.toUpperCase(),\n      execute: this.execute.bind(this),\n      definition\n    };\n  }\n}", "// ISSUES: 0 open, last updated 2025-07-16 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * File Command Types - Consolidated from src/types/shared/FileOperations.ts\n * \n * Following middle-out architecture pattern:\n * - Shared types used across client, server, and remote contexts\n * - Centralized type definitions to prevent inconsistencies\n * - Unified interfaces for all file operations\n */\n\nimport type { UUID } from 'crypto';\n\n/**\n * Artifact types for file operations\n * Centralizes all artifact type definitions to prevent inconsistencies\n */\nexport enum ArtifactType {\n  SCREENSHOT = 'screenshot',\n  LOG = 'log', \n  RECORDING = 'recording',\n  FILE = 'file',\n  DEVTOOLS = 'devtools',\n  METADATA = 'metadata'\n}\n\n/**\n * Unified parameters for all file operations\n * Replaces inconsistent FileWriteParams and fileSave options\n */\nexport interface FileOperationParams {\n  content: string | Buffer | Uint8Array;\n  filename: string;\n  artifactType?: ArtifactType;\n  encoding?: BufferEncoding;\n  sessionId?: UUID;\n  marshalId?: string; // For command chaining correlation\n}\n\n/**\n * Standardized result format for all file operations\n * Ensures consistent response structure across all file commands\n */\nexport interface FileOperationResult {\n  filename: string;\n  filepath: string;\n  size: number;\n  artifactType: ArtifactType;\n  sessionId: UUID;\n  timestamp: string;\n  success: boolean;\n  error?: string;\n}\n\n/**\n * Directory resolution parameters for consistent path handling\n */\nexport interface DirectoryResolutionParams {\n  sessionId?: UUID;\n  artifactType?: ArtifactType;\n  relativePath?: string;\n  absolutePath?: string;\n}\n\n/**\n * Resolved path information\n */\nexport interface ResolvedPath {\n  absolute: string;\n  relative: string;\n  sessionBased: boolean;\n}\n\n/**\n * Session-based file paths following the established structure:\n * .continuum/sessions/user/shared/{sessionId}/screenshots/\n * .continuum/sessions/user/shared/{sessionId}/logs/\n * etc.\n */\nexport interface SessionPaths {\n  base: string;\n  logs: string;\n  screenshots: string;\n  recordings: string;\n  files: string;\n  devtools: string;\n}\n\n/**\n * Session structure for file operations\n */\nexport interface SessionStructure {\n  sessionId: UUID;\n  paths: SessionPaths;\n  type: 'development' | 'production' | 'test';\n  owner: string;\n}\n\n/**\n * File validation result\n */\nexport interface FileValidationResult {\n  valid: boolean;\n  errors: string[];\n  warnings: string[];\n}\n\n/**\n * File operation metadata\n */\nexport interface FileOperationMetadata {\n  operation: string;\n  timestamp: string;\n  sessionId: UUID;\n  artifactType: ArtifactType;\n  size?: number;\n  encoding?: BufferEncoding;\n}\n\n/**\n * File command context for consistent operation tracking\n */\nexport interface FileCommandContext {\n  sessionId: UUID;\n  requestId: string;\n  timestamp: number;\n  artifactType: ArtifactType;\n  metadata?: Record<string, any>;\n}\n\n/**\n * FileSave client options\n */\nexport interface FileSaveClientOptions {\n  content: string | Uint8Array;\n  filename: string;\n  artifactType?: ArtifactType | undefined;\n}\n\n/**\n * FileSave client result\n */\nexport interface FileSaveClientResult {\n  success: boolean;\n  data?: {\n    filename: string;\n    filepath: string;\n    size: number;\n    artifactType: ArtifactType;\n    sessionId: string;\n    timestamp: string;\n  };\n  error?: string;\n}", "// ISSUES: 0 open, last updated 2025-07-14 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * BaseFileCommand - Shared functionality for all file operations\n * \n * Provides common methods for file path resolution, session integration,\n * and ContinuumDirectoryDaemon communication\n * \n * Now uses shared types and simplified session-based path resolution\n */\n\nimport { BaseCommand } from '../../core/base-command/BaseCommand';\nimport { ArtifactType } from './FileTypes';\n\n// Browser-compatible path utilities\nconst pathUtils = {\n  join: (...parts: string[]) => {\n    return parts.join('/').replace(/\\/+/g, '/');\n  },\n  dirname: (filePath: string) => {\n    const parts = filePath.split('/');\n    return parts.slice(0, -1).join('/') || '/';\n  }\n};\n\n// Strongly typed enums for daemon operations\nexport enum FileSystemOperation {\n  READ_DIRECTORY = 'read_directory',\n  CREATE_DIRECTORY = 'create_directory', \n  WRITE_FILE = 'write_file',\n  READ_FILE = 'read_file',\n  APPEND_FILE = 'append_file',\n  DELETE_FILE = 'delete_file',\n  GET_FILE_STATS = 'get_file_stats',\n  CHECK_FILE_ACCESS = 'check_file_access'\n}\n\nexport enum DirectoryOperation {\n  GET_ROOT_DIRECTORY = 'get_root_directory',\n  GET_SESSION_DIRECTORY = 'get_session_directory',\n  CREATE_SESSION_STRUCTURE = 'create_session_structure',\n  GET_ARTIFACT_LOCATION = 'get_artifact_location'\n}\n\nexport abstract class BaseFileCommand extends BaseCommand {\n  \n  /**\n   * Get .continuum root directory from ContinuumDirectoryDaemon\n   */\n  protected static async getContinuumRoot(): Promise<string> {\n    try {\n      const response = await this.delegateToContinuumDirectoryDaemon(DirectoryOperation.GET_ROOT_DIRECTORY, {});\n      return response.rootPath;\n    } catch (error) {\n      // Fallback during development\n      console.warn('ContinuumDirectoryDaemon delegation failed, using fallback:', error);\n      // Use working directory for git hook validation, not user home directory\n      const workingDir = typeof process !== 'undefined' ? process.cwd() : '';\n      return pathUtils.join(workingDir, '.continuum');\n    }\n  }\n\n  /**\n   * DEPRECATED: Complex findSessionPath logic replaced with simple session structure\n   * Use getTargetPath() instead which uses predictable session paths\n   */\n  protected static async findSessionPath(sessionId: string): Promise<string | null> {\n    console.warn('findSessionPath is deprecated. Use getTargetPath() for predictable session structure.');\n    const continuumRoot = await this.getContinuumRoot();\n    return pathUtils.join(continuumRoot, 'sessions', 'user', 'shared', sessionId);\n  }\n\n  /**\n   * Get artifact subdirectory name following daemon conventions\n   * Now uses shared ArtifactType enum for consistency\n   */\n  protected static getArtifactSubdirectory(artifactType?: ArtifactType | string): string {\n    switch (artifactType) {\n      case ArtifactType.SCREENSHOT:\n      case 'screenshot': return 'screenshots';\n      case ArtifactType.LOG:\n      case 'log': return 'logs';\n      case ArtifactType.RECORDING:\n      case 'recording': return 'recordings';\n      case ArtifactType.FILE:\n      case 'file': return 'files';\n      case ArtifactType.DEVTOOLS:\n      case 'devtools': return 'devtools';\n      case ArtifactType.METADATA:\n      case 'metadata': return 'metadata';\n      default: return 'files';\n    }\n  }\n\n  /**\n   * Ensure directory exists using ContinuumFileSystemDaemon\n   */\n  protected static async ensureDirectoryExists(dirPath: string): Promise<void> {\n    try {\n      await this.delegateToContinuumFileSystemDaemon(FileSystemOperation.CREATE_DIRECTORY, { \n        path: dirPath, \n        recursive: true \n      });\n    } catch (error) {\n      throw new Error(`Failed to create directory ${dirPath}: ${error}`);\n    }\n  }\n\n  /**\n   * Get target path for file operation using simple session context-based path resolution\n   * Replaces complex findSessionPath logic with predictable session structure\n   */\n  protected static async getTargetPath(params: {\n    filename: string;\n    sessionId: string | undefined;\n    artifactType: ArtifactType | string | undefined;\n    directory?: string | undefined;\n  }): Promise<string> {\n    // If directory is explicitly provided, use it\n    if (params.directory) {\n      return pathUtils.join(params.directory, params.filename);\n    }\n\n    const continuumRoot = await this.getContinuumRoot();\n    \n    // If no session ID, write to general location\n    if (!params.sessionId) {\n      const defaultDir = params.artifactType ? \n        pathUtils.join(continuumRoot, this.getArtifactSubdirectory(params.artifactType)) : \n        pathUtils.join(continuumRoot, 'files');\n      return pathUtils.join(defaultDir, params.filename);\n    }\n\n    // Use predictable session structure: .continuum/sessions/user/shared/{sessionId}\n    const sessionPath = pathUtils.join(continuumRoot, 'sessions', 'user', 'shared', params.sessionId);\n    \n    // Add artifact subdirectory if specified\n    if (params.artifactType) {\n      const artifactSubdir = this.getArtifactSubdirectory(params.artifactType);\n      return pathUtils.join(sessionPath, artifactSubdir, params.filename);\n    }\n    \n    return pathUtils.join(sessionPath, params.filename);\n  }\n\n  /**\n   * Log file operation for debugging and forensics\n   */\n  protected static async logFileOperation(operation: string, targetPath: string, metadata: any = {}): Promise<void> {\n    try {\n      const continuumRoot = await this.getContinuumRoot();\n      const logDir = pathUtils.join(continuumRoot, 'logs');\n      await this.ensureDirectoryExists(logDir);\n\n      const logEntry = {\n        timestamp: new Date().toISOString(),\n        operation,\n        path: targetPath,\n        ...metadata\n      };\n\n      const logFile = pathUtils.join(logDir, 'file-operations.log');\n      const logLine = JSON.stringify(logEntry) + '\\n';\n      \n      await this.delegateToContinuumFileSystemDaemon(FileSystemOperation.APPEND_FILE, {\n        path: logFile,\n        content: logLine,\n        encoding: 'utf8'\n      });\n    } catch {\n      // Don't fail the main operation if logging fails\n    }\n  }\n\n  /**\n   * Get file stats safely\n   */\n  protected static async getFileStats(filePath: string): Promise<any | null> {\n    try {\n      return await this.delegateToContinuumFileSystemDaemon(FileSystemOperation.GET_FILE_STATS, { path: filePath });\n    } catch {\n      return null;\n    }\n  }\n\n  /**\n   * Check if file exists\n   */\n  protected static async fileExists(filePath: string): Promise<boolean> {\n    try {\n      await this.delegateToContinuumFileSystemDaemon(FileSystemOperation.CHECK_FILE_ACCESS, { path: filePath });\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Delegate filesystem operations to ContinuumFileSystemDaemon\n   * All file commands use this pattern for actual filesystem operations\n   */\n  protected static async delegateToContinuumFileSystemDaemon(operation: FileSystemOperation, params: any): Promise<any> {\n    try {\n      const daemonMessage = {\n        type: 'daemon_request',\n        target: 'continuum-filesystem',\n        operation,\n        params,\n        requestId: `file_${operation}_${Date.now()}`,\n        timestamp: Date.now()\n      };\n      \n      const response = await this.sendDaemonMessage(daemonMessage);\n      \n      if (response.success) {\n        return response.data;\n      } else {\n        throw new Error(response.error || `Filesystem ${operation} failed`);\n      }\n      \n    } catch (error) {\n      // For critical file operations, provide fallback implementations\n      console.warn(`ContinuumFileSystemDaemon ${operation} failed, using fallback:`, error);\n      return this.fallbackFileOperation(operation, params);\n    }\n  }\n\n  /**\n   * Delegate directory operations to ContinuumDirectoryDaemon\n   */\n  protected static async delegateToContinuumDirectoryDaemon(operation: DirectoryOperation, params: any): Promise<any> {\n    try {\n      const daemonMessage = {\n        type: 'daemon_request',\n        target: 'continuum-directory',\n        operation,\n        params,\n        requestId: `dir_${operation}_${Date.now()}`,\n        timestamp: Date.now()\n      };\n      \n      const response = await this.sendDaemonMessage(daemonMessage);\n      \n      if (response.success) {\n        return response.data;\n      } else {\n        throw new Error(response.error || `Directory ${operation} failed`);\n      }\n      \n    } catch (error) {\n      console.warn(`ContinuumDirectoryDaemon ${operation} failed, using fallback:`, error);\n      return this.fallbackDirectoryOperation(operation, params);\n    }\n  }\n\n  /**\n   * Send message via internal daemon message bus (not WebSocket ports)\n   * Commands communicate with daemons through the CommandProcessorDaemon bus\n   */\n  protected static async sendDaemonMessage(_message: any): Promise<any> {\n    // TODO: Use internal daemon message bus via CommandProcessorDaemon\n    // Daemons communicate via internal bus, NOT across ports\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve({\n          success: false,\n          error: 'Internal daemon bus communication not yet implemented',\n          mockMode: true\n        });\n      }, 10); // Quick fallback for file operations\n    });\n  }\n\n  /**\n   * Fallback file operations for development mode\n   */\n  protected static async fallbackFileOperation(operation: FileSystemOperation, params: any): Promise<any> {\n    // Only available in Node.js environment\n    if (typeof window !== 'undefined') {\n      throw new Error('File operations not available in browser environment');\n    }\n    \n    // Use eval to avoid bundling Node.js fs module into browser\n    // eslint-disable-next-line no-eval\n    const fs = await eval('import(\"fs/promises\")');\n    \n    switch (operation) {\n      case FileSystemOperation.READ_DIRECTORY:\n        return await fs.readdir(params.path, { withFileTypes: params.withFileTypes });\n      case FileSystemOperation.CREATE_DIRECTORY:\n        await fs.mkdir(params.path, { recursive: params.recursive });\n        return { success: true };\n      case FileSystemOperation.WRITE_FILE:\n        await fs.writeFile(params.path, params.content, params.encoding ? { encoding: params.encoding } : undefined);\n        return { success: true };\n      case FileSystemOperation.APPEND_FILE:\n        await fs.appendFile(params.path, params.content, { encoding: params.encoding });\n        return { success: true };\n      case FileSystemOperation.GET_FILE_STATS:\n        return await fs.stat(params.path);\n      case FileSystemOperation.CHECK_FILE_ACCESS:\n        await fs.access(params.path);\n        return { success: true };\n      default:\n        throw new Error(`Unknown file operation: ${operation}`);\n    }\n  }\n\n  /**\n   * Fallback directory operations for development mode\n   */\n  protected static async fallbackDirectoryOperation(operation: DirectoryOperation, _params: any): Promise<any> {\n    // Only available in Node.js environment\n    if (typeof window !== 'undefined') {\n      throw new Error('Directory operations not available in browser environment');\n    }\n    \n    // Use eval to avoid bundling Node.js fs module into browser\n    // eslint-disable-next-line no-eval\n    const fs = await eval('import(\"fs/promises\")');\n    \n    switch (operation) {\n      case DirectoryOperation.GET_ROOT_DIRECTORY:\n        // Use working directory for git hook validation, not user home directory\n        const workingDir = process.cwd();\n        const rootPath = pathUtils.join(workingDir, '.continuum');\n        await fs.mkdir(rootPath, { recursive: true });\n        return { rootPath };\n      default:\n        throw new Error(`Unknown directory operation: ${operation}`);\n    }\n  }\n}", "// ISSUES: 0 open, last updated 2025-07-16 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * FileValidator - Shared validation logic for all file operations\n * \n * Following middle-out architecture pattern:\n * - Shared validation logic used across client, server contexts\n * - Centralized validation rules to prevent inconsistencies\n * - Type-safe validation with detailed error reporting\n */\n\n// Browser-compatible path utilities\nconst pathUtils = {\n  extname: (filename: string) => {\n    const lastDot = filename.lastIndexOf('.');\n    return lastDot === -1 ? '' : filename.substring(lastDot);\n  },\n  basename: (filename: string, ext?: string) => {\n    const base = filename.split('/').pop() || filename;\n    return ext && base.endsWith(ext) ? base.slice(0, -ext.length) : base;\n  }\n};\nimport { FileOperationParams, FileValidationResult, ArtifactType } from './FileTypes';\n\n/**\n * File validation constraints\n */\nexport const FILE_CONSTRAINTS = {\n  MAX_FILENAME_LENGTH: 255,\n  MAX_FILE_SIZE: 50 * 1024 * 1024, // 50MB\n  ALLOWED_EXTENSIONS: ['.png', '.jpg', '.jpeg', '.gif', '.svg', '.txt', '.log', '.json', '.csv', '.md', '.html', '.css', '.js', '.ts'],\n  FORBIDDEN_CHARS: ['<', '>', ':', '\"', '|', '?', '*', '\\0'],\n  RESERVED_NAMES: ['CON', 'PRN', 'AUX', 'NUL', 'COM1', 'COM2', 'COM3', 'COM4', 'COM5', 'COM6', 'COM7', 'COM8', 'COM9', 'LPT1', 'LPT2', 'LPT3', 'LPT4', 'LPT5', 'LPT6', 'LPT7', 'LPT8', 'LPT9']\n};\n\n/**\n * Shared file validation logic\n */\nexport class FileValidator {\n  \n  /**\n   * Validate file operation parameters\n   */\n  static validateParams(params: FileOperationParams): FileValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    // Validate filename\n    const filenameResult = this.validateFilename(params.filename);\n    errors.push(...filenameResult.errors);\n    warnings.push(...filenameResult.warnings);\n\n    // Validate content\n    const contentResult = this.validateContent(params.content);\n    errors.push(...contentResult.errors);\n    warnings.push(...contentResult.warnings);\n\n    // Validate artifact type\n    if (params.artifactType) {\n      const artifactResult = this.validateArtifactType(params.artifactType);\n      errors.push(...artifactResult.errors);\n      warnings.push(...artifactResult.warnings);\n    }\n\n    // Validate encoding\n    if (params.encoding) {\n      const encodingResult = this.validateEncoding(params.encoding);\n      errors.push(...encodingResult.errors);\n      warnings.push(...encodingResult.warnings);\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  /**\n   * Validate filename\n   */\n  static validateFilename(filename: string): FileValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (!filename || typeof filename !== 'string') {\n      errors.push('Filename is required and must be a string');\n      return { valid: false, errors, warnings };\n    }\n\n    // Check length\n    if (filename.length > FILE_CONSTRAINTS.MAX_FILENAME_LENGTH) {\n      errors.push(`Filename too long (max ${FILE_CONSTRAINTS.MAX_FILENAME_LENGTH} characters)`);\n    }\n\n    // Check for forbidden characters\n    const forbiddenChars = FILE_CONSTRAINTS.FORBIDDEN_CHARS.filter(char => filename.includes(char));\n    if (forbiddenChars.length > 0) {\n      errors.push(`Filename contains forbidden characters: ${forbiddenChars.join(', ')}`);\n    }\n\n    // Check for reserved names\n    const baseName = pathUtils.basename(filename, pathUtils.extname(filename)).toUpperCase();\n    if (FILE_CONSTRAINTS.RESERVED_NAMES.includes(baseName)) {\n      errors.push(`Filename uses reserved name: ${baseName}`);\n    }\n\n    // Check extension\n    const ext = pathUtils.extname(filename).toLowerCase();\n    if (ext && !FILE_CONSTRAINTS.ALLOWED_EXTENSIONS.includes(ext)) {\n      warnings.push(`File extension ${ext} is not in allowed list`);\n    }\n\n    // Check for leading/trailing spaces\n    if (filename.trim() !== filename) {\n      warnings.push('Filename has leading or trailing spaces');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  /**\n   * Validate file content\n   */\n  static validateContent(content: string | Buffer | Uint8Array): FileValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (content === null || content === undefined) {\n      errors.push('Content is required');\n      return { valid: false, errors, warnings };\n    }\n\n    // Check content size\n    let size: number;\n    if (typeof content === 'string') {\n      size = Buffer.byteLength(content, 'utf8');\n    } else if (content instanceof Buffer) {\n      size = content.length;\n    } else if (content instanceof Uint8Array) {\n      size = content.length;\n    } else {\n      errors.push('Content must be string, Buffer, or Uint8Array');\n      return { valid: false, errors, warnings };\n    }\n\n    if (size > FILE_CONSTRAINTS.MAX_FILE_SIZE) {\n      errors.push(`Content too large (max ${FILE_CONSTRAINTS.MAX_FILE_SIZE} bytes)`);\n    }\n\n    if (size === 0) {\n      warnings.push('Content is empty');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  /**\n   * Validate artifact type\n   */\n  static validateArtifactType(artifactType: ArtifactType): FileValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (!Object.values(ArtifactType).includes(artifactType)) {\n      errors.push(`Invalid artifact type: ${artifactType}`);\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  /**\n   * Validate encoding\n   */\n  static validateEncoding(encoding: BufferEncoding): FileValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    const validEncodings: BufferEncoding[] = [\n      'ascii', 'utf8', 'utf-8', 'utf16le', 'ucs2', 'ucs-2', 'base64', 'base64url', 'latin1', 'binary', 'hex'\n    ];\n\n    if (!validEncodings.includes(encoding)) {\n      errors.push(`Invalid encoding: ${encoding}`);\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  /**\n   * Validate file path\n   */\n  static validatePath(filePath: string): FileValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (!filePath || typeof filePath !== 'string') {\n      errors.push('File path is required and must be a string');\n      return { valid: false, errors, warnings };\n    }\n\n    // Check for absolute path traversal attempts\n    if (filePath.includes('..')) {\n      errors.push('Path traversal not allowed');\n    }\n\n    // Check for null bytes\n    if (filePath.includes('\\0')) {\n      errors.push('Path contains null bytes');\n    }\n\n    // Check path length\n    if (filePath.length > 4096) {\n      errors.push('Path too long (max 4096 characters)');\n    }\n\n    // Basic path normalization for browser compatibility\n    const normalizedPath = filePath.replace(/\\\\/g, '/').replace(/\\/+/g, '/');\n    if (normalizedPath !== filePath) {\n      warnings.push('Path was normalized during validation');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  /**\n   * Validate session ID format\n   */\n  static validateSessionId(sessionId: string): FileValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (!sessionId || typeof sessionId !== 'string') {\n      errors.push('Session ID is required and must be a string');\n      return { valid: false, errors, warnings };\n    }\n\n    // Check UUID format (basic validation)\n    const uuidPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n    if (!uuidPattern.test(sessionId)) {\n      errors.push('Session ID must be a valid UUID format');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n}", "// ISSUES: 0 open, last updated 2025-07-16 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * FileClient - Base client class for browser-side file operations\n * \n * Following middle-out architecture pattern:\n * - Client-specific functionality for browser context\n * - Extends shared BaseFileCommand for common operations\n * - Handles browser-specific APIs and constraints\n */\n\nimport { BaseFileCommand } from '../shared/BaseFileCommand';\nimport { FileOperationParams, FileOperationResult, FileValidationResult } from '../shared/FileTypes';\nimport { FileValidator } from '../shared/FileValidator';\n\n/**\n * Browser-specific file operation result\n */\nexport interface BrowserFileResult extends FileOperationResult {\n  dataUrl?: string; // For preview purposes\n  blob?: Blob; // Browser-specific blob data\n}\n\n/**\n * Base client class for browser-side file operations\n */\nexport abstract class FileClient extends BaseFileCommand {\n  \n  /**\n   * Get continuum global instance\n   */\n  protected static getContinuumInstance(): any {\n    const continuum = (window as any).continuum;\n    if (!continuum) {\n      throw new Error('Continuum not available in browser context');\n    }\n    return continuum;\n  }\n\n  /**\n   * Validate file operation parameters using shared validator\n   */\n  protected static validateParams(params: FileOperationParams): FileValidationResult {\n    return FileValidator.validateParams(params);\n  }\n\n  /**\n   * Send file operation to server via continuum.execute()\n   */\n  protected static async sendToServer(command: string, params: Record<string, any>): Promise<any> {\n    const continuum = this.getContinuumInstance();\n    return await continuum.execute(command, params);\n  }\n\n  /**\n   * Convert content to base64 for server transport\n   */\n  protected static async convertToBase64(content: string | Uint8Array): Promise<string> {\n    if (typeof content === 'string') {\n      return btoa(content);\n    }\n\n    // Handle Uint8Array using FileReader for large files\n    if (content instanceof Uint8Array) {\n      const blob = new Blob([content]);\n      const reader = new FileReader();\n      \n      return new Promise<string>((resolve, reject) => {\n        reader.onload = (): void => {\n          const result = reader.result as string;\n          // Remove the data URL prefix to get just the base64 content\n          const base64Data = result.split(',')[1];\n          resolve(base64Data);\n        };\n        reader.onerror = (): void => reject(reader.error);\n        reader.readAsDataURL(blob);\n      });\n    }\n\n    throw new Error('Unsupported content type for base64 conversion');\n  }\n\n  /**\n   * Convert base64 to Uint8Array for processing\n   */\n  protected static base64ToUint8Array(base64: string): Uint8Array {\n    const binaryString = atob(base64);\n    const bytes = new Uint8Array(binaryString.length);\n    for (let i = 0; i < binaryString.length; i++) {\n      bytes[i] = binaryString.charCodeAt(i);\n    }\n    return bytes;\n  }\n\n  /**\n   * Create data URL for preview purposes\n   */\n  protected static createDataUrl(content: string | Uint8Array, mimeType: string): string {\n    if (typeof content === 'string') {\n      return `data:${mimeType};base64,${btoa(content)}`;\n    }\n    \n    if (content instanceof Uint8Array) {\n      const blob = new Blob([content], { type: mimeType });\n      return URL.createObjectURL(blob);\n    }\n    \n    throw new Error('Unsupported content type for data URL creation');\n  }\n\n  /**\n   * Detect MIME type from filename\n   */\n  protected static detectMimeType(filename: string): string {\n    const ext = filename.split('.').pop()?.toLowerCase();\n    \n    switch (ext) {\n      case 'png': return 'image/png';\n      case 'jpg':\n      case 'jpeg': return 'image/jpeg';\n      case 'gif': return 'image/gif';\n      case 'svg': return 'image/svg+xml';\n      case 'webp': return 'image/webp';\n      case 'pdf': return 'application/pdf';\n      case 'txt': return 'text/plain';\n      case 'html': return 'text/html';\n      case 'css': return 'text/css';\n      case 'js': return 'application/javascript';\n      case 'json': return 'application/json';\n      default: return 'application/octet-stream';\n    }\n  }\n\n  /**\n   * Log client-side file operation\n   */\n  protected static logClientOperation(operation: string, params: any): void {\n    console.log(`\uD83D\uDCBE FileClient: ${operation}`, {\n      filename: params.filename,\n      size: params.content?.length || 0,\n      artifactType: params.artifactType,\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  /**\n   * Handle client-side errors consistently\n   */\n  protected static handleClientError(error: any, operation: string): never {\n    console.error(`\u274C FileClient: ${operation} failed:`, error);\n    throw new Error(`File ${operation} failed: ${error instanceof Error ? error.message : String(error)}`);\n  }\n\n  /**\n   * Check if browser supports required APIs\n   */\n  protected static checkBrowserSupport(): { supported: boolean; missing: string[] } {\n    const missing: string[] = [];\n    \n    if (!window.FileReader) missing.push('FileReader');\n    if (!window.Blob) missing.push('Blob');\n    if (!window.URL) missing.push('URL');\n    if (!window.atob) missing.push('atob');\n    if (!window.btoa) missing.push('btoa');\n    \n    return {\n      supported: missing.length === 0,\n      missing\n    };\n  }\n}", "// ISSUES: 0 open, last updated 2025-07-16 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * FileSaveClient - Browser-side file saving functionality\n * \n * Following middle-out architecture pattern:\n * - Handles browser-specific file operations\n * - Converts binary data to base64 for server transport\n * - Provides clean API for screenshot and other file saves\n */\n\nimport { FileClient } from '../../client/FileClient';\nimport { ArtifactType, FileSaveClientOptions, FileSaveClientResult } from '../../shared/FileTypes';\n\n/**\n * Client-side file save implementation extending FileClient\n */\nexport class FileSaveClient extends FileClient {\n  private static instance: FileSaveClient | null = null;\n\n  /**\n   * Get singleton instance\n   */\n  static getInstance(): FileSaveClient {\n    FileSaveClient.instance ??= new FileSaveClient();\n    return FileSaveClient.instance;\n  }\n\n  /**\n   * Save file through the server command\n   */\n  async saveFile(options: FileSaveClientOptions): Promise<FileSaveClientResult> {\n    try {\n      // 1. Check browser support\n      const browserSupport = FileSaveClient.checkBrowserSupport();\n      if (!browserSupport.supported) {\n        throw new Error(`Browser missing required APIs: ${browserSupport.missing.join(', ')}`);\n      }\n\n      // 2. Log client operation\n      FileSaveClient.logClientOperation('saveFile', options);\n\n      // 3. Get continuum instance\n      const continuum = FileSaveClient.getContinuumInstance();\n\n      // 4. Convert content to base64 for server transport\n      const base64Content = await FileSaveClient.convertToBase64(options.content);\n\n      // 5. Basic validation\n      if (!base64Content) {\n        throw new Error('Base64 content conversion failed');\n      }\n\n      // 6. Execute the server-side save command\n      const result = await continuum.execute('file_save', {\n        filename: options.filename,\n        content: base64Content,\n        encoding: 'base64',\n        artifactType: options.artifactType ?? ArtifactType.SCREENSHOT\n      });\n\n      return {\n        success: true,\n        data: result.data || result\n      };\n\n    } catch (error) {\n      console.error('\u274C FileSaveClient: Save failed:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error)\n      };\n    }\n  }\n\n  /**\n   * Save file with preview generation\n   */\n  async saveFileWithPreview(options: FileSaveClientOptions): Promise<FileSaveClientResult & { preview?: string }> {\n    try {\n      // Save the file\n      const result = await this.saveFile(options);\n\n      // Generate preview if it's an image\n      if (result.success && result.data) {\n        const mimeType = FileSaveClient.detectMimeType(options.filename);\n        if (mimeType.startsWith('image/')) {\n          const preview = FileSaveClient.createDataUrl(options.content, mimeType);\n          return { ...result, preview };\n        }\n      }\n\n      return result;\n    } catch (error) {\n      FileSaveClient.handleClientError(error, 'saveFileWithPreview');\n    }\n  }\n}\n\n/**\n * Convenience function for file saving\n */\nexport async function saveFile(options: FileSaveClientOptions): Promise<FileSaveClientResult> {\n  const client = FileSaveClient.getInstance();\n  return await client.saveFile(options);\n}\n\n/**\n * Convenience function for file saving with preview\n */\nexport async function saveFileWithPreview(options: FileSaveClientOptions): Promise<FileSaveClientResult & { preview?: string }> {\n  const client = FileSaveClient.getInstance();\n  return await client.saveFileWithPreview(options);\n}\n\n// Make available globally for backward compatibility\n// TODO: Remove in future versions\n(window as any).FileSaveClient = FileSaveClient;\n(window as any).saveFile = saveFile;\n(window as any).saveFileWithPreview = saveFileWithPreview;", "/**\n * ScreenshotBase - Shared foundation for all screenshot functionality\n * \n * Following middle-out architecture pattern:\n * - Centralized html2canvas management\n * - Common validation and processing logic\n * - Shared error handling and logging\n * - Unified element targeting system\n */\n\nimport { ScreenshotFormat } from './ScreenshotTypes';\n\nexport interface ScreenshotBaseOptions {\n  selector?: string;\n  querySelector?: string;\n  filename?: string;\n  format?: ScreenshotFormat;\n  quality?: number;\n  width?: number;\n  height?: number;\n  scale?: number;\n  cropX?: number;\n  cropY?: number;\n  cropWidth?: number;\n  cropHeight?: number;\n  elementName?: string;\n  maxFileSize?: number;\n}\n\nexport interface ScreenshotCaptureResult {\n  imageData: string;\n  format: ScreenshotFormat;\n  selector: string;\n  filename: string;\n  width: number;\n  height: number;\n  elementName: string;\n  originalWidth: number;\n  originalHeight: number;\n  scale: number;\n  cropped: boolean;\n  compressed: boolean;\n  fileSizeBytes: number;\n  dataUrl: string;\n}\n\n/**\n * Abstract base class for screenshot implementations\n * Provides common functionality for client and server contexts\n */\nexport abstract class ScreenshotBase {\n  protected static html2canvasLoaded = false;\n  protected static html2canvasPromise: Promise<any> | null = null;\n\n  /**\n   * Dynamically load html2canvas library (shared across all instances)\n   */\n  protected static async loadHtml2Canvas(): Promise<any> {\n    if (typeof window === 'undefined') {\n      throw new Error('html2canvas is only available in browser context');\n    }\n\n    // Return cached instance if already loaded\n    if ((window as any).html2canvas) {\n      return (window as any).html2canvas;\n    }\n\n    // Return existing promise if already loading\n    if (this.html2canvasPromise) {\n      return this.html2canvasPromise;\n    }\n\n    // Create new loading promise\n    this.html2canvasPromise = new Promise((resolve, reject) => {\n      const script = document.createElement('script');\n      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';\n      script.onload = () => {\n        console.log('\u2705 html2canvas loaded successfully');\n        this.html2canvasLoaded = true;\n        const html2canvas = (window as any).html2canvas;\n        if (html2canvas) {\n          resolve(html2canvas);\n        } else {\n          reject(new Error('html2canvas not available after load'));\n        }\n      };\n      script.onerror = () => {\n        reject(new Error('Failed to load html2canvas library'));\n      };\n      document.head.appendChild(script);\n    });\n\n    return this.html2canvasPromise;\n  }\n\n  /**\n   * Find target element with fallback logic\n   */\n  protected static findTargetElement(options: ScreenshotBaseOptions): Element {\n    const selector = options.querySelector || options.selector || 'body';\n    \n    if (selector === 'body') {\n      return document.body;\n    }\n\n    const element = document.querySelector(selector);\n    if (!element) {\n      throw new Error(`Screenshot target not found: ${selector}`);\n    }\n\n    return element;\n  }\n\n  /**\n   * Get element name for logging (simplified)\n   */\n  protected static getElementName(element: Element): string {\n    // Return ID if available (most specific)\n    if (element.id) return `#${element.id}`;\n    \n    // Return first class if available\n    if (element.classList.length > 0) return `.${element.classList[0]}`;\n    \n    // Otherwise return the tag name\n    return element.tagName.toLowerCase();\n  }\n\n  /**\n   * Validate screenshot parameters\n   */\n  protected static validateOptions(options: ScreenshotBaseOptions): void {\n    if (options.scale && (options.scale < 0.1 || options.scale > 2.0)) {\n      throw new Error('Scale must be between 0.1 and 2.0');\n    }\n\n    if (options.quality && (options.quality < 0.1 || options.quality > 1.0)) {\n      throw new Error('Quality must be between 0.1 and 1.0');\n    }\n\n    if (options.width && options.width <= 0) {\n      throw new Error('Width must be positive');\n    }\n\n    if (options.height && options.height <= 0) {\n      throw new Error('Height must be positive');\n    }\n  }\n\n  /**\n   * Process canvas with AI-friendly features: scaling, cropping, compression\n   */\n  protected static processCanvas(\n    canvas: HTMLCanvasElement, \n    options: ScreenshotBaseOptions\n  ): HTMLCanvasElement {\n    const processedCanvas = document.createElement('canvas');\n    const ctx = processedCanvas.getContext('2d')!;\n    \n    // Determine final dimensions\n    let sourceX = options.cropX || 0;\n    let sourceY = options.cropY || 0;\n    let sourceWidth = options.cropWidth || canvas.width;\n    let sourceHeight = options.cropHeight || canvas.height;\n    \n    // Clamp crop dimensions to canvas bounds\n    sourceX = Math.max(0, Math.min(sourceX, canvas.width));\n    sourceY = Math.max(0, Math.min(sourceY, canvas.height));\n    sourceWidth = Math.min(sourceWidth, canvas.width - sourceX);\n    sourceHeight = Math.min(sourceHeight, canvas.height - sourceY);\n    \n    // Apply target dimensions (scale down if needed)\n    let targetWidth = options.width || sourceWidth;\n    let targetHeight = options.height || sourceHeight;\n    \n    // Maintain aspect ratio if only one dimension specified\n    if (options.width && !options.height) {\n      targetHeight = (sourceHeight * options.width) / sourceWidth;\n    } else if (options.height && !options.width) {\n      targetWidth = (sourceWidth * options.height) / sourceHeight;\n    }\n    \n    // Don't scale up, only down for AI efficiency\n    targetWidth = Math.min(targetWidth, sourceWidth);\n    targetHeight = Math.min(targetHeight, sourceHeight);\n    \n    processedCanvas.width = targetWidth;\n    processedCanvas.height = targetHeight;\n    \n    // Draw the processed image\n    ctx.drawImage(\n      canvas,\n      sourceX, sourceY, sourceWidth, sourceHeight,\n      0, 0, targetWidth, targetHeight\n    );\n    \n    return processedCanvas;\n  }\n\n  /**\n   * Generate filename with timestamp if not provided\n   */\n  protected static generateFilename(\n    options: ScreenshotBaseOptions,\n    format: ScreenshotFormat = ScreenshotFormat.PNG\n  ): string {\n    if (options.filename) {\n      return options.filename;\n    }\n    \n    const timestamp = Date.now();\n    const selector = options.querySelector || options.selector || 'body';\n    const elementName = selector.replace(/[^a-zA-Z0-9]/g, '-');\n    \n    return `screenshot-${elementName}-${timestamp}.${format}` as string;\n  }\n\n  /**\n   * Abstract method for executing screenshot capture\n   * Must be implemented by concrete classes\n   */\n  protected abstract executeCapture(options: ScreenshotBaseOptions): Promise<ScreenshotCaptureResult>;\n}", "/**\n * Unified Screenshot Client - Browser-side screenshot capture\n * \n * Combines functionality from:\n * - Original ScreenshotClient.ts (direct function calls)\n * - ScreenshotExecutor.ts (remote execution events)\n * \n * Following middle-out architecture pattern:\n * - Extends ScreenshotBase for shared functionality\n * - Handles both direct calls and remote execution\n * - Maintains backward compatibility\n */\n\nimport { ScreenshotBase, ScreenshotBaseOptions, ScreenshotCaptureResult } from '../shared/ScreenshotBase';\nimport type { ScreenshotClientRequest, ScreenshotResult, ScreenshotFormat } from '../shared/ScreenshotTypes';\nimport { RemoteExecutionResponse } from '../../../../ui/continuum-browser-client/types/WebSocketTypes';\n\ninterface ScreenshotClientParams extends ScreenshotClientRequest {\n  // Directory will be determined by session context, not passed explicitly\n}\n\n/**\n * Unified Screenshot Client Class\n * Handles both direct function calls and remote execution events\n */\nexport class ScreenshotClient extends ScreenshotBase {\n  private static instance: ScreenshotClient | null = null;\n  private isRegistered = false;\n\n  /**\n   * Singleton pattern for global event handler\n   */\n  static getInstance(): ScreenshotClient {\n    if (!ScreenshotClient.instance) {\n      ScreenshotClient.instance = new ScreenshotClient();\n    }\n    return ScreenshotClient.instance;\n  }\n\n  /**\n   * Register screenshot handler with WebSocket manager for remote execution\n   */\n  register(): void {\n    if (this.isRegistered) return;\n\n    document.addEventListener('continuum:remote_execution', this.handleRemoteExecution.bind(this) as EventListener);\n    this.isRegistered = true;\n    console.log('\uD83D\uDCF8 ScreenshotClient registered for remote execution');\n  }\n\n  /**\n   * Handle remote execution events - only respond to SCREENSHOT commands\n   */\n  private async handleRemoteExecution(event: Event): Promise<void> {\n    const customEvent = event as CustomEvent;\n    const { request, respond } = customEvent.detail;\n    \n    if (request.command.toUpperCase() !== 'SCREENSHOT') {\n      return; // Not our command, let other handlers deal with it\n    }\n\n    const startTime = Date.now();\n    console.log('\uD83D\uDCF8 ScreenshotClient handling remote screenshot request', request);\n\n    try {\n      const result = await this.executeCapture(request.params);\n      \n      const response: RemoteExecutionResponse = {\n        success: true,\n        data: result,\n        requestId: request.requestId,\n        clientMetadata: {\n          userAgent: navigator.userAgent,\n          timestamp: Date.now(),\n          executionTime: Date.now() - startTime\n        }\n      };\n\n      respond(response);\n\n    } catch (error) {\n      console.error('\u274C Remote screenshot execution failed:', error);\n      \n      const response: RemoteExecutionResponse = {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        requestId: request.requestId,\n        clientMetadata: {\n          userAgent: navigator.userAgent,\n          timestamp: Date.now(),\n          executionTime: Date.now() - startTime\n        }\n      };\n\n      respond(response);\n    }\n  }\n\n  /**\n   * Direct screenshot capture function (maintains backward compatibility)\n   */\n  async captureScreenshot(params: ScreenshotClientParams): Promise<ScreenshotResult> {\n    console.log('\uD83D\uDCF8 BROWSER: Starting AI-enhanced screenshot capture');\n    console.log('\uD83D\uDCCB BROWSER: Params:', params);\n    \n    try {\n      const result = await this.executeCapture(params as ScreenshotBaseOptions);\n      \n      // Convert base64 to Uint8Array for fileSave\n      const base64Data = result.imageData;\n      const bytes = Uint8Array.from(atob(base64Data), c => c.charCodeAt(0));\n      \n      console.log(`\uD83D\uDCBE BROWSER: Final image: ${bytes.length} bytes`);\n      \n      // Save the file using continuum.fileSave\n      const continuum = (window as any).continuum;\n      const saveResult = await continuum.fileSave({\n        content: bytes,\n        filename: params.filename,\n        artifactType: 'screenshot'\n      });\n      \n      console.log('\uD83D\uDCBE BROWSER: FileSave result:', saveResult);\n      \n      // Return AI-friendly result with comprehensive metadata\n      return {\n        success: true,\n        data: {\n          ...result,\n          saved: saveResult.success,\n          filePath: saveResult.data?.filePath || null,\n          fullPath: saveResult.data?.fullPath || null,\n          relativePath: saveResult.data?.relativePath || null,\n          bytes: (params.destination === 'bytes' || params.destination === 'both') ? bytes : undefined\n        },\n        timestamp: new Date().toISOString(),\n        processor: 'browser-html2canvas-ai'\n      };\n      \n    } catch (error) {\n      console.error('\u274C BROWSER: Screenshot capture failed:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n        timestamp: new Date().toISOString(),\n        processor: 'browser-html2canvas-ai'\n      };\n    }\n  }\n\n  /**\n   * Execute screenshot capture using html2canvas (implements abstract method)\n   */\n  protected async executeCapture(options: ScreenshotBaseOptions): Promise<ScreenshotCaptureResult> {\n    // Validate parameters\n    ScreenshotBase.validateOptions(options);\n\n    // Find target element\n    const targetElement = ScreenshotBase.findTargetElement(options);\n    const elementRect = targetElement.getBoundingClientRect();\n    const elementName = options.elementName || ScreenshotBase.getElementName(targetElement);\n    \n    console.log(`\uD83C\uDFAF BROWSER: Targeting element '${elementName}' at ${elementRect.width}x${elementRect.height}`);\n    \n    // Load html2canvas dynamically if not already loaded\n    const html2canvas = await ScreenshotBase.loadHtml2Canvas();\n    console.log('\uD83D\uDCE6 BROWSER: html2canvas available - starting capture');\n    \n    // Always capture full body for consistent color rendering\n    const scale = options.scale || 1;\n    const canvas = await html2canvas(document.body, {\n      allowTaint: true,\n      useCORS: true,\n      scale: scale,\n      logging: false\n    });\n    \n    // Calculate element coordinates relative to body for cropping\n    const bodyRect = document.body.getBoundingClientRect();\n    const relativeX = Math.max(0, (elementRect.left - bodyRect.left) * scale);\n    const relativeY = Math.max(0, (elementRect.top - bodyRect.top) * scale);\n    const relativeWidth = Math.min(elementRect.width * scale, canvas.width - relativeX);\n    const relativeHeight = Math.min(elementRect.height * scale, canvas.height - relativeY);\n    \n    console.log(`\uD83D\uDCCF BROWSER: Element coordinates: ${relativeX},${relativeY} ${relativeWidth}x${relativeHeight}`);\n    \n    // For body captures, skip cropping to maintain full page\n    const selector = options.querySelector || options.selector || 'body';\n    const needsCropping = selector !== 'body';\n    \n    // Create cropped canvas if targeting specific element\n    let finalCanvas = canvas;\n    if (needsCropping) {\n      const croppedCanvas = document.createElement('canvas');\n      const croppedCtx = croppedCanvas.getContext('2d')!;\n      \n      croppedCanvas.width = relativeWidth;\n      croppedCanvas.height = relativeHeight;\n      \n      croppedCtx.drawImage(\n        canvas,\n        relativeX, relativeY, relativeWidth, relativeHeight,\n        0, 0, relativeWidth, relativeHeight\n      );\n      \n      finalCanvas = croppedCanvas;\n      console.log(`\u2702\uFE0F BROWSER: Cropped to element coordinates`);\n    }\n    \n    const originalWidth = finalCanvas.width;\n    const originalHeight = finalCanvas.height;\n    \n    console.log(`\uD83D\uDDBC\uFE0F BROWSER: Canvas captured, original size: ${originalWidth}x${originalHeight}`);\n    \n    // Apply AI-friendly processing\n    const processedCanvas = ScreenshotBase.processCanvas(finalCanvas, options);\n    const finalWidth = processedCanvas.width;\n    const finalHeight = processedCanvas.height;\n    \n    console.log(`\uD83C\uDFA8 BROWSER: Processing complete, final size: ${finalWidth}x${finalHeight}`);\n    \n    // Convert to desired format with quality control\n    const format = options.format || 'png';\n    let quality = options.quality || 0.9;\n    let imageData: string;\n    \n    do {\n      imageData = format === 'png' ? \n        processedCanvas.toDataURL('image/png') : \n        processedCanvas.toDataURL(`image/${format}`, quality);\n      \n      // Check file size if maxFileSize is specified\n      if (options.maxFileSize) {\n        const estimatedSize = (imageData.length * 3) / 4; // Base64 to bytes estimate\n        if (estimatedSize > options.maxFileSize && quality > 0.1) {\n          quality -= 0.1;\n          console.log(`\uD83D\uDCC9 BROWSER: Reducing quality to ${quality} for file size limit`);\n          continue;\n        }\n      }\n      break;\n    } while (true);\n    \n    // Extract base64 data from data URL\n    const base64Data = imageData.replace(/^data:image\\/[a-z]+;base64,/, '');\n    const bytes = Uint8Array.from(atob(base64Data), c => c.charCodeAt(0));\n    \n    // Generate filename\n    const filename = ScreenshotBase.generateFilename(options, format as ScreenshotFormat);\n    \n    console.log(`\u2705 Screenshot captured: ${bytes.length} bytes`);\n\n    return {\n      imageData: base64Data,\n      format: format as ScreenshotFormat,\n      selector: selector,\n      filename: filename,\n      width: finalWidth,\n      height: finalHeight,\n      elementName: elementName,\n      originalWidth: originalWidth,\n      originalHeight: originalHeight,\n      scale: scale,\n      cropped: needsCropping || !!(options.cropX || options.cropY || options.cropWidth || options.cropHeight),\n      compressed: quality < 0.9,\n      fileSizeBytes: bytes.length,\n      dataUrl: imageData\n    };\n  }\n}\n\n/**\n * Backward compatibility function - maintains existing API\n */\nexport async function clientScreenshot(params: ScreenshotClientParams): Promise<ScreenshotResult> {\n  const client = ScreenshotClient.getInstance();\n  return await client.captureScreenshot(params);\n}\n\n// Make functions available globally for eval execution\n(window as any).clientScreenshot = clientScreenshot;\n(window as any).ScreenshotClient = ScreenshotClient;\n\n// Auto-register when module loads (maintains ScreenshotExecutor behavior)\nScreenshotClient.getInstance().register();", "// ISSUES: 0 open, last updated 2025-07-14 - See middle-out/development/code-quality-scouting.md#file-level-issue-tracking\n/**\n * Continuum Browser Client - Main API Implementation\n * Lifecycle-aware single global API for browser-server communication\n * \n * Now uses shared FileOperationParams interface for consistent file operations\n * across browser client and server commands.\n */\n\nimport packageJson from '../../../package.json';\nimport type { ContinuumAPI, ContinuumState, CommandResult } from './types/BrowserClientTypes';\nimport type { CommandExecuteData } from './types/WebSocketTypes';\nimport { ConsoleForwarder } from './console/ConsoleForwarder';\nimport { WebSocketManager } from './connection/WebSocketManager';\nimport type { FileOperationParams } from '../../commands/file/client-exports';\nimport { FileSaveClient } from '../../commands/file/client-exports';\nimport '../../commands/browser/screenshot/client/ScreenshotClient'; // Auto-registers screenshot handler\n\nexport class ContinuumBrowserClient implements ContinuumAPI {\n  public readonly version: string;\n  public sessionId: string | null = null;\n  public clientId: string | null = null;\n  \n  private readonly SESSION_COOKIE_NAME = 'continuum_session_id';\n  private readonly SESSION_COOKIE_MAX_AGE = 30 * 24 * 60 * 60 * 1000; // 30 days in ms\n  \n  private _state: ContinuumState = 'initializing';\n  private stateCallbacks: ((state: ContinuumState) => void)[] = [];\n  private readyCallbacks: (() => void)[] = [];\n  private dynamicMethods: Map<string, (...args: unknown[]) => unknown> = new Map();\n  \n  // Component modules\n  private consoleForwarder: ConsoleForwarder;\n  private webSocketManager: WebSocketManager;\n\n  constructor() {\n    this.version = packageJson.version;\n    \n    // Initialize session from cookie before WebSocket connection\n    this.initializeSessionFromCookie();\n\n    (window as any).continuum = this; // Attach to global for easy access\n    \n    // Initialize component modules\n    this.consoleForwarder = new ConsoleForwarder(\n      () => this._state,\n      () => this.sessionId\n    );\n    \n    this.webSocketManager = new WebSocketManager(this.version);\n    \n    // Set up module callbacks\n    this.setupModuleCallbacks();\n    \n    console.log(`\uD83C\uDF10 Continuum v${this.version} lifecycle starting...`);\n    \n    // Initialize lifecycle\n    this.setState('connecting');\n    this.webSocketManager.initializeConnection();\n  }\n\n  private setupModuleCallbacks(): void {\n    // Console forwarder callback\n    this.consoleForwarder.setExecuteCallback((command, params) => {\n      return this.execute(command, params);\n    });\n\n    // WebSocket manager callbacks\n    this.webSocketManager.setCallbacks({\n      onStateChange: (state) => this.setState(state),\n      onClientId: (clientId) => { this.clientId = clientId; },\n      onSessionId: (sessionId) => { \n        this.sessionId = sessionId;\n        // Save session ID to cookie for persistence\n        this.saveSessionToCookie(sessionId);\n      },\n      onMessage: (message) => this.handleCustomMessage(message)\n    });\n  }\n\n  get state(): ContinuumState {\n    return this._state;\n  }\n\n  private setState(newState: ContinuumState): void {\n    if (this._state !== newState) {\n      console.log(`\uD83D\uDD04 Continuum state: ${this._state} \u2192 ${newState}`);\n      this._state = newState;\n      this.stateCallbacks.forEach(callback => callback(newState));\n      \n      // Handle state-specific logic\n      this.handleStateChange(newState);\n    }\n  }\n\n  private handleStateChange(state: ContinuumState): void {\n    switch (state) {\n      case 'connected':\n        console.log('\uD83D\uDD0C Continuum API connected to server');\n        break;\n      case 'ready':\n        this.readyCallbacks.forEach(callback => callback());\n        this.consoleForwarder.executeAndFlushConsoleMessageQueue();\n        console.log('\u2705 Continuum API ready for use');\n        this.consoleForwarder.performHealthCheck();\n        \n        // Test widget discovery using the WidgetDaemon event system  \n        console.log('\uD83C\uDFA8 BROWSER_DEBUG: Testing widget discovery via WidgetDaemon...');\n        this.execute('widget:discover', { paths: ['src/ui/components'] })\n          .then(result => {\n            console.log('\uD83C\uDFA8 BROWSER_DEBUG: Widget discovery via WidgetDaemon result:', result);\n            \n            // Test console object serialization with known object\n            const testObj = { \n              test: 'serialization', \n              number: 42, \n              nested: { key: 'value', array: [1, 2, 3] },\n              boolean: true \n            };\n            console.log('\uD83E\uDDEA SERIALIZATION_TEST: Testing object logging:', testObj);\n          \n          // Test console.probe() functionality for AI diagnostics with DOM exploration\n          (console as any).probe({\n            message: '\uD83D\uDD2C AI_DIAGNOSTIC_TEST: Probing DOM and browser state',\n            data: { widgets: result, serialization: testObj },\n            executeJS: 'JSON.stringify({ title: document.title, url: window.location.href, bodyChildren: document.body?.children.length || 0, scripts: document.scripts.length, stylesheets: document.styleSheets.length, readyState: document.readyState })',\n            category: 'dom-analysis',\n            tags: ['test', 'dom', 'browser-state', 'widget-discovery']\n          });\n\n          // Add probes to explore widget state and debug why page might be blank\n          (console as any).probe({\n            message: '\uD83D\uDD0D WIDGET_INVESTIGATION: Checking widget custom elements status',\n            executeJS: 'JSON.stringify({ sidebarElement: !!document.querySelector(\"continuum-sidebar\"), chatElement: !!document.querySelector(\"chat-widget\"), sidebarInnerHTML: document.querySelector(\"continuum-sidebar\")?.innerHTML?.substring(0, 100) || \"empty\", chatInnerHTML: document.querySelector(\"chat-widget\")?.innerHTML?.substring(0, 100) || \"empty\", customElementsSupported: !!window.customElements, bodyHTML: document.body?.innerHTML?.substring(0, 300) || \"no body\" })',\n            category: 'widget-debug',\n            tags: ['widgets', 'custom-elements', 'debug']\n          });\n\n          // Probe for custom element registration and widget class definitions\n          (console as any).probe({\n            message: '\uD83D\uDD0D CUSTOM_ELEMENT_PROBE: Checking widget class registration',\n            executeJS: 'JSON.stringify({ customElementsRegistry: Object.keys(window.customElements || {}), sidebarClass: typeof window.customElements?.get(\"continuum-sidebar\"), chatClass: typeof window.customElements?.get(\"chat-widget\"), globalClasses: Object.keys(window).filter(k => k.includes(\"Widget\") || k.includes(\"Sidebar\")).slice(0, 10) })',\n            category: 'custom-elements',\n            tags: ['registration', 'classes', 'debug']\n          });\n          })\n          .catch(error => {\n            console.error('\u274C Widget discovery error:', error);\n          });\n        break;\n      case 'error':\n        console.error('\u274C Continuum API in error state');\n        break;\n    }\n  }\n\n  private handleCustomMessage(message: Record<string, unknown>): void {\n    // Handle any custom messages that aren't standard protocol\n    console.log('\uD83D\uDCE8 Received custom message:', message);\n  }\n\n  isConnected(): boolean {\n    return this.state === 'ready' && this.webSocketManager.isOpen();\n  }\n\n  async execute(command: string, params: Record<string, unknown> = {}): Promise<CommandResult> {\n    if (!this.isConnected()) {\n      throw new Error(`Continuum not ready (state: ${this.state})`);\n    }\n\n    return new Promise((resolve, reject) => {\n      const requestId = `cmd_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n      \n      const timeout = setTimeout(() => {\n        reject(new Error(`Command '${command}' timed out`));\n      }, 10000);\n\n      // Listen for response\n      const responseHandler = (event: Event) : void => {\n        const message = (event as CustomEvent).detail;\n        if (message.requestId === requestId) {\n          clearTimeout(timeout);\n          document.removeEventListener('continuum:command_response', responseHandler);\n          \n          if (message.success) {\n            resolve(message.data ?? { success: true });\n          } else {\n            reject(new Error(message.error ?? 'Command failed'));\n          }\n        }\n      };\n\n      document.addEventListener('continuum:command_response', responseHandler);\n\n      // Send command\n      const commandData: CommandExecuteData = {\n        command,\n        params: JSON.stringify(params),\n        requestId,\n        sessionId: this.sessionId\n      };\n      \n      this.webSocketManager.sendMessage({\n        type: 'execute_command',\n        data: commandData,\n        timestamp: new Date().toISOString(),\n        clientId: this.clientId,\n        sessionId: this.sessionId\n      });\n    });\n  }\n\n  // File saving functionality - delegates to FileSaveClient\n  async fileSave(options: Pick<FileOperationParams, 'content' | 'filename' | 'artifactType'>): Promise<CommandResult> {\n    const fileSaveClient = FileSaveClient.getInstance();\n    const result = await fileSaveClient.saveFile({\n      content: options.content,\n      filename: options.filename,\n      artifactType: options.artifactType || undefined\n    });\n    \n    if (result.success) {\n      return {\n        success: true,\n        data: result.data ?? {}\n      };\n    } else {\n      throw new Error(result.error ?? 'File save failed');\n    }\n  }\n\n  // Dynamic method attachment\n  attachMethod(name: string, method: (...args: unknown[]) => unknown): void {\n    this.dynamicMethods.set(name, method);\n    // Attach to the object dynamically\n    (this as Record<string, unknown>)[name] = method.bind(this);\n    console.log(`\uD83D\uDD27 Dynamic method attached: ${name}`);\n  }\n\n  hasMethod(name: string): boolean {\n    return this.dynamicMethods.has(name) || typeof (this as Record<string, unknown>)[name] === 'function';\n  }\n\n  // Lifecycle event handlers\n  onStateChange(callback: (state: ContinuumState) => void): void {\n    this.stateCallbacks.push(callback);\n  }\n\n  onReady(callback: () => void): void {\n    if (this.state === 'ready') {\n      callback();\n    } else {\n      this.readyCallbacks.push(callback);\n    }\n  }\n  \n  // Session cookie management\n  private initializeSessionFromCookie(): void {\n    const cookieSessionId = this.getSessionFromCookie();\n    if (cookieSessionId) {\n      this.sessionId = cookieSessionId;\n      console.log(`\uD83C\uDF6A ContinuumBrowserClient: Restored session from cookie: ${cookieSessionId}`);\n    }\n  }\n  \n  private getSessionFromCookie(): string | null {\n    const cookies = document.cookie.split(';');\n    for (const cookie of cookies) {\n      const [name, value] = cookie.trim().split('=');\n      if (name === this.SESSION_COOKIE_NAME) {\n        return decodeURIComponent(value);\n      }\n    }\n    return null;\n  }\n  \n  private saveSessionToCookie(sessionId: string): void {\n    if (!sessionId) return;\n    \n    const expirationDate = new Date();\n    expirationDate.setTime(expirationDate.getTime() + this.SESSION_COOKIE_MAX_AGE);\n    \n    const cookieValue = `${this.SESSION_COOKIE_NAME}=${encodeURIComponent(sessionId)}; expires=${expirationDate.toUTCString()}; path=/; SameSite=Strict`;\n    document.cookie = cookieValue;\n    \n    console.log(`\uD83C\uDF6A ContinuumBrowserClient: Saved session to cookie: ${sessionId}`);\n  }\n}", "/**\n * Widget Server Controls - Event-driven integration points\n * Allows widgets to trigger server-side actions via custom events\n * Classic server controls pattern for modern web components\n */\n\nimport {\n  WidgetDataRequest,\n  WidgetDataResponse,\n  WidgetCommandRequest,\n  WidgetCommandResponse,\n  SessionCreatedEvent,\n  SessionJoinedEvent,\n  HealthUpdatedEvent,\n  DataUpdatedEvent,\n  DataSourceType,\n  ServerEventName,\n  WidgetEventName,\n  WidgetControlEventName,\n  CommandDataSourceMapping,\n  EventMappingConfig\n} from '../../../types/shared/WidgetServerTypes';\n\nexport class WidgetServerControls {\n  private static instance: WidgetServerControls;\n  private commandDataSourceMap = new Map<DataSourceType, string>();\n  private eventMappings: EventMappingConfig[] = [];\n  private controlEventNames: WidgetControlEventName[] = [];\n  \n  static getInstance(): WidgetServerControls {\n    if (!WidgetServerControls.instance) {\n      WidgetServerControls.instance = new WidgetServerControls();\n    }\n    return WidgetServerControls.instance;\n  }\n\n  private constructor() {\n    this.initializeDynamicMappings();\n    this.setupEventListeners();\n  }\n\n  /**\n   * Initialize dynamic mappings using npm intelligence and command discovery\n   */\n  private async initializeDynamicMappings(): Promise<void> {\n    // Discover command \u2192 data source mappings dynamically\n    await this.discoverCommandDataSourceMappings();\n    \n    // Set up event mappings dynamically  \n    this.initializeEventMappings();\n    \n    // Discover widget control events from types\n    this.initializeControlEventNames();\n  }\n\n  /**\n   * Discover command data source mappings using npm intelligence\n   */\n  private async discoverCommandDataSourceMappings(): Promise<void> {\n    try {\n      // Use the continuum API to get available commands\n      const continuum = (window as any).continuum;\n      if (continuum && typeof continuum.execute === 'function') {\n        // Get available commands dynamically\n        const helpResult = await continuum.execute('help', {});\n        if (helpResult.success && helpResult.data) {\n          // Parse command definitions to find data source mappings\n          this.parseCommandDefinitionsForDataSources(helpResult.data);\n        }\n      }\n      \n      // Fallback to intelligent defaults using naming conventions  \n      this.setupIntelligentDefaults();\n    } catch (error) {\n      console.warn('Could not discover command mappings dynamically, using intelligent defaults:', error);\n      this.setupIntelligentDefaults();\n    }\n  }\n\n  /**\n   * Parse command definitions to find data source mappings\n   */\n  private parseCommandDefinitionsForDataSources(_commandData: any): void {\n    // Commands that match data source names map directly\n    const directMappings: Array<[DataSourceType, string]> = [\n      ['personas', 'personas'],\n      ['projects', 'projects'], \n      ['sessions', 'sessions'],\n      ['health', 'health'],\n      ['widgets', 'discover_widgets'],\n      ['logs', 'console'], // Console command handles logs\n      ['metrics', 'health'], // Health command includes metrics\n    ];\n\n    for (const [dataSource, command] of directMappings) {\n      this.commandDataSourceMap.set(dataSource, command);\n    }\n\n    // TODO: Parse actual command definitions to discover more mappings\n    // For now, use intelligent naming convention mapping\n  }\n\n  /**\n   * Setup intelligent defaults using npm intelligence patterns\n   */\n  private setupIntelligentDefaults(): void {\n    // Use naming conventions - if command name matches data source, use it\n    const intelligentMappings: CommandDataSourceMapping[] = [\n      { command: 'personas', dataSource: 'personas' },\n      { command: 'projects', dataSource: 'projects' },\n      { command: 'sessions', dataSource: 'sessions' },\n      { command: 'health', dataSource: 'health' },\n      { command: 'discover_widgets', dataSource: 'widgets' },\n      { command: 'help', dataSource: 'commands' }, // Help lists commands\n      { command: 'agents', dataSource: 'daemons' }, // Agents command for daemon info\n      { command: 'console', dataSource: 'logs' },\n      { command: 'health', dataSource: 'metrics' }, // Health includes metrics\n    ];\n\n    for (const mapping of intelligentMappings) {\n      this.commandDataSourceMap.set(mapping.dataSource, mapping.command);\n    }\n  }\n\n  /**\n   * Initialize event mappings dynamically\n   */\n  private initializeEventMappings(): void {\n    this.eventMappings = [\n      { serverEvent: 'session:created', widgetEvent: 'server:session-created', enabled: true },\n      { serverEvent: 'session:joined', widgetEvent: 'server:session-joined', enabled: true },\n      { serverEvent: 'health:updated', widgetEvent: 'server:health-updated', enabled: true },\n      { serverEvent: 'data:updated', widgetEvent: 'server:data-updated', enabled: true },\n    ];\n  }\n\n  /**\n   * Initialize control event names from types\n   */\n  private initializeControlEventNames(): void {\n    this.controlEventNames = [\n      'widget:screenshot',\n      'widget:refresh',\n      'widget:export', \n      'widget:validate',\n      'widget:fetch-data',\n      'widget:execute-command'\n    ];\n  }\n\n  /**\n   * Setup global event listeners for widget server control events\n   * Uses dynamic discovery instead of hardcoded event names\n   */\n  private setupEventListeners(): void {\n    // Dynamically set up control event listeners using type-safe event names\n    for (const eventName of this.controlEventNames) {\n      this.setupControlEventListener(eventName);\n    }\n    \n    // Listen for server events that widgets should respond to\n    this.setupServerEventListeners();\n  }\n\n  /**\n   * Setup individual control event listener with proper routing\n   */\n  private setupControlEventListener(eventName: WidgetControlEventName): void {\n    document.addEventListener(eventName, (event) => {\n      switch (eventName) {\n        case 'widget:screenshot':\n          this.handleScreenshotEvent(event);\n          break;\n        case 'widget:refresh':\n          this.handleRefreshEvent(event);\n          break;\n        case 'widget:export':\n          this.handleExportEvent(event);\n          break;\n        case 'widget:validate':\n          this.handleValidateEvent(event);\n          break;\n        case 'widget:fetch-data':\n          this.handleFetchDataEvent(event);\n          break;\n        case 'widget:execute-command':\n          this.handleExecuteCommandEvent(event);\n          break;\n      }\n    });\n  }\n\n  /**\n   * Handle widget screenshot events\n   */\n  private async handleScreenshotEvent(event: Event): Promise<void> {\n    const customEvent = event as CustomEvent;\n    try {\n      console.log('\uD83D\uDCF8 Server Control: Widget screenshot requested', customEvent.detail);\n      \n      const widgetElement = event.target as HTMLElement;\n      const widgetId = widgetElement.tagName.toLowerCase();\n      \n      // Route to screenshot command via Continuum API\n      const continuum = (window as any).continuum;\n      if (continuum) {\n        const result = await continuum.execute('screenshot', {\n          target: 'widget',\n          widgetId: widgetId,\n          selector: widgetElement.tagName.toLowerCase(),\n          includeContext: true,\n          ...customEvent.detail\n        });\n        \n        // Notify widget of completion via custom event\n        widgetElement.dispatchEvent(new CustomEvent('widget:screenshot-complete', {\n          detail: { success: true, result }\n        }));\n        \n        console.log('\u2705 Widget screenshot completed:', result);\n      } else {\n        throw new Error('Continuum API not available');\n      }\n      \n    } catch (error) {\n      console.error('\u274C Widget screenshot failed:', error);\n      \n      // Notify widget of failure\n      const widgetElement = event.target as HTMLElement;\n      widgetElement.dispatchEvent(new CustomEvent('widget:screenshot-complete', {\n        detail: { \n          success: false, \n          error: error instanceof Error ? error.message : String(error)\n        }\n      }));\n    }\n  }\n\n  /**\n   * Handle widget refresh events\n   */\n  private async handleRefreshEvent(event: Event): Promise<void> {\n    const customEvent = event as CustomEvent;\n    try {\n      console.log('\uD83D\uDD04 Server Control: Widget refresh requested', customEvent.detail);\n      \n      const widgetElement = event.target as HTMLElement;\n      const widgetId = widgetElement.tagName.toLowerCase();\n      \n      const continuum = (window as any).continuum;\n      if (continuum) {\n        const result = await continuum.execute('reload', {\n          target: 'widget',\n          widgetId: widgetId,\n          preserveState: customEvent.detail?.preserveState || true,\n          ...customEvent.detail\n        });\n        \n        widgetElement.dispatchEvent(new CustomEvent('widget:refresh-complete', {\n          detail: { success: true, result }\n        }));\n        \n        console.log('\u2705 Widget refresh completed:', result);\n      }\n      \n    } catch (error) {\n      console.error('\u274C Widget refresh failed:', error);\n      const widgetElement = event.target as HTMLElement;\n      widgetElement.dispatchEvent(new CustomEvent('widget:refresh-complete', {\n        detail: { success: false, error: String(error) }\n      }));\n    }\n  }\n\n  /**\n   * Handle widget export events\n   */\n  private async handleExportEvent(event: Event): Promise<void> {\n    const customEvent = event as CustomEvent;\n    try {\n      console.log('\uD83D\uDCBE Server Control: Widget export requested', customEvent.detail);\n      \n      const widgetElement = event.target as HTMLElement;\n      const widgetId = widgetElement.tagName.toLowerCase();\n      \n      const continuum = (window as any).continuum;\n      if (continuum) {\n        const result = await continuum.execute('export', {\n          target: 'widget',\n          widgetId: widgetId,\n          format: customEvent.detail?.format || 'json',\n          ...customEvent.detail\n        });\n        \n        widgetElement.dispatchEvent(new CustomEvent('widget:export-complete', {\n          detail: { success: true, result }\n        }));\n        \n        console.log('\u2705 Widget export completed:', result);\n      }\n      \n    } catch (error) {\n      console.error('\u274C Widget export failed:', error);\n      const widgetElement = event.target as HTMLElement;\n      widgetElement.dispatchEvent(new CustomEvent('widget:export-complete', {\n        detail: { success: false, error: String(error) }\n      }));\n    }\n  }\n\n  /**\n   * Handle widget validation events\n   */\n  private async handleValidateEvent(event: Event): Promise<void> {\n    const customEvent = event as CustomEvent;\n    try {\n      console.log('\u2705 Server Control: Widget validation requested', customEvent.detail);\n      \n      const widgetElement = event.target as HTMLElement;\n      const widgetId = widgetElement.tagName.toLowerCase();\n      \n      const continuum = (window as any).continuum;\n      if (continuum) {\n        const result = await continuum.execute('validate', {\n          target: 'widget',\n          widgetId: widgetId,\n          validateAssets: true,\n          validateContent: true,\n          ...customEvent.detail\n        });\n        \n        widgetElement.dispatchEvent(new CustomEvent('widget:validate-complete', {\n          detail: { success: true, result }\n        }));\n        \n        console.log('\u2705 Widget validation completed:', result);\n      }\n      \n    } catch (error) {\n      console.error('\u274C Widget validation failed:', error);\n      const widgetElement = event.target as HTMLElement;\n      widgetElement.dispatchEvent(new CustomEvent('widget:validate-complete', {\n        detail: { success: false, error: String(error) }\n      }));\n    }\n  }\n\n  /**\n   * Handle widget data fetching events\n   */\n  private async handleFetchDataEvent(event: Event): Promise<void> {\n    const customEvent = event as CustomEvent<WidgetDataRequest>;\n    try {\n      console.log('\uD83D\uDCE1 Server Control: Widget data fetch requested', customEvent.detail);\n      \n      const widgetElement = event.target as HTMLElement;\n      const widgetId = widgetElement.tagName.toLowerCase();\n      \n      const continuum = (window as any).continuum;\n      if (continuum) {\n        const request = customEvent.detail;\n        \n        // Use dynamic command mapping discovered through npm intelligence\n        const command = this.commandDataSourceMap.get(request.dataSource);\n        \n        if (!command) {\n          throw new Error(`No command found for data source: ${request.dataSource}. Available: ${Array.from(this.commandDataSourceMap.keys()).join(', ')}`);\n        }\n        \n        const result = await continuum.execute(command, {\n          requestingWidget: widgetId,\n          ...request.params,\n          ...(request.filters && { filters: request.filters })\n        });\n        \n        const response: WidgetDataResponse = {\n          success: true,\n          dataSource: request.dataSource,\n          data: result.data,\n          timestamp: Date.now(),\n          metadata: {\n            fromCache: false,\n            totalCount: result.data?.length,\n            hasMore: false\n          }\n        };\n        \n        widgetElement.dispatchEvent(new CustomEvent('widget:data-received', {\n          detail: response\n        }));\n        \n        console.log(`\u2705 Widget data fetched for ${widgetId}:`, result);\n      } else {\n        throw new Error('Continuum API not available');\n      }\n      \n    } catch (error) {\n      console.error('\u274C Widget data fetch failed:', error);\n      const widgetElement = event.target as HTMLElement;\n      \n      const errorResponse: WidgetDataResponse = {\n        success: false,\n        dataSource: customEvent.detail?.dataSource || 'unknown' as DataSourceType,\n        error: error instanceof Error ? error.message : String(error),\n        timestamp: Date.now()\n      };\n      \n      widgetElement.dispatchEvent(new CustomEvent('widget:data-received', {\n        detail: errorResponse\n      }));\n    }\n  }\n\n  /**\n   * Handle widget command execution events\n   */\n  private async handleExecuteCommandEvent(event: Event): Promise<void> {\n    const customEvent = event as CustomEvent<WidgetCommandRequest>;\n    try {\n      console.log('\u26A1 Server Control: Widget command execution requested', customEvent.detail);\n      \n      const widgetElement = event.target as HTMLElement;\n      const widgetId = widgetElement.tagName.toLowerCase();\n      \n      const continuum = (window as any).continuum;\n      if (continuum) {\n        const request = customEvent.detail;\n        const startTime = Date.now();\n        \n        const result = await continuum.execute(request.command, {\n          requestingWidget: widgetId,\n          ...request.params,\n          ...(request.timeout && { timeout: request.timeout }),\n          ...(request.priority && { priority: request.priority })\n        });\n        \n        const executionTime = Date.now() - startTime;\n        \n        const response: WidgetCommandResponse = {\n          success: true,\n          command: request.command,\n          result: result.data,\n          timestamp: Date.now(),\n          executionTime\n        };\n        \n        widgetElement.dispatchEvent(new CustomEvent('widget:command-complete', {\n          detail: response\n        }));\n        \n        console.log(`\u2705 Widget command executed for ${widgetId}: ${request.command} (${executionTime}ms)`, result);\n      } else {\n        throw new Error('Continuum API not available');\n      }\n      \n    } catch (error) {\n      console.error('\u274C Widget command execution failed:', error);\n      const widgetElement = event.target as HTMLElement;\n      \n      const errorResponse: WidgetCommandResponse = {\n        success: false,\n        command: customEvent.detail?.command || 'unknown',\n        error: error instanceof Error ? error.message : String(error),\n        timestamp: Date.now()\n      };\n      \n      widgetElement.dispatchEvent(new CustomEvent('widget:command-complete', {\n        detail: errorResponse\n      }));\n    }\n  }\n\n  /**\n   * Setup listeners for server events that widgets should respond to\n   */\n  private setupServerEventListeners(): void {\n    const continuum = (window as any).continuum;\n    if (continuum && typeof continuum.on === 'function') {\n      // Dynamically set up server event listeners from configuration\n      for (const mapping of this.eventMappings) {\n        if (mapping.enabled) {\n          this.setupServerEventListener(continuum, mapping);\n        }\n      }\n    }\n  }\n\n  /**\n   * Setup individual server event listener with proper typing\n   */\n  private setupServerEventListener(continuum: any, mapping: EventMappingConfig): void {\n    continuum.on(mapping.serverEvent, (data: any) => {\n      // Type-safe event data based on server event type\n      const typedData = this.castServerEventData(mapping.serverEvent, data);\n      this.broadcastToWidgets(mapping.widgetEvent, typedData);\n    });\n  }\n\n  /**\n   * Cast server event data to proper types based on event name\n   */\n  private castServerEventData(serverEvent: ServerEventName, data: any): SessionCreatedEvent | SessionJoinedEvent | HealthUpdatedEvent | DataUpdatedEvent {\n    // Type-safe casting based on server event type\n    switch (serverEvent) {\n      case 'session:created':\n        return data as SessionCreatedEvent;\n      case 'session:joined':\n        return data as SessionJoinedEvent;\n      case 'health:updated':\n        return data as HealthUpdatedEvent;\n      case 'data:updated':\n        return data as DataUpdatedEvent;\n      default:\n        // TypeScript ensures this is unreachable with proper ServerEventName\n        throw new Error(`Unknown server event: ${serverEvent}`);\n    }\n  }\n\n  /**\n   * Register a command data source mapping (used by commands to declare what data they provide)\n   */\n  public static registerCommandDataSource(mapping: CommandDataSourceMapping): void {\n    const instance = WidgetServerControls.getInstance();\n    instance.commandDataSourceMap.set(mapping.dataSource, mapping.command);\n    \n    // Add aliases if provided\n    if (mapping.aliases) {\n      for (const alias of mapping.aliases) {\n        // Map alias as additional data source if it's valid\n        if (alias as DataSourceType) {\n          instance.commandDataSourceMap.set(alias as DataSourceType, mapping.command);\n        }\n      }\n    }\n  }\n\n  /**\n   * Get current command data source mappings (for debugging)\n   */\n  public static getCommandDataSourceMappings(): Map<DataSourceType, string> {\n    return new Map(WidgetServerControls.getInstance().commandDataSourceMap);\n  }\n\n  /**\n   * Register event mapping configuration (allows dynamic event setup)\n   */\n  public static registerEventMapping(mapping: EventMappingConfig): void {\n    const instance = WidgetServerControls.getInstance();\n    const existingIndex = instance.eventMappings.findIndex(m => m.serverEvent === mapping.serverEvent);\n    \n    if (existingIndex !== -1) {\n      instance.eventMappings[existingIndex] = mapping;\n    } else {\n      instance.eventMappings.push(mapping);\n    }\n    \n    // Re-setup listeners if already initialized\n    instance.setupServerEventListeners();\n  }\n\n  /**\n   * Broadcast server events to all widgets that want to listen\n   */\n  private broadcastToWidgets(eventType: WidgetEventName, data: any): void {\n    // Find all custom elements (widgets) and dispatch server events\n    const widgets = document.querySelectorAll('*');\n    widgets.forEach(element => {\n      if (element.tagName.includes('-') && element.shadowRoot) {\n        // This is likely a custom widget element\n        element.dispatchEvent(new CustomEvent(eventType, {\n          detail: data\n        }));\n      }\n    });\n  }\n}\n\n// Initialize server controls when module loads\nWidgetServerControls.getInstance();", "/**\n * Global Error Handler - Centralized Error Capture and Forwarding\n * \n * Provides universal error wrapping for widgets, commands, and any async operations.\n * Ensures ALL errors make it to the browser logs for JTAG debugging.\n */\n\nexport interface ErrorContext {\n  component?: string;\n  operation?: string;\n  widget?: string;\n  command?: string;\n  metadata?: Record<string, any>;\n}\n\nexport class GlobalErrorHandler {\n  private static instance: GlobalErrorHandler;\n  private errorCount = 0;\n\n  static getInstance(): GlobalErrorHandler {\n    if (!GlobalErrorHandler.instance) {\n      GlobalErrorHandler.instance = new GlobalErrorHandler();\n    }\n    return GlobalErrorHandler.instance;\n  }\n\n  /**\n   * Wrap any function with comprehensive error handling\n   */\n  public wrapFunction<T extends (...args: any[]) => any>(\n    fn: T,\n    context: ErrorContext\n  ): T {\n    return ((...args: any[]) => {\n      try {\n        const result = fn(...args);\n        \n        // Handle both sync and async functions\n        if (result instanceof Promise) {\n          return result.catch(error => {\n            this.captureError(error, context);\n            throw error; // Re-throw for caller handling\n          });\n        }\n        \n        return result;\n      } catch (error) {\n        this.captureError(error, context);\n        throw error; // Re-throw for caller handling\n      }\n    }) as T;\n  }\n\n  /**\n   * Wrap async functions with error handling\n   */\n  public wrapAsync<T extends (...args: any[]) => Promise<any>>(\n    fn: T,\n    context: ErrorContext\n  ): T {\n    return (async (...args: any[]) => {\n      try {\n        return await fn(...args);\n      } catch (error) {\n        this.captureError(error, context);\n        throw error; // Re-throw for caller handling\n      }\n    }) as T;\n  }\n\n  /**\n   * Safe execution wrapper - catches errors but doesn't re-throw\n   */\n  public async safeExecute<T>(\n    fn: () => T | Promise<T>,\n    context: ErrorContext,\n    fallback?: T\n  ): Promise<T | undefined> {\n    try {\n      const result = await fn();\n      return result;\n    } catch (error) {\n      this.captureError(error, context);\n      return fallback;\n    }\n  }\n\n  /**\n   * Manual error capture for explicit error handling\n   */\n  public captureError(error: any, context: ErrorContext): void {\n    this.errorCount++;\n    \n    const errorInfo = {\n      error: error instanceof Error ? error.message : String(error),\n      stack: error instanceof Error ? error.stack : undefined,\n      context: context,\n      timestamp: new Date().toISOString(),\n      errorId: this.errorCount,\n      url: window.location.href\n    };\n\n    // Always use console.error to ensure it goes through our capture system\n    console.error(`\uD83D\uDEA8 Global Error Handler:`, errorInfo);\n    \n    // Also emit an event for any listeners\n    window.dispatchEvent(new CustomEvent('continuum:error', {\n      detail: errorInfo\n    }));\n  }\n\n  /**\n   * Widget-specific error wrapper\n   */\n  public wrapWidgetMethod<T extends (...args: any[]) => any>(\n    widgetName: string,\n    methodName: string,\n    fn: T\n  ): T {\n    return this.wrapFunction(fn, {\n      component: 'widget',\n      widget: widgetName,\n      operation: methodName\n    });\n  }\n\n  /**\n   * Command-specific error wrapper\n   */\n  public wrapCommandMethod<T extends (...args: any[]) => any>(\n    commandName: string,\n    methodName: string,\n    fn: T\n  ): T {\n    return this.wrapFunction(fn, {\n      component: 'command',\n      command: commandName,\n      operation: methodName\n    });\n  }\n\n  /**\n   * API call wrapper\n   */\n  public wrapAPICall<T extends (...args: any[]) => Promise<any>>(\n    apiName: string,\n    fn: T\n  ): T {\n    return this.wrapAsync(fn, {\n      component: 'api',\n      operation: apiName\n    });\n  }\n\n  /**\n   * Get error statistics\n   */\n  public getErrorStats(): { errorCount: number } {\n    return { errorCount: this.errorCount };\n  }\n}\n\n// Global instance for easy access\nexport const globalErrorHandler = GlobalErrorHandler.getInstance();\n\n// Helper functions for common use cases\nexport const wrapWidget = (widgetName: string, methodName: string) => \n  <T extends (...args: any[]) => any>(fn: T): T => \n    globalErrorHandler.wrapWidgetMethod(widgetName, methodName, fn);\n\nexport const wrapCommand = (commandName: string, methodName: string) => \n  <T extends (...args: any[]) => any>(fn: T): T => \n    globalErrorHandler.wrapCommandMethod(commandName, methodName, fn);\n\nexport const safeExecute = <T>(\n  fn: () => T | Promise<T>,\n  context: ErrorContext,\n  fallback?: T\n): Promise<T | undefined> => \n  globalErrorHandler.safeExecute(fn, context, fallback);\n\nexport const captureError = (error: any, context: ErrorContext): void =>\n  globalErrorHandler.captureError(error, context);", "/**\n * BaseWidget - Strongly Typed Abstract Base Class for All Widgets\n * Enforces proper implementation through abstract methods and properties\n */\n\nimport { globalErrorHandler, captureError } from '../../continuum-browser-client/error/GlobalErrorHandler';\nimport {\n  WidgetDataRequest,\n  WidgetDataResponse,\n  WidgetCommandRequest,\n  WidgetCommandResponse,\n  SessionCreatedEvent,\n  SessionJoinedEvent,\n  HealthUpdatedEvent,\n  DataUpdatedEvent,\n  DataSourceType,\n  WidgetCapabilities\n} from '../../../types/shared/WidgetServerTypes';\n\n// Smart asset manifest (zero 404s!) - globally available via esbuild plugin\ndeclare global {\n  interface Window {\n    WIDGET_ASSETS: Record<string, {css: string[], html: string[], js: string[], directoryName?: string}>;\n  }\n}\n\n\nexport abstract class BaseWidget extends HTMLElement {\n  declare shadowRoot: ShadowRoot;\n  \n  // Properties that subclasses can set in constructor\n  protected widgetName: string = 'BaseWidget';\n  protected widgetIcon: string = '\uD83D\uDD39';\n  protected widgetTitle: string = 'Widget';\n\n  /**\n   * Widget name for registration - override in subclasses\n   */\n  static get widgetName(): string {\n    return 'base-widget';\n  }\n\n  /**\n   * HTML tag name - defaults to widgetName, override only if different\n   */\n  static get tagName(): string {\n    return this.widgetName;\n  }\n  \n  // Protected state\n  protected widgetConnected: boolean = false;\n  protected isCollapsed: boolean = false;\n\n  // Smart defaults - minimal requirements from subclasses\n  \n  /**\n   * Widget base path - automagic from build-time directory mapping\n   */\n  public static get basePath(): string {\n    const widgetName = this.name.replace(/^_/, '');\n    \n    // Check if we have build-time directory mapping available\n    if (typeof window !== 'undefined' && window.WIDGET_ASSETS) {\n      const widgetInfo = window.WIDGET_ASSETS[widgetName];\n      if (widgetInfo && widgetInfo.directoryName) {\n        return `/src/ui/components/${widgetInfo.directoryName}`;\n      }\n    }\n    \n    // Fallback: try to map common class name patterns to directory names\n    const directoryMap: Record<string, string> = {\n      'ChatWidget': 'Chat',\n      'SidebarWidget': 'Sidebar', \n      'PersonaWidget': 'Persona',\n      'VersionWidget': 'Version',\n      'ContinuonWidget': 'Continuon',\n      'ActiveProjectsWidget': 'ActiveProjects',\n      'SavedPersonasWidget': 'SavedPersonas',\n      'UserSelectorWidget': 'UserSelector'\n    };\n    \n    const directoryName = directoryMap[widgetName] || widgetName;\n    return `/src/ui/components/${directoryName}`;\n  }\n  \n  // CSS and HTML loading is now handled directly in loadCSS() and loadHTMLTemplatesOrFallback()\n  // using package.json files array - no complex discovery methods needed\n  \n  /**\n   * Get widget files from package.json - replaces manual CSS/HTML declarations\n   * Reads the 'files' array from widget's package.json automatically\n   */\n  static async getWidgetFiles(): Promise<string[]> {\n    try {\n      const packagePath = `${this.basePath}/package.json`;\n      \n      console.log(`\uD83D\uDCE6 ${this.name}: Fetching package.json from ${packagePath}`);\n      const response = await fetch(packagePath);\n      if (!response.ok) {\n        console.warn(`\uD83D\uDCE6 No package.json found for ${this.name} at ${packagePath}`);\n        return [];\n      }\n      \n      const packageData = await response.json();\n      return packageData.files || [];\n    } catch (error) {\n      console.warn(`\uD83D\uDCE6 Failed to read package.json for ${this.name}:`, error);\n      return [];\n    }\n  }\n  \n  /**\n   * Get all widget assets (except .ts files) - reads from package.json\n   * Simple route: widget path + whatever package.json declares\n   */\n  static async getWidgetAssets(): Promise<string[]> {\n    const widgetFiles = await this.getWidgetFiles();\n    const assets = widgetFiles.filter(file => !file.endsWith('.ts')); // Serve everything except TypeScript\n    return assets.map(file => `${this.basePath}/${file}`);\n  }\n\n  \n  /**\n   * Auto-load HTML templates or fallback to renderContent() - zero burden\n   */\n  protected async loadHTMLTemplatesOrFallback(): Promise<string> {\n    try {\n      const constructor = this.constructor as typeof BaseWidget;\n      const basePath = constructor.basePath;\n      \n      // SMART MANIFEST: Only load HTML files that actually exist (Zero 404s!)\n      const widgetAssets = window.WIDGET_ASSETS?.[constructor.name.replace(/^_/, '')];\n      \n      if (widgetAssets && widgetAssets.html.length > 0) {\n        console.log(`\uD83D\uDCC1 ${constructor.name}: Found ${widgetAssets.html.length} HTML files in manifest`);\n        \n        // Try to load HTML files from manifest\n        for (const htmlFile of widgetAssets.html) {\n          const htmlPath = `${basePath}/${htmlFile}`;\n          try {\n            const response = await fetch(htmlPath);\n            if (response.ok) {\n              const htmlContent = await response.text();\n              console.log(`\u2705 Loaded HTML template: ${htmlPath} (Zero 404s!)`);\n              return htmlContent;\n            } else {\n              console.error(`\uD83D\uDEA8 MANIFEST ERROR: ${htmlPath} not found but was in manifest!`);\n            }\n          } catch (error) {\n            console.error(`\uD83D\uDEA8 MANIFEST ERROR: Failed to fetch ${htmlPath}:`, error);\n          }\n        }\n      } else {\n        console.log(`\uD83D\uDCC1 ${constructor.name}: No HTML files in manifest - using renderContent() fallback`);\n      }\n      \n      // No HTML template found or available, use code-based renderContent()\n      return this.renderContent();\n    } catch (error) {\n      console.warn(`\uD83C\uDFA8 ${this.widgetName}: HTML template loading failed, using fallback:`, error);\n      return this.renderContent();\n    }\n  }\n\n  /**\n   * Load HTML templates if widget declares any (legacy method)\n   */\n  protected async loadHTMLTemplates(): Promise<string> {\n    const constructor = this.constructor as typeof BaseWidget;\n    const assets = await constructor.getWidgetAssets();\n    const htmlFiles = assets.filter(asset => asset.endsWith('.html'));\n    \n    if (htmlFiles.length === 0) {\n      return this.renderOwnContent(); // Fallback to code-based content\n    }\n    \n    try {\n      const constructor = this.constructor as typeof BaseWidget;\n      const htmlPromises = htmlFiles.map(file => \n        fetch(`${constructor.basePath}/${file}`).then(r => r.text())\n      );\n      \n      const htmlContents = await Promise.all(htmlPromises);\n      return htmlContents.join('\\n');\n      \n    } catch (error) {\n      console.warn(`Failed to load HTML templates for ${constructor.name}:`, error);\n      return this.renderOwnContent(); // Fallback to code-based content\n    }\n  }\n\n  /**\n   * Widget declares its own HTML content (fallback when no HTML files)\n   * Override in child classes to specify widget-specific content\n   */\n  protected renderOwnContent(): string {\n    return '<p>Base widget - override renderOwnContent() or declare getOwnHTML()</p>';\n  }\n  \n  /**\n   * Base widget HTML structure - includes collapse, header, content\n   */\n  protected renderBaseHTML(): string {\n    return `\n      <div class=\"widget-container\">\n        <div class=\"widget-header\" data-action=\"toggle-collapse\">\n          <div class=\"widget-title-row\">\n            <span class=\"widget-icon\">${this.widgetIcon}</span>\n            <span class=\"widget-title\">${this.widgetTitle}</span>\n            <span class=\"collapse-toggle\">${this.isCollapsed ? '\u25B6' : '\u25BC'}</span>\n          </div>\n        </div>\n        <div class=\"widget-content ${this.isCollapsed ? 'collapsed' : ''}\">\n          ${this.renderOwnContent()}\n        </div>\n      </div>\n    `;\n  }\n  \n  /**\n   * Get widget-relative asset path\n   */\n  protected getAssetPath(relativePath: string): string {\n    const basePath = (this.constructor as typeof BaseWidget).basePath;\n    return `${basePath}/${relativePath}`;\n  }\n\n  constructor() {\n    super();\n    console.log(`\uD83C\uDFD7\uFE0F ${this.constructor.name}: Constructor called`);\n    \n    try {\n      this.attachShadow({ mode: 'open' });\n      console.log(`\uD83C\uDFD7\uFE0F ${this.constructor.name}: Shadow DOM attached`);\n    } catch (error) {\n      captureError(error, {\n        component: 'widget',\n        widget: this.constructor.name,\n        operation: 'constructor'\n      });\n      throw error; // Re-throw so widget fails to initialize properly\n    }\n  }\n\n  async connectedCallback() {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: connectedCallback() triggered - connecting to DOM`);\n    this.widgetConnected = true;\n    \n    // Wrap with global error handler that captures EVERYTHING\n    await globalErrorHandler.safeExecute(async () => {\n      console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: About to call initializeWidget()`);\n      await this.initializeWidget();\n      console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: About to call render()`);\n      await this.render();\n      console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: connectedCallback() complete`);\n    }, {\n      component: 'widget',\n      widget: this.widgetName,\n      operation: 'connectedCallback'\n    });\n    \n    // If initialization failed, render basic fallback (avoid infinite loops)\n    if (!this.shadowRoot?.hasChildNodes()) {\n      // Simple fallback without console calls that could trigger infinite loops\n      if (this.shadowRoot) {\n        this.shadowRoot.innerHTML = `<div style=\"padding: 8px; color: #666; font-size: 12px;\">\u26A0\uFE0F ${this.widgetName}: Loading...</div>`;\n      }\n    }\n  }\n\n  /**\n   * Initialize widget - override for custom initialization\n   */\n  protected async initializeWidget(): Promise<void> {\n    // Setup server event listeners\n    this.setupServerEventListeners();\n    \n    // Override in child classes for custom initialization\n  }\n\n  /**\n   * Setup server event listeners - automatically called during initialization\n   */\n  private setupServerEventListeners(): void {\n    // Listen for server events\n    this.addEventListener('server:session-created', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      this.onServerSessionCreated(customEvent.detail);\n    });\n\n    this.addEventListener('server:session-joined', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      this.onServerSessionJoined(customEvent.detail);\n    });\n\n    this.addEventListener('server:health-updated', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      this.onServerHealthUpdated(customEvent.detail);\n    });\n\n    this.addEventListener('server:data-updated', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      this.onServerDataUpdated(customEvent.detail);\n    });\n\n    // Listen for data responses from server\n    this.addEventListener('widget:data-received', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      this.onDataReceived(customEvent.detail);\n    });\n\n    this.addEventListener('widget:command-complete', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      this.onCommandComplete(customEvent.detail);\n    });\n  }\n\n  /**\n   * Called when a new session is created on the server\n   * Override in child classes to respond to session events\n   */\n  protected onServerSessionCreated(event: SessionCreatedEvent): void {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Session created [${event.sessionType}]`, {\n      owner: event.owner,\n      capabilities: event.capabilities\n    });\n  }\n\n  /**\n   * Called when a session is joined on the server\n   * Override in child classes to respond to session events\n   */\n  protected onServerSessionJoined(event: SessionJoinedEvent): void {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Session joined [${event.sessionType}]`, {\n      joinedBy: event.joinedBy,\n      userCount: event.userCount\n    });\n  }\n\n  /**\n   * Called when server health status is updated\n   * Override in child classes to respond to health changes\n   */\n  protected onServerHealthUpdated(event: HealthUpdatedEvent): void {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Health updated [${event.health.overall}]`, {\n      score: event.health.score,\n      changedComponents: event.changedComponents\n    });\n  }\n\n  /**\n   * Called when server data is updated\n   * Override in child classes to respond to data changes\n   */\n  protected onServerDataUpdated(event: DataUpdatedEvent): void {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Data updated [${event.dataSource}]`, {\n      updateType: event.updateType,\n      affectedItems: event.affectedItems.length\n    });\n    \n    // Auto-refresh if this widget is interested in updated data\n    if (this.shouldAutoRefreshOnDataUpdate(event)) {\n      this.update();\n    }\n  }\n\n  /**\n   * Called when server data is received from fetchServerData()\n   * Override in child classes to handle data responses\n   */\n  protected onDataReceived(response: WidgetDataResponse): void {\n    if (response.success && response.data) {\n      console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Data received [${response.dataSource}]`, {\n        itemCount: response.metadata?.totalCount,\n        fromCache: response.metadata?.fromCache\n      });\n      this.processServerData(response.dataSource, response.data);\n    } else {\n      console.error(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Data fetch failed [${response.dataSource}]`, response.error);\n      this.onDataFetchError(response.dataSource, response.error || 'Unknown error');\n    }\n  }\n\n  /**\n   * Called when server command completes from executeServerCommand()\n   * Override in child classes to handle command responses\n   */\n  protected onCommandComplete(response: WidgetCommandResponse): void {\n    if (response.success && response.result) {\n      console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Command completed [${response.command}]`, {\n        executionTime: response.executionTime\n      });\n      this.processCommandResult(response.command, response.result);\n    } else {\n      console.error(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Command failed [${response.command}]`, response.error);\n      this.onCommandError(response.command, response.error || 'Unknown error');\n    }\n  }\n\n  /**\n   * Override to determine if widget should auto-refresh when data changes\n   * Uses strongly typed event data to make informed decisions\n   */\n  protected shouldAutoRefreshOnDataUpdate(_event: DataUpdatedEvent): boolean {\n    // Default: no auto-refresh, widgets opt-in by overriding this method\n    // Example: return event.dataSource === 'personas' && event.updateType !== 'deleted';\n    return false;\n  }\n\n  /**\n   * Override to process received server data\n   * Type-safe processing with known data source types\n   */\n  protected processServerData(dataSource: DataSourceType, data: unknown): void {\n    // Default: log data received - widgets should override to actually use the data\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Received ${dataSource} data - override processServerData() to use it`, data);\n  }\n\n  /**\n   * Override to process command results\n   * Type-safe command result processing\n   */\n  protected processCommandResult(command: string, result: unknown): void {\n    // Default: log command result - widgets should override to actually use the result\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Command ${command} result - override processCommandResult() to use it`, result);\n  }\n\n  /**\n   * Override to handle data fetch errors\n   * Type-safe error handling with data source context\n   */\n  protected onDataFetchError(dataSource: DataSourceType, error: string): void {\n    console.warn(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Data fetch error [${dataSource}] - override onDataFetchError() to handle gracefully`, error);\n  }\n\n  /**\n   * Override to handle command errors\n   * Type-safe command error handling\n   */\n  protected onCommandError(command: string, error: string): void {\n    console.warn(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Command ${command} error - override onCommandError() to handle gracefully`, error);\n  }\n\n  /**\n   * Get widget capabilities - override to declare what this widget can do\n   * This enables the system to route events and validate permissions properly\n   */\n  protected getWidgetCapabilities(): WidgetCapabilities {\n    return {\n      canFetchData: [], // Override with DataSourceType[] that this widget needs\n      canExecuteCommands: [], // Override with command names this widget uses  \n      respondsToEvents: [], // Override with server event types this widget cares about\n      supportsExport: [], // Override with export formats this widget supports\n      requiresAuth: false, // Override if this widget needs authentication\n      updateFrequency: 'manual' // Override with 'realtime', 'periodic', or 'manual'\n    };\n  }\n\n  disconnectedCallback() {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Disconnecting from DOM`);\n    this.widgetConnected = false;\n    \n    // Wrap cleanup with error handler\n    globalErrorHandler.safeExecute(() => {\n      this.cleanup();\n    }, {\n      component: 'widget',\n      widget: this.widgetName,\n      operation: 'disconnectedCallback'\n    });\n  }\n\n  /**\n   * Main render method - combines CSS and HTML\n   */\n  async render(): Promise<void> {\n    try {\n      console.log(`\uD83C\uDFA8 ${this.widgetName}: Starting render() - about to loadCSS()`);\n      const css = await this.loadCSS();\n      console.log(`\uD83C\uDFA8 ${this.widgetName}: CSS loaded, length: ${css.length} chars`);\n      \n      // Auto-load HTML templates if they exist, otherwise use renderContent()\n      const html = await this.loadHTMLTemplatesOrFallback();\n\n      this.shadowRoot.innerHTML = `\n        <style>\n          ${css}\n        </style>\n        ${html}\n      `;\n\n      // Setup event listeners - DOM is ready after innerHTML assignment\n      this.setupEventListeners();\n      this.setupCollapseToggle();\n      \n    } catch (error) {\n      console.error(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Render failed:`, error);\n      this.renderError(error);\n    }\n  }\n\n  /**\n   * Load CSS for the widget\n   */\n  async loadCSS(): Promise<string> {\n    const constructor = this.constructor as typeof BaseWidget;\n    \n    try {\n      // SMART MANIFEST: Only load CSS files that actually exist (Zero 404s!)\n      const baseCSS = '/src/ui/components/shared/BaseWidget.css';\n      \n      // Get CSS files from build-time manifest\n      const widgetAssets = window.WIDGET_ASSETS?.[constructor.name.replace(/^_/, '')];\n      const cssFiles = [baseCSS];\n      \n      if (widgetAssets && widgetAssets.css.length > 0) {\n        console.log(`\uD83D\uDCC1 ${constructor.name}: Found ${widgetAssets.css.length} CSS files in manifest (Zero 404s!)`);\n        const widgetCSSFiles = widgetAssets.css.map(file => `${constructor.basePath}/${file}`);\n        cssFiles.push(...widgetCSSFiles);\n      } else {\n        console.log(`\uD83D\uDCC1 ${constructor.name}: No CSS files in manifest - using BaseWidget only`);\n      }\n      \n      console.log(`\uD83C\uDFA8 ${constructor.name}: Loading CSS files:`, cssFiles);\n      const cssPromises = cssFiles.map(async (cssPath) => {\n        try {\n          const response = await fetch(cssPath);\n          if (!response.ok) {\n            // This should NEVER happen with smart manifest, but handle gracefully\n            console.error(`\uD83D\uDEA8 MANIFEST ERROR: ${cssPath} not found but was in manifest!`);\n            return '/* CSS failed to load - manifest error */';\n          }\n          const cssText = await response.text();\n          console.log(`\u2705 Loaded CSS: ${cssPath} (${cssText.length} chars)`);\n          return cssText;\n        } catch (error) {\n          console.error(`\uD83D\uDEA8 MANIFEST ERROR: Failed to fetch ${cssPath}:`, error);\n          return '/* CSS failed to load - manifest error */';\n        }\n      });\n      \n      const cssContents = await Promise.all(cssPromises);\n      const combinedCSS = cssContents.join('\\n');\n      \n      console.log(`\u2705 ${constructor.name}: Loaded ${cssFiles.length} CSS files successfully (Zero 404s!)`);\n      return combinedCSS;\n      \n    } catch (error) {\n      console.warn(`Failed to load CSS for ${constructor.name}:`, error);\n      return this.getDefaultBaseCSS();\n    }\n  }\n\n  /**\n   * Get bundled CSS - legacy method, now uses declared assets\n   */\n  getBundledCSS(): string | Promise<string> {\n    return this.loadCSS();\n  }\n\n\n  /**\n   * Load base CSS for collapse functionality\n   */\n  async loadBaseCSS(): Promise<string> {\n    try {\n      const response = await fetch('/src/ui/components/shared/BaseWidget.css');\n      return await response.text();\n    } catch (error) {\n      console.warn(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Failed to load base CSS, using fallback`, error);\n      return this.getDefaultBaseCSS();\n    }\n  }\n\n  /**\n   * Fallback CSS for essential functionality if file loading fails\n   */\n  getDefaultBaseCSS(): string {\n    return `\n      /* Minimal fallback CSS for collapse functionality */\n      .widget-header { cursor: pointer; padding: 12px 16px; }\n      .widget-title-row { display: flex; align-items: center; gap: 8px; }\n      .collapse-toggle { cursor: pointer; width: 16px; text-align: center; }\n      :host(.collapsed) .widget-content { display: none; }\n    `;\n  }\n\n  // Minimal methods - subclasses CAN override, but BaseWidget provides defaults\n  protected renderContent(): string {\n    // Try HTML templates first, fallback to renderOwnContent()\n    return this.renderOwnContent();\n  }\n  \n  protected setupEventListeners(): void {\n    // Default: basic collapse functionality - subclasses can extend\n    // Override this method to add your own event listeners\n  }\n  \n  /**\n   * Cleanup method for when widget is disconnected\n   */\n  protected cleanup(): void {\n    // Override in child classes if needed\n  }\n\n  /**\n   * Render error state\n   */\n  protected renderError(error: any): void {\n    this.shadowRoot.innerHTML = `\n      <style>\n        .error-container {\n          padding: 20px;\n          background: rgba(244, 67, 54, 0.1);\n          border: 1px solid rgba(244, 67, 54, 0.3);\n          border-radius: 8px;\n          color: #f44336;\n          text-align: center;\n        }\n        .error-title {\n          font-weight: 600;\n          margin-bottom: 8px;\n        }\n        .error-message {\n          font-size: 14px;\n          opacity: 0.8;\n        }\n      </style>\n      <div class=\"error-container\">\n        <div class=\"error-title\">\u274C ${this.widgetName} Error</div>\n        <div class=\"error-message\">${error.message || 'Unknown error occurred'}</div>\n      </div>\n    `;\n  }\n\n  /**\n   * Update widget state and re-render\n   */\n  protected async update(): Promise<void> {\n    if (this.widgetConnected) {\n      await this.render();\n    }\n  }\n\n  /**\n   * Server Control Events - Like onclick but for server actions\n   * Widgets can trigger server-side actions via simple event dispatch\n   * Uses centralized WidgetServerControls system\n   */\n  \n  /**\n   * Take screenshot of this widget (server control event)\n   */\n  protected triggerScreenshot(options: any = {}): void {\n    this.dispatchEvent(new CustomEvent('widget:screenshot', {\n      detail: options,\n      bubbles: true\n    }));\n  }\n\n  /**\n   * Refresh this widget from server (server control event) \n   */\n  protected triggerRefresh(options: any = {}): void {\n    this.dispatchEvent(new CustomEvent('widget:refresh', {\n      detail: options,\n      bubbles: true\n    }));\n  }\n\n  /**\n   * Export widget data (server control event)\n   */\n  protected triggerExport(format: string = 'json', options: any = {}): void {\n    this.dispatchEvent(new CustomEvent('widget:export', {\n      detail: { format, ...options },\n      bubbles: true\n    }));\n  }\n\n  /**\n   * Validate widget state (server control event)\n   */\n  protected triggerValidate(options: any = {}): void {\n    this.dispatchEvent(new CustomEvent('widget:validate', {\n      detail: options,\n      bubbles: true\n    }));\n  }\n\n  /**\n   * Fetch data from server (strongly typed server control event)\n   */\n  protected fetchServerData(dataSource: DataSourceType, requestOptions: Partial<WidgetDataRequest> = {}): void {\n    const request: WidgetDataRequest = {\n      dataSource,\n      ...requestOptions // Elegant spread - merge optional params, filters, etc.\n    };\n    \n    this.dispatchEvent(new CustomEvent('widget:fetch-data', {\n      detail: request,\n      bubbles: true\n    }));\n  }\n\n  /**\n   * Execute server command (strongly typed server control event)\n   */\n  protected executeServerCommand(command: string, requestOptions: Partial<WidgetCommandRequest> = {}): void {\n    const request: WidgetCommandRequest = {\n      command,\n      ...requestOptions // Elegant spread - merge timeout, priority, params, etc.\n    };\n    \n    this.dispatchEvent(new CustomEvent('widget:execute-command', {\n      detail: request,\n      bubbles: true\n    }));\n  }\n\n  /**\n   * Get continuum API if available\n   */\n  protected getContinuumAPI(): any {\n    return (window as any).continuum;\n  }\n\n  /**\n   * Check if continuum API is connected\n   */\n  protected isContinuumConnected(): boolean {\n    const continuum = this.getContinuumAPI();\n    return continuum && continuum.isConnected();\n  }\n\n  /**\n   * Send message via continuum API (using execute with message command)\n   */\n  protected sendMessage(message: any): void {\n    // Use execute with a generic message command instead of non-existent send method\n    this.notifySystem('widget_message', message);\n  }\n\n  /**\n   * Execute command via continuum API\n   */\n  protected async executeCommand(command: string, params: any = {}): Promise<any> {\n    const continuum = this.getContinuumAPI();\n    if (continuum) {\n      return await continuum.execute(command, params);\n    } else {\n      throw new Error('Continuum API not available');\n    }\n  }\n\n  /**\n   * Simple widget notification system - uses WidgetDaemon queue\n   */\n  protected notifySystem(eventType: string, data?: any): void {\n    try {\n      // Try to use WidgetDaemon first (preferred approach)\n      const widgetDaemon = this.getWidgetDaemon();\n      if (widgetDaemon) {\n        widgetDaemon.notifySystem(this.widgetName, eventType, data);\n        return;\n      }\n      \n      // Fallback: Direct logging if no daemon available\n      console.log(`\uD83D\uDD14 ${this.widgetName}: ${eventType}`, data ? { event: eventType, data } : { event: eventType });\n      \n      // Try to forward to continuum API as last resort\n      const continuum = this.getContinuumAPI();\n      if (continuum && typeof continuum.emit === 'function') {\n        continuum.emit(eventType, { widget: this.widgetName, data });\n      }\n    } catch (error) {\n      // Fail silently - notification is optional\n      console.warn(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Failed to notify system about ${eventType}:`, error);\n    }\n  }\n\n  /**\n   * Get WidgetDaemon from browser daemon system\n   */\n  private getWidgetDaemon(): any {\n    try {\n      // Access WidgetDaemon through global browser daemon controller\n      const browserDaemonController = (window as any).browserDaemonController;\n      if (browserDaemonController && typeof browserDaemonController.getWidgetDaemon === 'function') {\n        return browserDaemonController.getWidgetDaemon();\n      }\n      \n      // Try direct access to widgetDaemon global\n      const widgetDaemon = (window as any).widgetDaemon;\n      if (widgetDaemon && typeof widgetDaemon.notifySystem === 'function') {\n        return widgetDaemon;\n      }\n      \n      return null;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Simple command execution with graceful fallback\n   */\n  protected async tryExecuteCommand(command: string, params: any = {}): Promise<any> {\n    try {\n      const continuum = this.getContinuumAPI();\n      if (continuum && typeof continuum.execute === 'function') {\n        return await continuum.execute(command, params);\n      } else {\n        console.warn(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Cannot execute command ${command} - API not available`);\n        return { success: false, error: 'Continuum API not available' };\n      }\n    } catch (error) {\n      console.warn(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Command ${command} failed:`, error);\n      return { success: false, error: error instanceof Error ? error.message : String(error) };\n    }\n  }\n\n  /**\n   * Register simple status listener - widgets can override this\n   */\n  protected onSystemStatus(status: string, data?: any): void {\n    // Default implementation - widgets can override\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: System status ${status}`, data);\n  }\n\n  /**\n   * DEPRECATED: Use notifySystem() instead\n   * Kept for backward compatibility with existing widgets\n   */\n  protected onContinuumEvent(type: string, _handler: (data: any) => void): void {\n    console.warn(`\u26A0\uFE0F ${this.widgetName}: onContinuumEvent() is deprecated. Use notifySystem() instead.`);\n    \n    // Graceful fallback - just log the registration attempt\n    console.log(`\uD83D\uDD04 ${this.widgetName}: Would register event listener for ${type} (deprecated API)`);\n    \n    // Don't actually register anything - this prevents errors but encourages migration\n  }\n\n  /**\n   * Toggle collapse state for widgets\n   */\n  toggleCollapse(): void {\n    this.isCollapsed = !this.isCollapsed;\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: ${this.isCollapsed ? 'Collapsed' : 'Expanded'}`);\n    this.updateCollapseState();\n  }\n\n  /**\n   * Update DOM to reflect collapse state\n   */\n  updateCollapseState(): void {\n    const content = this.shadowRoot.querySelector('.widget-content') as HTMLElement;\n    const toggle = this.shadowRoot.querySelector('.collapse-toggle') as HTMLElement;\n    \n    if (content) {\n      if (this.isCollapsed) {\n        content.style.display = 'none';\n        content.style.maxHeight = '0';\n        content.style.overflow = 'hidden';\n      } else {\n        content.style.display = '';\n        content.style.maxHeight = '';\n        content.style.overflow = '';\n      }\n    }\n\n    if (toggle) {\n      toggle.innerHTML = this.isCollapsed ? '\u25B6' : '\u25BC';\n    }\n\n    // Add collapsed class to host element for CSS styling\n    if (this.isCollapsed) {\n      this.classList.add('collapsed');\n    } else {\n      this.classList.remove('collapsed');\n    }\n  }\n\n  /**\n   * Render error state when widget initialization fails\n   */\n  protected async renderErrorState(error: any): Promise<void> {\n    if (!this.shadowRoot) return;\n    \n    const errorMessage = error instanceof Error ? error.message : String(error);\n    \n    // Don't call console.error here to avoid infinite loops when server is down\n    // The error is already captured by the calling globalErrorHandler.safeExecute()\n\n    this.shadowRoot.innerHTML = `\n      <style>\n        .error-widget {\n          background: #ffe6e6;\n          border: 2px solid #ff9999;\n          border-radius: 8px;\n          padding: 16px;\n          margin: 8px;\n          font-family: monospace;\n          color: #cc0000;\n        }\n        .error-title {\n          font-weight: bold;\n          margin-bottom: 8px;\n        }\n        .error-message {\n          margin-bottom: 8px;\n          font-size: 14px;\n        }\n        .error-time {\n          font-size: 12px;\n          color: #666;\n        }\n      </style>\n      <div class=\"error-widget\">\n        <div class=\"error-title\">\u26A0\uFE0F ${this.widgetName} Error</div>\n        <div class=\"error-message\">${errorMessage}</div>\n        <div class=\"error-time\">${new Date().toLocaleTimeString()}</div>\n      </div>\n    `;\n  }\n\n  /**\n   * Setup collapse toggle functionality\n   */\n  setupCollapseToggle(): void {\n    const toggle = this.shadowRoot.querySelector('.collapse-toggle') as HTMLElement;\n    if (toggle) {\n      toggle.addEventListener('click', (e: Event) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.toggleCollapse();\n      });\n    }\n  }\n\n  /**\n   * Render widget with collapsible header\n   */\n  renderWithCollapseHeader(content: string): string {\n    return `\n      <div class=\"widget-header\">\n        <div class=\"widget-title-row\">\n          <span class=\"collapse-toggle\">\u25BC</span>\n          <span class=\"widget-icon\">${this.widgetIcon}</span>\n          <span class=\"widget-title\">${this.widgetTitle}</span>\n        </div>\n      </div>\n      <div class=\"widget-content\">\n        ${content}\n      </div>\n    `;\n  }\n}", "/**\n * ActiveProjects Widget - TypeScript Implementation\n * Shows current active projects with progress tracking\n */\nimport { BaseWidget } from '../shared/BaseWidget';\n\ninterface Project {\n  id: string;\n  name: string;\n  status: 'active' | 'paused' | 'completed' | 'planning';\n  progress: number;\n  lastActivity: string;\n  assignedAgents: string[];\n  priority: 'high' | 'medium' | 'low';\n}\n\nexport class ActiveProjectsWidget extends BaseWidget {\n  private projects: Project[] = [];\n  private selectedProject: Project | null = null;\n\n  constructor() {\n    super();\n    this.widgetName = 'ActiveProjects';\n    this.widgetIcon = '\uD83D\uDCCB';\n    this.widgetTitle = 'Active Projects';\n  }\n\n\n  async initializeWidget(): Promise<void> {\n    await this.loadProjects();\n    this.setupContinuumListeners();\n  }\n\n  setupContinuumListeners(): void {\n    if (this.getContinuumAPI()) {\n      this.onContinuumEvent('projects_updated', () => {\n        console.log('\uD83C\uDF9B\uFE0F ActiveProjects: projects_updated received');\n        this.loadProjects();\n      });\n\n      this.onContinuumEvent('project_progress_changed', (data: any) => {\n        console.log('\uD83C\uDF9B\uFE0F ActiveProjects: project_progress_changed received', data);\n        this.updateProjectProgress(data.projectId, data.progress);\n      });\n\n      console.log('\uD83C\uDF9B\uFE0F ActiveProjects: Connected to continuum API');\n    } else {\n      setTimeout(() => this.setupContinuumListeners(), 1000);\n    }\n  }\n\n  async loadProjects(): Promise<void> {\n    try {\n      if (!this.isContinuumConnected()) {\n        console.log('\uD83C\uDF9B\uFE0F ActiveProjects: Not connected, using mock data');\n        this.loadMockData();\n        return;\n      }\n\n      const response = await this.executeCommand('projects', { action: 'list_active' });\n      if (response && response.projects) {\n        this.projects = response.projects;\n        console.log(`\uD83C\uDF9B\uFE0F ActiveProjects: Loaded ${this.projects.length} projects`);\n      } else {\n        this.loadMockData();\n      }\n\n      await this.update();\n    } catch (error) {\n      console.error('\uD83C\uDF9B\uFE0F ActiveProjects: Failed to load projects:', error);\n      this.loadMockData();\n    }\n  }\n\n  loadMockData(): void {\n    this.projects = [\n      {\n        id: 'continuum-os',\n        name: 'Continuum OS',\n        status: 'active',\n        progress: 75,\n        lastActivity: '2 minutes ago',\n        assignedAgents: ['Claude Sonnet', 'Protocol Sheriff'],\n        priority: 'high'\n      },\n      {\n        id: 'widget-system',\n        name: 'Widget System',\n        status: 'active',\n        progress: 45,\n        lastActivity: '15 minutes ago',\n        assignedAgents: ['Code Specialist'],\n        priority: 'medium'\n      }\n    ];\n    this.update();\n  }\n\n  updateProjectProgress(projectId: string, progress: number): void {\n    const project = this.projects.find(p => p.id === projectId);\n    if (project) {\n      project.progress = progress;\n      this.update();\n    }\n  }\n\n  renderContent(): string {\n    const content = `\n      <div class=\"project-list\">\n        ${this.projects.length === 0 ? this.renderEmptyState() : this.projects.map(project => this.renderProject(project)).join('')}\n      </div>\n\n      <div class=\"actions\">\n        <button class=\"btn btn-primary\" data-action=\"create\">New Project</button>\n        <button class=\"btn btn-secondary\" data-action=\"refresh\">Refresh</button>\n      </div>\n    `;\n\n    return this.renderWithCollapseHeader(content);\n  }\n\n  renderProject(project: Project): string {\n    const isSelected = this.selectedProject?.id === project.id;\n    const priorityIcon = this.getPriorityIcon(project.priority);\n    const statusIcon = this.getStatusIcon(project.status);\n    \n    return `\n      <div class=\"project-item ${isSelected ? 'selected' : ''}\" data-project-id=\"${project.id}\">\n        <div class=\"project-header\">\n          <div class=\"project-name\">${project.name}</div>\n          <div class=\"project-indicators\">\n            <span class=\"priority-indicator priority-${project.priority}\">${priorityIcon}</span>\n            <span class=\"status-indicator status-${project.status}\">${statusIcon}</span>\n          </div>\n        </div>\n        \n        <div class=\"project-progress\">\n          <div class=\"progress-bar\">\n            <div class=\"progress-fill\" style=\"width: ${project.progress}%\"></div>\n          </div>\n          <span class=\"progress-text\">${project.progress}%</span>\n        </div>\n        \n        <div class=\"project-details\">\n          <div class=\"last-activity\">${project.lastActivity}</div>\n          <div class=\"assigned-agents\">\n            ${(project.assignedAgents || []).slice(0, 2).map(agent => `<span class=\"agent-tag\">${agent}</span>`).join('')}\n            ${(project.assignedAgents || []).length > 2 ? `<span class=\"agent-count\">+${(project.assignedAgents || []).length - 2}</span>` : ''}\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  getPriorityIcon(priority: string): string {\n    switch (priority) {\n      case 'high': return '\uD83D\uDD34';\n      case 'medium': return '\uD83D\uDFE1';\n      case 'low': return '\uD83D\uDFE2';\n      default: return '\u26AA';\n    }\n  }\n\n  getStatusIcon(status: string): string {\n    switch (status) {\n      case 'active': return '\u25B6\uFE0F';\n      case 'paused': return '\u23F8\uFE0F';\n      case 'completed': return '\u2705';\n      case 'planning': return '\uD83D\uDCCB';\n      default: return '\u2753';\n    }\n  }\n\n  renderEmptyState(): string {\n    return `\n      <div class=\"empty-state\">\n        No active projects.<br>\n        Create your first project to get started!\n      </div>\n    `;\n  }\n\n  setupEventListeners(): void {\n    // Project selection and action buttons\n    this.shadowRoot.addEventListener('click', (e: Event) => {\n      const target = e.target as HTMLElement;\n      \n      // Project selection\n      const projectItem = target.closest('.project-item') as HTMLElement;\n      if (projectItem) {\n        const projectId = projectItem.dataset.projectId;\n        if (projectId) {\n          this.selectProject(projectId);\n        }\n        return;\n      }\n\n      // Action buttons\n      if (target.matches('.btn')) {\n        const action = target.getAttribute('data-action');\n        if (action) {\n          this.handleAction(action);\n        }\n      }\n    });\n  }\n\n  selectProject(projectId: string): void {\n    const project = this.projects.find(p => p.id === projectId);\n    if (project) {\n      this.selectedProject = project;\n      console.log('\uD83C\uDF9B\uFE0F ActiveProjects: Selected project:', project.name);\n      \n      this.sendMessage({\n        type: 'project_selected',\n        project: project\n      });\n\n      this.update();\n    }\n  }\n\n  async handleAction(action: string): Promise<void> {\n    switch (action) {\n      case 'create':\n        console.log('\uD83C\uDF9B\uFE0F ActiveProjects: Creating new project...');\n        try {\n          await this.executeCommand('projects', { action: 'create' });\n        } catch (error) {\n          console.error('\uD83C\uDF9B\uFE0F ActiveProjects: Failed to create project:', error);\n        }\n        break;\n\n      case 'refresh':\n        console.log('\uD83C\uDF9B\uFE0F ActiveProjects: Refreshing projects...');\n        await this.loadProjects();\n        break;\n\n      default:\n        console.log('\uD83C\uDF9B\uFE0F ActiveProjects: Unknown action:', action);\n    }\n  }\n}\n\n// Register the custom element\nif (!customElements.get('active-projects')) {\n  customElements.define('active-projects', ActiveProjectsWidget);\n}", "/**\n * Universal User System - ELEGANT & SIMPLE\n * Real users from database/shared storage via server API\n */\n\n// ELEGANT: Simple inline types - no external dependencies\nexport interface UniversalUser {\n  id: string;\n  name: string;\n  type: 'human' | 'persona' | 'ai-model' | 'ai-system';\n  avatar: string;\n  status: 'online' | 'offline' | 'thinking' | 'working' | 'idle';\n  capabilities: string[];\n  isClickable: boolean;\n  currentTask?: string;\n}\n\nexport class UniversalUserSystem {\n  private users = new Map<string, UniversalUser>();\n  private eventListeners = new Map<string, Function[]>();\n\n  constructor() {\n    // ELEGANT: Don't block constructor - load users async when ready\n    this.loadUsersWhenReady();\n  }\n\n  private async loadUsersWhenReady(): Promise<void> {\n    // ELEGANT: Wait for continuum API to be available, then load real users\n    try {\n      // Wait for continuum API\n      while (!(globalThis as any).continuum) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n      \n      const continuum = (globalThis as any).continuum;\n      const response = await continuum.execute('users', {});\n      \n      if (response?.users && Array.isArray(response.users)) {\n        console.log(`\u2705 Loaded ${response.users.length} real users from server`);\n        response.users.forEach((user: UniversalUser) => {\n          this.addUser(user);\n        });\n        return;\n      }\n    } catch (error) {\n      console.warn('\u26A0\uFE0F Failed to load real users, using fallback:', error);\n    }\n    \n    // ELEGANT: Minimal fallback - just current user\n    this.addUser({\n      id: 'current-user',\n      name: 'User',\n      type: 'human',\n      avatar: '\uD83D\uDC64',\n      status: 'online',\n      capabilities: ['all'],\n      isClickable: false\n    });\n  }\n\n  // ELEGANT: Simple user management\n  addUser(user: UniversalUser): void {\n    this.users.set(user.id, user);\n    this.notifyUserAdded(user);\n  }\n\n  updateUser(userId: string, updates: Partial<UniversalUser>): void {\n    const user = this.users.get(userId);\n    if (user) {\n      Object.assign(user, updates);\n      this.notifyUserUpdated(user);\n    }\n  }\n\n  getUser(userId: string): UniversalUser | null {\n    return this.users.get(userId) || null;\n  }\n\n  getAllUsers(): UniversalUser[] {\n    return Array.from(this.users.values());\n  }\n\n  getClickableUsers(): UniversalUser[] {\n    return Array.from(this.users.values()).filter(u => u.isClickable);\n  }\n\n  // ELEGANT: Simple event system\n  on(event: string, callback: Function): void {\n    if (!this.eventListeners.has(event)) {\n      this.eventListeners.set(event, []);\n    }\n    this.eventListeners.get(event)!.push(callback);\n  }\n\n  private emit(event: string, data: any): void {\n    const listeners = this.eventListeners.get(event) || [];\n    listeners.forEach(callback => callback(data));\n  }\n\n  private notifyUserAdded(user: UniversalUser): void {\n    this.emit('user:added', user);\n  }\n\n  private notifyUserUpdated(user: UniversalUser): void {\n    this.emit('user:updated', user);\n  }\n\n  // ELEGANT: Handle user clicks for widget interactions\n  handleUserClick(userId: string, options: any = {}): void {\n    const user = this.getUser(userId);\n    if (user) {\n      this.emit('user:clicked', { user, options });\n      console.log(`\uD83C\uDF9B\uFE0F User clicked: ${user.name}`, options);\n      \n      // If user is clickable, perform default action\n      if (user.isClickable) {\n        // Could trigger chat, collaboration, or context switching\n        this.emit('user:interact', { user, action: 'select', options });\n      }\n    } else {\n      console.warn(`\u26A0\uFE0F User not found: ${userId}`);\n    }\n  }\n\n  // ELEGANT: Simple HTML generation for UI\n  generateConnectedUsersHTML(): string {\n    const users = this.getAllUsers();\n    return users.map(user => `\n      <div class=\"user-badge ${user.isClickable ? 'clickable' : ''} ${user.type}\" data-user-id=\"${user.id}\">\n        <span class=\"user-avatar\">${user.avatar}</span>\n        <span class=\"user-name\">${user.name}</span>\n        <span class=\"user-status ${user.status}\"></span>\n        ${user.currentTask ? `<span class=\"user-task\">${user.currentTask}</span>` : ''}\n      </div>\n    `).join('');\n  }\n}\n\n// Global singleton instance\nexport const universalUserSystem = new UniversalUserSystem();", "/**\n * RoomDataManager - Centralized Room Data Management\n * \n * Provides complete room information to all widgets, eliminating the need for\n * string manipulation and ensuring all components have access to rich metadata\n */\n\nexport interface RoomData {\n  id: string;\n  name: string;\n  type: string;\n  description: string;\n  autoCreated?: boolean;\n  metadata?: {\n    default?: boolean;\n    category?: string;\n    icon?: string;\n    [key: string]: any;\n  };\n  participants?: RoomParticipant[];\n  messageCount?: number;\n  lastActivity?: Date;\n}\n\nexport interface RoomParticipant {\n  id: string;\n  name: string;\n  type: 'user' | 'ai' | 'system';\n  avatar?: string;\n  status: 'online' | 'away' | 'offline';\n  role?: string;\n}\n\nexport interface RoomChangeEvent {\n  previousRoom: RoomData | null;\n  currentRoom: RoomData;\n  timestamp: Date;\n}\n\n/**\n * Centralized Room Data Manager\n * Single source of truth for all room information across widgets\n */\nexport class RoomDataManager extends EventTarget {\n  private rooms: Map<string, RoomData> = new Map();\n  private currentRoom: RoomData | null = null;\n  private isInitialized: boolean = false;\n  private roomTypeConfig: any = null; // Loaded from JSON\n  \n  private static instance: RoomDataManager | null = null;\n  \n  static getInstance(): RoomDataManager {\n    if (!RoomDataManager.instance) {\n      RoomDataManager.instance = new RoomDataManager();\n    }\n    return RoomDataManager.instance;\n  }\n  \n  private constructor() {\n    super();\n    console.log('\uD83C\uDFE0 RoomDataManager: Initializing centralized room data system');\n  }\n  \n  /**\n   * Initialize with room data from server\n   */\n  async initialize(): Promise<void> {\n    if (this.isInitialized) {\n      return;\n    }\n    \n    try {\n      console.log('\uD83C\uDFE0 RoomDataManager: Loading room data from server...');\n      \n      // Load room type configuration first\n      await this.loadRoomTypeConfig();\n      \n      // First try to load from server API\n      if ((window as any).continuum && typeof (window as any).continuum.execute === 'function') {\n        try {\n          const response = await (window as any).continuum.execute('listrooms', {});\n          if (response?.rooms) {\n            this.loadRoomsFromAPI(response.rooms);\n            this.isInitialized = true;\n            console.log(`\uD83C\uDFE0 RoomDataManager: Loaded ${this.rooms.size} rooms from server API`);\n            return;\n          }\n        } catch (error) {\n          console.warn('\uD83C\uDFE0 RoomDataManager: Server API not available, falling back to static data');\n        }\n      }\n      \n      // Fallback: Load default rooms from static config\n      await this.loadDefaultRooms();\n      this.isInitialized = true;\n      \n      // Set default current room\n      if (!this.currentRoom && this.rooms.has('general')) {\n        this.setCurrentRoom('general');\n      }\n      \n      console.log(`\uD83C\uDFE0 RoomDataManager: Initialized with ${this.rooms.size} rooms`);\n      \n    } catch (error) {\n      console.error('\uD83C\uDFE0 RoomDataManager: Failed to initialize:', error);\n      // Create minimal fallback room so widgets don't break\n      this.createFallbackRoom();\n    }\n  }\n  \n  private async loadRoomTypeConfig(): Promise<void> {\n    try {\n      const response = await fetch('/src/ui/components/shared/room-type-config.json');\n      if (!response.ok) {\n        throw new Error(`Failed to load room type config: ${response.status}`);\n      }\n      \n      this.roomTypeConfig = await response.json();\n      console.log('\uD83C\uDFE0 RoomDataManager: Loaded room type configuration');\n      \n    } catch (error) {\n      console.warn('\uD83C\uDFE0 RoomDataManager: Failed to load room type config, using defaults:', error);\n      // Minimal fallback\n      this.roomTypeConfig = {\n        roomTypes: {\n          chat: { displayName: 'Chat Room', icon: '\uD83D\uDCAC' }\n        },\n        fallbacks: {\n          unknownType: { displayName: 'Room', icon: '\uD83C\uDFE0' }\n        }\n      };\n    }\n  }\n  \n  private loadRoomsFromAPI(roomsData: any[]): void {\n    for (const roomData of roomsData) {\n      const room: RoomData = {\n        id: roomData.id,\n        name: roomData.name || this.generateFallbackRoomName(roomData.id, roomData.type),\n        type: roomData.type || 'chat',\n        description: roomData.description || `Chat room: ${roomData.name || this.generateFallbackRoomName(roomData.id, roomData.type)}`,\n        autoCreated: roomData.autoCreated || false,\n        metadata: roomData.metadata || {},\n        participants: roomData.participants || [],\n        messageCount: roomData.messageCount || 0,\n        lastActivity: roomData.lastActivity ? new Date(roomData.lastActivity) : new Date()\n      };\n      \n      this.rooms.set(room.id, room);\n    }\n  }\n  \n  private async loadDefaultRooms(): Promise<void> {\n    try {\n      // Load from the same config that ChatRoomDaemon uses\n      const response = await fetch('/src/daemons/chatroom/config/default-rooms.json');\n      if (!response.ok) {\n        throw new Error(`Failed to load default rooms: ${response.status}`);\n      }\n      \n      const config = await response.json();\n      \n      for (const roomConfig of config.defaultRooms) {\n        const room: RoomData = {\n          id: roomConfig.id,\n          name: roomConfig.name,\n          type: roomConfig.type,\n          description: roomConfig.description,\n          autoCreated: roomConfig.autoCreated || false,\n          metadata: {\n            ...roomConfig.metadata,\n            icon: this.getDefaultRoomIcon(roomConfig.type, roomConfig.id)\n          },\n          participants: [],\n          messageCount: 0,\n          lastActivity: new Date()\n        };\n        \n        this.rooms.set(room.id, room);\n      }\n      \n      console.log('\uD83C\uDFE0 RoomDataManager: Loaded default rooms from config');\n      \n    } catch (error) {\n      console.warn('\uD83C\uDFE0 RoomDataManager: Failed to load default rooms config:', error);\n      this.createFallbackRoom();\n    }\n  }\n  \n  private createFallbackRoom(): void {\n    const fallbackRoom: RoomData = {\n      id: 'general',\n      name: 'General Chat',\n      type: 'chat',\n      description: 'Main chat room for general conversation',\n      autoCreated: true,\n      metadata: { default: true, category: 'public', icon: '\uD83D\uDCAC' },\n      participants: [],\n      messageCount: 0,\n      lastActivity: new Date()\n    };\n    \n    this.rooms.set('general', fallbackRoom);\n    console.log('\uD83C\uDFE0 RoomDataManager: Created fallback room');\n  }\n  \n  private getDefaultRoomIcon(type: string, id: string): string {\n    if (!this.roomTypeConfig) {\n      return '\uD83C\uDFE0'; // Fallback if config not loaded\n    }\n    \n    // Check by type first\n    if (this.roomTypeConfig.roomTypes[type]) {\n      return this.roomTypeConfig.roomTypes[type].icon;\n    }\n    \n    // Check by ID for legacy rooms\n    if (this.roomTypeConfig.roomTypes[id]) {\n      return this.roomTypeConfig.roomTypes[id].icon;\n    }\n    \n    // Use unknown type fallback\n    return this.roomTypeConfig.fallbacks?.unknownType?.icon || '\uD83C\uDFE0';\n  }\n  \n  /**\n   * Generate a fallback name for rooms that don't have proper names\n   * Since room IDs are UUIDs, we can't just capitalize them\n   */\n  private generateFallbackRoomName(roomId: string, type?: string): string {\n    // Check if it looks like a UUID\n    if (roomId.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)) {\n      // For UUIDs, use JSON config for meaningful names\n      if (this.roomTypeConfig?.roomTypes[type || 'chat']) {\n        return this.roomTypeConfig.roomTypes[type || 'chat'].displayName;\n      }\n      \n      // Fallback if config not available\n      return this.roomTypeConfig?.fallbacks?.unknownType?.displayName || 'Room';\n    }\n    \n    // For legacy string IDs, capitalize first letter\n    return roomId.charAt(0).toUpperCase() + roomId.slice(1);\n  }\n  \n  /**\n   * Get complete room data by ID\n   */\n  getRoom(roomId: string): RoomData | null {\n    return this.rooms.get(roomId) || null;\n  }\n  \n  /**\n   * Get all available rooms\n   */\n  getAllRooms(): RoomData[] {\n    return Array.from(this.rooms.values());\n  }\n  \n  /**\n   * Get current room data\n   */\n  getCurrentRoom(): RoomData | null {\n    return this.currentRoom;\n  }\n  \n  /**\n   * Set current room and notify all listeners\n   */\n  setCurrentRoom(roomId: string): boolean {\n    const newRoom = this.rooms.get(roomId);\n    if (!newRoom) {\n      console.warn(`\uD83C\uDFE0 RoomDataManager: Room '${roomId}' not found`);\n      return false;\n    }\n    \n    const previousRoom = this.currentRoom;\n    this.currentRoom = newRoom;\n    \n    const changeEvent: RoomChangeEvent = {\n      previousRoom,\n      currentRoom: newRoom,\n      timestamp: new Date()\n    };\n    \n    console.log(`\uD83C\uDFE0 RoomDataManager: Room changed: ${previousRoom?.name || 'none'} \u2192 ${newRoom.name}`);\n    \n    // Dispatch both specific room change event and generic change event\n    this.dispatchEvent(new CustomEvent('room-changed', { detail: changeEvent }));\n    this.dispatchEvent(new CustomEvent('current-room-updated', { detail: newRoom }));\n    \n    return true;\n  }\n  \n  /**\n   * Update room data (e.g., participant count, last activity)\n   */\n  updateRoom(roomId: string, updates: Partial<RoomData>): void {\n    const room = this.rooms.get(roomId);\n    if (!room) {\n      console.warn(`\uD83C\uDFE0 RoomDataManager: Cannot update room '${roomId}' - not found`);\n      return;\n    }\n    \n    // Merge updates into existing room data\n    const updatedRoom = { ...room, ...updates };\n    this.rooms.set(roomId, updatedRoom);\n    \n    // If this is the current room, update current room reference\n    if (this.currentRoom?.id === roomId) {\n      this.currentRoom = updatedRoom;\n      this.dispatchEvent(new CustomEvent('current-room-updated', { detail: updatedRoom }));\n    }\n    \n    console.log(`\uD83C\uDFE0 RoomDataManager: Updated room '${roomId}'`, updates);\n  }\n  \n  /**\n   * Add or update a participant in a room\n   */\n  updateRoomParticipant(roomId: string, participant: RoomParticipant): void {\n    const room = this.rooms.get(roomId);\n    if (!room) return;\n    \n    const participants = room.participants || [];\n    const existingIndex = participants.findIndex(p => p.id === participant.id);\n    \n    if (existingIndex >= 0) {\n      participants[existingIndex] = participant;\n    } else {\n      participants.push(participant);\n    }\n    \n    this.updateRoom(roomId, { participants });\n  }\n  \n  /**\n   * Remove a participant from a room\n   */\n  removeRoomParticipant(roomId: string, participantId: string): void {\n    const room = this.rooms.get(roomId);\n    if (!room) return;\n    \n    const participants = (room.participants || []).filter(p => p.id !== participantId);\n    this.updateRoom(roomId, { participants });\n  }\n  \n  /**\n   * Get welcome message for a room type from JSON config\n   */\n  getWelcomeMessage(roomType: string): string {\n    if (!this.roomTypeConfig) {\n      return 'Welcome! Start a conversation.';\n    }\n    \n    const typeConfig = this.roomTypeConfig.roomTypes[roomType];\n    if (typeConfig?.defaultWelcomeMessage) {\n      return typeConfig.defaultWelcomeMessage;\n    }\n    \n    return this.roomTypeConfig.fallbacks?.unknownType?.defaultWelcomeMessage || 'Welcome! Start a conversation.';\n  }\n  \n  /**\n   * Check if room data manager is ready for use\n   */\n  isReady(): boolean {\n    return this.isInitialized && this.rooms.size > 0;\n  }\n  \n  /**\n   * Force refresh room data from server\n   */\n  async refresh(): Promise<void> {\n    this.isInitialized = false;\n    this.rooms.clear();\n    await this.initialize();\n  }\n}\n\n// Global singleton instance\nexport const roomDataManager = RoomDataManager.getInstance();", "/**\n * ChatWidget - TypeScript Web Component\n * Handles message display and input for chat rooms\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\nimport { universalUserSystem } from '../shared/UniversalUserSystem';\nimport { roomDataManager, RoomData, RoomChangeEvent } from '../shared/RoomDataManager';\nimport { \n  ChatEventsConfig\n} from '../shared/ChatEventTypes';\n\ninterface Message {\n  id: string;\n  type: 'user' | 'assistant' | 'system';\n  content: string;\n  timestamp: Date;\n  status?: 'sending' | 'sent' | 'error';\n  metadata?: {\n    agent?: string;\n    persona?: string;\n  };\n}\n\n// TODO: Move to shared types when room system is implemented\nexport interface Room {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  type: string;\n}\n\nexport class ChatWidget extends BaseWidget {\n  private messages: Message[] = [];\n  private isTyping: boolean = false;\n  private messageIdCounter: number = 0;\n  private currentRoom: RoomData | null = null; // Now using complete room data instead of just ID\n  private isLoadingHistory: boolean = false;\n  private chatEventsConfig: ChatEventsConfig | null = null; // Loaded from JSON\n\n\n  constructor() {\n    console.log('\uD83C\uDFD7\uFE0F ChatWidget: Constructor called, about to call super()');\n    super();\n    console.log('\uD83C\uDFD7\uFE0F ChatWidget: super() completed, setting properties');\n    this.widgetName = 'ChatWidget';\n    this.widgetIcon = '\uD83D\uDCAC';\n    this.widgetTitle = 'Chat';\n    console.log('\uD83C\uDFD7\uFE0F ChatWidget: Constructor complete');\n    // CSS loaded via declarative asset system\n  }\n\n\n  protected async initializeWidget(): Promise<void> {\n    await this.initializeRoomDataManager();\n    await this.loadChatEventsConfig();\n    await this.initializeChat();\n    this.setupContinuumListeners();\n    this.setupServerControlListeners();\n    this.setupUniversalUserSystem();\n    this.setupRoomDataListeners();\n  }\n\n  private async initializeRoomDataManager(): Promise<void> {\n    console.log('\uD83D\uDCAC Chat: Initializing room data manager...');\n    \n    // Initialize room data manager if not already done\n    await roomDataManager.initialize();\n    \n    // Set initial room (either current room or default)\n    if (!this.currentRoom) {\n      this.currentRoom = roomDataManager.getCurrentRoom() || roomDataManager.getRoom('general');\n      if (!this.currentRoom) {\n        console.warn('\uD83D\uDCAC Chat: No rooms available, will show placeholder');\n      }\n    }\n  }\n\n  private async loadChatEventsConfig(): Promise<void> {\n    try {\n      console.log('\uD83D\uDCAC Chat: Loading chat events configuration...');\n      \n      const response = await fetch('/src/ui/components/shared/chat-events-config.json');\n      if (!response.ok) {\n        throw new Error(`Failed to load chat events config: ${response.status}`);\n      }\n      \n      this.chatEventsConfig = await response.json() as ChatEventsConfig;\n      console.log('\uD83D\uDCAC Chat: Chat events configuration loaded');\n      \n    } catch (error) {\n      console.warn('\uD83D\uDCAC Chat: Failed to load chat events config, using defaults:', error);\n      // Minimal fallback config\n      this.chatEventsConfig = {\n        chatEvents: {\n          message_received: { handler: 'handleIncomingMessage', description: 'New message' },\n          agent_typing: { handler: 'setTypingIndicator', handlerArgs: [true], description: 'Typing' },\n          agent_stop_typing: { handler: 'setTypingIndicator', handlerArgs: [false], description: 'Stop typing' }\n        },\n        globalEvents: {},\n        messageTypes: {\n          user: { icon: '\uD83D\uDC64', className: 'user-message', showAvatar: true, allowEdit: true },\n          assistant: { icon: '\uD83E\uDD16', className: 'assistant-message', showAvatar: true, allowEdit: false },\n          system: { icon: '\u2139\uFE0F', className: 'system-message', showAvatar: false, allowEdit: false }\n        },\n        messageStatuses: {\n          sending: { icon: '\u23F3', className: 'status-sending', description: 'Sending...' },\n          sent: { icon: '\u2713', className: 'status-sent', description: 'Sent' },\n          error: { icon: '\u274C', className: 'status-error', description: 'Failed' }\n        }\n      };\n    }\n  }\n\n  private async initializeChat(): Promise<void> {\n    const roomInfo = this.currentRoom ? `${this.currentRoom.name} (${this.currentRoom.type})` : 'unknown room';\n    console.log(`\uD83D\uDCAC Chat: Initializing chat for room: ${roomInfo}`);\n    \n    // Load history in background - don't block initialization\n    this.loadRoomHistory().catch(error => {\n      console.warn(`\uD83D\uDCAC Chat: History loading failed (non-blocking):`, error);\n    });\n    \n    if (this.messages.length === 0 && this.currentRoom) {\n      // Use proper welcome message from room type config\n      const welcomeMessage = roomDataManager.getWelcomeMessage(this.currentRoom.type);\n      \n      this.addMessage({\n        id: this.generateMessageId(),\n        type: 'system',\n        content: welcomeMessage,\n        timestamp: new Date()\n      });\n    }\n    \n    this.render();\n    this.focusInput();\n  }\n\n  private async loadRoomHistory(): Promise<void> {\n    if (this.isLoadingHistory || !this.isContinuumConnected()) {\n      return;\n    }\n\n    try {\n      this.isLoadingHistory = true;\n      const response = await this.executeCommand('chat_history', {\n        roomId: this.currentRoom?.id,\n        limit: 50\n      });\n\n      if (response?.messages) {\n        this.messages = response.messages.map((msg: any) => ({\n          id: msg.id || this.generateMessageId(),\n          type: msg.type || 'assistant',\n          content: msg.content || '',\n          timestamp: new Date(msg.timestamp || Date.now()),\n          metadata: {\n            agent: msg.agent,\n            persona: msg.persona\n          }\n        }));\n      }\n    } catch (error) {\n      console.error(`\uD83D\uDCAC Chat: Failed to load history:`, error);\n    } finally {\n      this.isLoadingHistory = false;\n    }\n  }\n\n  private setupContinuumListeners(): void {\n    if (!this.getContinuumAPI()) {\n      // Listen for API ready event instead of polling\n      window.addEventListener('continuum:ready', () => {\n        this.setupContinuumListeners();\n      }, { once: true });\n      return;\n    }\n\n    if (!this.chatEventsConfig) {\n      console.warn('\uD83D\uDCAC Chat: No chat events config available, skipping event setup');\n      return;\n    }\n\n    // Setup chat events from JSON configuration\n    for (const [eventName, eventConfig] of Object.entries(this.chatEventsConfig.chatEvents)) {\n      this.notifySystem(eventName, (data: any) => {\n        // Check if event requires current room matching\n        if (eventConfig.requiresCurrentRoom && eventConfig.matchField) {\n          const fieldValue = data[eventConfig.matchField];\n          if (fieldValue !== this.currentRoom?.id) {\n            return; // Event not for current room\n          }\n        }\n\n        // Call the handler method\n        this.callEventHandler(eventConfig.handler, data, eventConfig.handlerArgs);\n      });\n    }\n\n    // Setup global events from JSON configuration\n    for (const [eventName, eventConfig] of Object.entries(this.chatEventsConfig.globalEvents)) {\n      const listenerOptions = eventConfig.once ? { once: true } : {};\n      \n      document.addEventListener(eventName, (e: Event) => {\n        let data = e;\n        \n        // Extract data from specified path if configured\n        if (eventConfig.dataPath) {\n          const pathParts = eventConfig.dataPath.split('.');\n          let current: any = e;\n          for (const part of pathParts) {\n            current = current?.[part];\n          }\n          data = current;\n        }\n        \n        this.callEventHandler(eventConfig.handler, data);\n      }, listenerOptions);\n    }\n  }\n\n  private callEventHandler(handlerName: string, data: any, handlerArgs?: any[]): void {\n    try {\n      const handler = (this as any)[handlerName];\n      if (typeof handler === 'function') {\n        if (handlerArgs) {\n          handler.call(this, ...handlerArgs);\n        } else {\n          handler.call(this, data);\n        }\n      } else {\n        console.warn(`\uD83D\uDCAC Chat: Handler '${handlerName}' not found`);\n      }\n    } catch (error) {\n      console.error(`\uD83D\uDCAC Chat: Error calling handler '${handlerName}':`, error);\n    }\n  }\n\n  private setupRoomDataListeners(): void {\n    // Listen to centralized room data manager\n    roomDataManager.addEventListener('room-changed', (e: Event) => {\n      const customEvent = e as CustomEvent<RoomChangeEvent>;\n      const { currentRoom } = customEvent.detail;\n      this.handleRoomChange(currentRoom);\n    });\n\n    roomDataManager.addEventListener('current-room-updated', (e: Event) => {\n      const customEvent = e as CustomEvent<RoomData>;\n      const updatedRoom = customEvent.detail;\n      \n      // Update our current room if it's the same room\n      if (this.currentRoom?.id === updatedRoom.id) {\n        this.currentRoom = updatedRoom;\n        this.updateRoomDisplay();\n      }\n    });\n  }\n\n  private handleRoomChange(newRoom: RoomData): void {\n    console.log(`\uD83D\uDCAC Chat: Room changed to ${newRoom.name} (${newRoom.type})`);\n    this.currentRoom = newRoom;\n    this.messages = [];\n    \n    // Add welcome message for new room\n    const welcomeMessage = roomDataManager.getWelcomeMessage(newRoom.type);\n    this.addMessage({\n      id: this.generateMessageId(),\n      type: 'system',\n      content: welcomeMessage,\n      timestamp: new Date()\n    });\n    \n    this.loadRoomHistory().catch(error => {\n      console.warn(`\uD83D\uDCAC Chat: Failed to load history for room ${newRoom.name}:`, error);\n    });\n    \n    this.render();\n  }\n\n  private updateRoomDisplay(): void {\n    // Update any UI elements that show room info\n    const roomTitle = this.shadowRoot?.querySelector('.room-title');\n    if (roomTitle && this.currentRoom) {\n      roomTitle.textContent = this.currentRoom.name;\n    }\n    \n    // Update widget title to include room name\n    if (this.currentRoom) {\n      this.widgetTitle = `\uD83D\uDCAC ${this.currentRoom.name}`;\n    }\n  }\n\n  public async switchRoom(roomId: string): Promise<void> {\n    if (this.currentRoom?.id === roomId) return;\n\n    console.log(`\uD83D\uDCAC Chat: Switching to room ${roomId}`);\n    \n    // Use room data manager to switch rooms\n    const success = roomDataManager.setCurrentRoom(roomId);\n    if (!success) {\n      console.warn(`\uD83D\uDCAC Chat: Failed to switch to room ${roomId} - room not found`);\n      return;\n    }\n    \n    // Room change will be handled by handleRoomChange() via event listener\n    this.render();\n  }\n\n  renderContent(): string {\n    return `\n      <div class=\"chat-container\">\n        <!-- Chat Header -->\n        <div class=\"chat-header\">\n          <div class=\"header-left\">\n            <div class=\"chat-icon\">\uD83D\uDCAC</div>\n            <div class=\"header-info\">\n              <div class=\"chat-title\">${this.getRoomDisplayName()}</div>\n              <div class=\"chat-subtitle\">${this.getRoomDescription()} \u2022 Connected</div>\n            </div>\n          </div>\n          <div class=\"header-right\">\n            <div class=\"version-info\">\n              <div class=\"version\" id=\"continuum-version\">v${this.getVersion()}</div>\n              <div class=\"timestamp\">Updated ${new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}</div>\n            </div>\n          </div>\n        </div>\n        \n        <!-- Connected Users -->\n        <div class=\"connected-bar\">\n          <span class=\"connected-label\">CONNECTED:</span>\n          <div class=\"connected-users\">\n            ${this.renderSimpleConnectedUsers()}\n          </div>\n        </div>\n        \n        <div class=\"messages\" id=\"messages\">\n          ${this.messages.length === 0 ? this.renderWelcome() : this.messages.map(msg => this.renderMessage(msg)).join('')}\n          ${this.isTyping ? this.renderTypingIndicator() : ''}\n        </div>\n        \n        <div class=\"input-area\">\n          <div class=\"input-container\">\n            <textarea \n              id=\"messageInput\" \n              class=\"input-field\" \n              placeholder=\"Type your message...\" \n              rows=\"1\"\n            ></textarea>\n            <button class=\"send-button\" id=\"sendButton\" title=\"Send message\">\n              <span class=\"send-icon\">\u27A4</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private renderWelcome(): string {\n    return `\n      <div class=\"welcome-message\">\n        <div class=\"welcome-title\">Welcome to Continuum</div>\n        <div class=\"welcome-subtitle\">Your AI collaboration platform</div>\n        <div class=\"quick-actions\">\n          <div class=\"quick-action\" data-action=\"help\">Help</div>\n          <div class=\"quick-action\" data-action=\"status\">System Status</div>\n          <div class=\"quick-action\" data-action=\"screenshot\">Take Screenshot</div>\n        </div>\n      </div>\n    `;\n  }\n\n  private renderMessage(message: Message): string {\n    const timeStr = message.timestamp.toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n    \n    const statusIcon = this.getStatusIcon(message.status);\n    const agentName = message.metadata?.agent || message.metadata?.persona || 'System';\n\n    return `\n      <div class=\"message ${message.type}\" data-message-id=\"${message.id}\">\n        <div class=\"message-content\">${this.formatMessageContent(message.content)}</div>\n        <div class=\"message-meta\">\n          ${message.type === 'assistant' ? `<span class=\"agent-name\">${agentName}</span>` : ''}\n          <span class=\"message-time\">${timeStr}</span>\n          ${message.status ? `<span class=\"message-status status-${message.status}\">${statusIcon}</span>` : ''}\n        </div>\n      </div>\n    `;\n  }\n\n  private renderTypingIndicator(): string {\n    return `\n      <div class=\"message assistant\">\n        <div class=\"typing-indicator\">\n          <span>AI is thinking</span>\n          <div class=\"typing-dots\">\n            <div class=\"typing-dot\"></div>\n            <div class=\"typing-dot\"></div>\n            <div class=\"typing-dot\"></div>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private formatMessageContent(content: string): string {\n    return content\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/`(.*?)`/g, '<code>$1</code>')\n      .replace(/\\n/g, '<br>');\n  }\n\n  private getStatusIcon(status?: string): string {\n    switch (status) {\n      case 'sending': return '\u23F3';\n      case 'sent': return '\u2713';\n      case 'error': return '\u274C';\n      default: return '';\n    }\n  }\n\n  setupEventListeners(): void {\n    const input = this.shadowRoot?.querySelector('#messageInput') as HTMLTextAreaElement;\n    const sendButton = this.shadowRoot?.querySelector('#sendButton') as HTMLButtonElement;\n\n    if (input && sendButton) {\n      input.addEventListener('input', () => {\n        this.autoResizeTextarea(input);\n      });\n\n      input.addEventListener('keydown', (e: KeyboardEvent) => {\n        if (e.key === 'Enter' && !e.shiftKey) {\n          e.preventDefault();\n          this.sendChatMessage();\n        }\n      });\n\n      sendButton.addEventListener('click', () => {\n        this.sendChatMessage();\n      });\n    }\n\n    this.shadowRoot?.querySelectorAll('.quick-action').forEach(action => {\n      action.addEventListener('click', (e: Event) => {\n        const target = e.currentTarget as HTMLElement;\n        const actionType = target.dataset.action;\n        if (actionType) {\n          this.handleQuickAction(actionType);\n        }\n      });\n    });\n\n    // Simple connected users - no action buttons needed in chat header\n    // Full user management with action buttons is handled by UserSelector in sidebar\n  }\n\n  private autoResizeTextarea(textarea: HTMLTextAreaElement): void {\n    textarea.style.height = 'auto';\n    textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';\n  }\n\n  private async sendChatMessage(): Promise<void> {\n    const input = this.shadowRoot?.querySelector('#messageInput') as HTMLTextAreaElement;\n    const sendButton = this.shadowRoot?.querySelector('#sendButton') as HTMLButtonElement;\n    \n    if (!input || !sendButton) return;\n\n    const content = input.value.trim();\n    if (!content) return;\n\n    input.value = '';\n    input.style.height = 'auto';\n    sendButton.disabled = true;\n\n    const userMessage: Message = {\n      id: this.generateMessageId(),\n      type: 'user',\n      content,\n      timestamp: new Date(),\n      status: 'sending'\n    };\n\n    this.addMessage(userMessage);\n\n    try {\n      await this.executeCommand('chat', {\n        message: content,\n        roomId: this.currentRoom?.id,\n        timestamp: userMessage.timestamp.toISOString()\n      });\n\n      this.updateMessageStatus(userMessage.id, 'sent');\n    } catch (error) {\n      console.error('\uD83D\uDCAC Chat: Failed to send message:', error);\n      this.updateMessageStatus(userMessage.id, 'error');\n      \n      this.addMessage({\n        id: this.generateMessageId(),\n        type: 'system',\n        content: 'Failed to send message. Please try again.',\n        timestamp: new Date()\n      });\n    } finally {\n      sendButton.disabled = false;\n      input.focus();\n    }\n  }\n\n  public handleIncomingMessage(data: any): void {\n    const message: Message = {\n      id: this.generateMessageId(),\n      type: 'assistant',\n      content: data.content || data.message || 'No response received',\n      timestamp: new Date(data.timestamp || Date.now()),\n      metadata: {\n        agent: data.agent,\n        persona: data.persona\n      }\n    };\n\n    this.addMessage(message);\n    this.setTypingIndicator(false);\n  }\n\n  private handleQuickAction(action: string): void {\n    if (action === 'screenshot') {\n      // Server control event - like onclick but triggers server-side action\n      this.triggerScreenshot({ includeContext: true });\n      return;\n    }\n\n    const quickMessages: Record<string, string> = {\n      help: 'Help me understand how to use Continuum',\n      status: 'Show me the system status',\n      screenshot: 'Take a screenshot of the current interface'\n    };\n\n    const input = this.shadowRoot?.querySelector('#messageInput') as HTMLTextAreaElement;\n    if (input && quickMessages[action]) {\n      input.value = quickMessages[action];\n      input.focus();\n      this.autoResizeTextarea(input);\n    }\n  }\n\n  /**\n   * Setup Universal User System - all users have same interface & privileges\n   */\n  private setupUniversalUserSystem(): void {\n    // TODO: Add AI model initialization when universalUserSystem supports it\n    console.log(`\uD83D\uDCAC Chat: Universal user system ready`);\n    \n    // Listen for user updates to refresh UI\n    universalUserSystem.on('user:updated', () => {\n      this.render(); // Refresh connected users display\n    });\n\n    // Handle user clicks (personas, AI models, etc.)\n    universalUserSystem.on('persona:interaction-requested', (data: any) => {\n      this.startConversationWithUser(data.personaId, data.personaName, 'persona');\n    });\n\n    universalUserSystem.on('ai-model:conversation-requested', (data: any) => {\n      this.startConversationWithUser(data.modelId, data.modelName, 'ai-model');\n    });\n  }\n\n  /**\n   * Start conversation with any user type - same interface for all\n   */\n  private async startConversationWithUser(userId: string, userName: string, _userType: string): Promise<void> {\n    this.addMessage({\n      id: this.generateMessageId(),\n      type: 'system',\n      content: `\uD83D\uDCAC Starting direct conversation with ${userName}. They have the same privileges and command access as everyone else.`,\n      timestamp: new Date()\n    });\n\n    // Set chat focus to this specific user\n    this.setConversationFocus(userId, userName);\n  }\n\n  /**\n   * Set conversation focus to specific user\n   */\n  private setConversationFocus(userId: string, userName: string): void {\n    // Update UI to show we're in focused conversation\n    const input = this.shadowRoot?.querySelector('#messageInput') as HTMLTextAreaElement;\n    if (input) {\n      input.placeholder = `Message ${userName} directly...`;\n      input.dataset.focusedUser = userId;\n    }\n\n    this.addMessage({\n      id: this.generateMessageId(),\n      type: 'system',\n      content: `\uD83C\uDFAF Conversation focused on ${userName}. Your messages will go directly to them. They can use all commands like screenshot, validate, export, etc.`,\n      timestamp: new Date()\n    });\n  }\n\n  /**\n   * Setup server control event listeners - handle callbacks from server\n   */\n  private setupServerControlListeners(): void {\n    // Listen for screenshot completion\n    this.addEventListener('widget:screenshot-complete', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      const { success, result, error } = customEvent.detail;\n      \n      if (success) {\n        this.addMessage({\n          id: this.generateMessageId(),\n          type: 'system',\n          content: `\uD83D\uDCF8 Screenshot captured: ${result.filename || 'screenshot.png'}`,\n          timestamp: new Date()\n        });\n      } else {\n        this.addMessage({\n          id: this.generateMessageId(),\n          type: 'system',\n          content: `\u274C Screenshot failed: ${error}`,\n          timestamp: new Date()\n        });\n      }\n    });\n\n    // Listen for refresh completion\n    this.addEventListener('widget:refresh-complete', (event: Event) => {\n      const customEvent = event as CustomEvent;\n      const { success, error } = customEvent.detail;\n      \n      if (success) {\n        console.log('\u2705 ChatWidget refreshed successfully');\n      } else {\n        console.error('\u274C ChatWidget refresh failed:', error);\n      }\n    });\n  }\n\n  private addMessage(message: Message): void {\n    this.messages.push(message);\n    this.render();\n    this.scrollToBottom();\n  }\n\n  private updateMessageStatus(messageId: string, status: string): void {\n    const message = this.messages.find(msg => msg.id === messageId);\n    if (message) {\n      message.status = status as any;\n      this.render();\n    }\n  }\n\n  private setTypingIndicator(isTyping: boolean): void {\n    if (this.isTyping !== isTyping) {\n      this.isTyping = isTyping;\n      this.render();\n      if (isTyping) {\n        this.scrollToBottom();\n      }\n    }\n  }\n\n  private scrollToBottom(): void {\n    setTimeout(() => {\n      const container = this.shadowRoot?.querySelector('.messages');\n      if (container) {\n        container.scrollTop = container.scrollHeight;\n      }\n    }, 0);\n  }\n\n  private generateMessageId(): string {\n    return `msg_${this.messageIdCounter++}_${Date.now()}`;\n  }\n\n  private getRoomDisplayName(): string {\n    // Use proper room name from room data manager\n    if (this.currentRoom) {\n      return this.currentRoom.name;\n    }\n    \n    // Fallback for no room data\n    return 'Chat';\n  }\n\n  private getRoomDescription(): string {\n    // Use proper room description from room data manager\n    if (this.currentRoom) {\n      return this.currentRoom.description;\n    }\n    \n    // Fallback for no room data\n    return 'Chat room';\n  }\n\n  private focusInput(): void {\n    setTimeout(() => {\n      const input = this.shadowRoot?.querySelector('#messageInput') as HTMLTextAreaElement;\n      if (input) {\n        input.focus();\n      }\n    }, 100);\n  }\n\n  private getVersion(): string {\n    try {\n      // Get version from continuum API if available\n      const continuum = (window as any).continuum;\n      if (continuum && continuum.version) {\n        return continuum.version;\n      }\n      \n      // Fallback to global version variable\n      const serverVersion = (window as any).__CONTINUUM_VERSION__;\n      if (serverVersion) return serverVersion;\n      \n      return 'unknown';\n    } catch (error) {\n      return 'unknown';\n    }\n  }\n\n  private renderSimpleConnectedUsers(): string {\n    // Simple connected user list for chat header - no action buttons\n    const users = universalUserSystem.getAllUsers();\n    const onlineUsers = users.filter(user => user.status === 'online');\n    \n    return onlineUsers.map(user => `\n      <span class=\"simple-user-badge\" title=\"${user.name}\">\n        <span class=\"user-avatar\">${user.avatar}</span>\n        <span class=\"user-name\">${user.name}</span>\n      </span>\n    `).join('');\n  }\n}\n\n// Register the custom element\n// Prevent duplicate widget registration\nif (!customElements.get('chat-widget')) {\n    customElements.define('chat-widget', ChatWidget);\n}", "/**\n * ChatRoom - TypeScript Component for Room Management\n * Manages room state, title, and delegates to ChatWidget for messages\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\n\ninterface Room {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  type: 'general' | 'academy' | 'project';\n  participants: Participant[];\n}\n\ninterface Participant {\n  id: string;\n  name: string;\n  type: 'human' | 'ai' | 'agent';\n  status: 'online' | 'offline' | 'away';\n  avatar?: string;\n}\n\nexport class ChatRoom extends BaseWidget {\n  private currentRoom: Room;\n  private availableRooms: Room[] = [\n    {\n      id: 'general',\n      name: 'General Chat',\n      description: 'Smart agent routing with Protocol Sheriff validation',\n      icon: '\uD83D\uDCAC',\n      type: 'general',\n      participants: [\n        { id: 'you', name: 'YOU', type: 'human', status: 'online' },\n        { id: 'claude-code', name: 'Claude Code', type: 'ai', status: 'online', avatar: '\uD83E\uDD16' },\n        { id: 'auto-route', name: 'Auto Route', type: 'agent', status: 'online', avatar: '\uD83C\uDFAF' },\n        { id: 'protocol-sheriff', name: 'Protocol Sheriff', type: 'agent', status: 'online', avatar: '\uD83D\uDEE1\uFE0F' }\n      ]\n    },\n    {\n      id: 'academy',\n      name: 'Academy Training',\n      description: 'AI training and persona development',\n      icon: '\uD83C\uDF93',\n      type: 'academy',\n      participants: [\n        { id: 'you', name: 'YOU', type: 'human', status: 'online' },\n        { id: 'testing-droid', name: 'TestingDroid', type: 'agent', status: 'online', avatar: '\uD83E\uDD16' },\n        { id: 'protocol-sheriff', name: 'Protocol Sheriff', type: 'agent', status: 'online', avatar: '\uD83D\uDEE1\uFE0F' },\n        { id: 'code-specialist', name: 'Code Specialist', type: 'agent', status: 'online', avatar: '\uD83D\uDCBB' }\n      ]\n    }\n  ];\n\n  constructor() {\n    super();\n    this.widgetName = 'ChatRoom';\n    this.widgetIcon = '\uD83C\uDFE0';\n    this.widgetTitle = 'Chat Room';\n    this.currentRoom = this.availableRooms[0]; // Default to general\n  }\n\n  protected async initializeWidget(): Promise<void> {\n    this.setupRoomEventListeners();\n    this.render();\n    console.log(`\uD83C\uDFE0 ChatRoom: Initialized with room ${this.currentRoom.name}`);\n  }\n\n  private setupRoomEventListeners(): void {\n    // Listen for room switch requests\n    document.addEventListener('continuum:switch-room', (e: Event) => {\n      const customEvent = e as CustomEvent;\n      this.switchToRoom(customEvent.detail.roomId);\n    });\n  }\n\n  public switchToRoom(roomId: string): void {\n    const newRoom = this.availableRooms.find(room => room.id === roomId);\n    if (!newRoom || newRoom.id === this.currentRoom.id) {\n      return;\n    }\n\n    console.log(`\uD83C\uDFE0 ChatRoom: Switching from ${this.currentRoom.name} to ${newRoom.name}`);\n    this.currentRoom = newRoom;\n    this.render();\n    this.notifyRoomChange();\n  }\n\n  private notifyRoomChange(): void {\n    // Notify other components about room change\n    const event = new CustomEvent('continuum:room-changed', {\n      detail: {\n        room: this.currentRoom\n      },\n      bubbles: true\n    });\n    document.dispatchEvent(event);\n  }\n\n  public getCurrentRoom(): Room {\n    return this.currentRoom;\n  }\n\n  renderContent(): string {\n    const participantsList = this.currentRoom.participants\n      .map(p => `\n        <div class=\"participant ${p.status}\" title=\"${p.name} (${p.type})\">\n          <span class=\"participant-avatar\">${p.avatar || this.getDefaultAvatar(p.type)}</span>\n          <span class=\"participant-name\">${p.name}</span>\n          <span class=\"participant-status-dot\"></span>\n        </div>\n      `).join('');\n\n    return `\n      <div class=\"chat-room\">\n        <div class=\"room-header\">\n          <div class=\"room-title-section\">\n            <span class=\"room-icon\">${this.currentRoom.icon}</span>\n            <div class=\"room-info\">\n              <h2 class=\"room-title\">${this.currentRoom.name}</h2>\n              <p class=\"room-description\">${this.currentRoom.description} \u2022 Connected</p>\n            </div>\n          </div>\n          <div class=\"room-participants\">\n            <div class=\"participants-label\">Connected:</div>\n            <div class=\"participants-list\">\n              ${participantsList}\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"room-content\">\n          <chat-widget room=\"${this.currentRoom.id}\"></chat-widget>\n        </div>\n      </div>\n    `;\n  }\n\n  private getDefaultAvatar(type: 'human' | 'ai' | 'agent'): string {\n    switch (type) {\n      case 'human': return '\uD83D\uDC64';\n      case 'ai': return '\uD83E\uDD16';\n      case 'agent': return '\uD83D\uDD39';\n      default: return '\u2753';\n    }\n  }\n\n  async loadCSS(): Promise<string> {\n    return `\n      :host {\n        display: flex;\n        flex-direction: column;\n        height: 100%;\n        background: rgba(15, 20, 25, 0.95);\n      }\n\n      .chat-room {\n        display: flex;\n        flex-direction: column;\n        height: 100%;\n      }\n\n      .room-header {\n        padding: 20px;\n        border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n        flex-shrink: 0;\n        background: rgba(15, 20, 25, 0.98);\n      }\n\n      .room-title-section {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n      }\n\n      .room-icon {\n        font-size: 24px;\n        width: 40px;\n        height: 40px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background: rgba(255, 255, 255, 0.1);\n        border-radius: 8px;\n        border: 1px solid rgba(255, 255, 255, 0.2);\n      }\n\n      .room-info {\n        flex: 1;\n      }\n\n      .room-title {\n        margin: 0;\n        font-size: 24px;\n        font-weight: 600;\n        color: #e0e6ed;\n        line-height: 1.2;\n      }\n\n      .room-description {\n        margin: 4px 0 0 0;\n        font-size: 14px;\n        color: #8a92a5;\n        opacity: 0.8;\n      }\n\n      .room-participants {\n        margin-top: 12px;\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n      }\n\n      .participants-label {\n        font-size: 12px;\n        color: #8a92a5;\n        font-weight: 500;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n      }\n\n      .participants-list {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 8px;\n      }\n\n      .participant {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding: 4px 8px;\n        background: rgba(255, 255, 255, 0.05);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 16px;\n        font-size: 12px;\n        position: relative;\n        transition: all 0.2s ease;\n      }\n\n      .participant:hover {\n        background: rgba(255, 255, 255, 0.08);\n        border-color: rgba(79, 195, 247, 0.3);\n      }\n\n      .participant-avatar {\n        font-size: 14px;\n        line-height: 1;\n      }\n\n      .participant-name {\n        color: #e0e6ed;\n        font-weight: 500;\n        white-space: nowrap;\n      }\n\n      .participant-status-dot {\n        width: 6px;\n        height: 6px;\n        border-radius: 50%;\n        background: #4ade80;\n        flex-shrink: 0;\n      }\n\n      .participant.offline .participant-status-dot {\n        background: #6b7280;\n      }\n\n      .participant.away .participant-status-dot {\n        background: #fbbf24;\n      }\n\n      .room-content {\n        flex: 1;\n        overflow: hidden;\n        display: flex;\n        flex-direction: column;\n      }\n\n      chat-widget {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n      }\n    `;\n  }\n\n  setupEventListeners(): void {\n    // Room-specific event handling can go here\n  }\n}\n\n// Register the custom element\ncustomElements.define('chat-room', ChatRoom);", "/**\n * ContinuonWidget - HAL 9000-style status orb with scrolling status feed\n * Shows system health, emotions, and live status updates\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\n\ninterface StatusMessage {\n  text: string;\n  timestamp: number;\n  id: string;\n}\n\nexport class ContinuonWidget extends BaseWidget {\n\n  private currentStatus: 'red' | 'yellow' | 'green' = 'red';\n  private currentEmotion: string | null = null;\n  private statusFeed: StatusMessage[] = [];\n  private maxStatusMessages: number = 5;\n\n  constructor() {\n    super();\n    this.widgetName = 'ContinuonWidget';\n    this.widgetIcon = '\uD83D\uDD2E';\n    this.widgetTitle = 'System Status Orb';\n  }\n\n  protected async initializeWidget(): Promise<void> {\n    await this.loadCSS();\n    this.setupEventListeners();\n    this.setupStatusFeed();\n    \n    // Log version on startup\n    const version = this.getSystemVersion();\n    console.log(`\uD83D\uDE80 Continuum v${version} - ContinuonWidget initialized`);\n    \n    // Initial status\n    this.addStatusMessage('System initializing...');\n    this.updateStatus('yellow', 'Starting up...');\n    this.render();\n    \n    // Set to green after a brief delay\n    setTimeout(() => {\n      this.updateStatus('green', 'System ready');\n    }, 2000);\n  }\n\n  setupEventListeners(): void {\n    // Listen for status changes\n    document.addEventListener('continuum:status-change', (e: Event) => {\n      const customEvent = e as CustomEvent;\n      this.updateStatus(customEvent.detail.status, customEvent.detail.message);\n    });\n\n    // Listen for emotions\n    document.addEventListener('continuum:emotion', (e: Event) => {\n      const customEvent = e as CustomEvent;\n      this.showEmotion(customEvent.detail.emotion, customEvent.detail.duration || 3000);\n    });\n\n    // Listen for system events\n    document.addEventListener('continuum:system-event', (e: Event) => {\n      const customEvent = e as CustomEvent;\n      this.addStatusMessage(customEvent.detail.message);\n    });\n\n    // Setup orb interactions\n    this.setupOrbEventListeners();\n  }\n\n  renderContent(): string {\n    const orbContent = this.currentEmotion || '';\n    const statusColor = this.getStatusColor();\n    \n    return `\n      <div class=\"continuon-container\">\n        <div class=\"continuon-orb-container\">\n          <div class=\"continuon-orb ${statusColor}\" data-emotion=\"${this.currentEmotion || ''}\">\n            <div class=\"orb-ring\"></div>\n            <div class=\"orb-center\">\n              <span class=\"orb-emotion\">${orbContent}</span>\n            </div>\n            <div class=\"orb-glow\"></div>\n          </div>\n          <span class=\"continuon-label\">continuum</span>\n        </div>\n        \n        <div class=\"status-feed\">\n          <div class=\"status-messages\">\n            ${this.renderStatusMessages()}\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private renderStatusMessages(): string {\n    return this.statusFeed\n      .slice(-this.maxStatusMessages)\n      .map((msg, index) => `\n        <div class=\"status-message fade-${index}\" \n             style=\"animation-delay: ${index * 0.1}s\">\n          ${msg.text}\n        </div>\n      `).join('');\n  }\n\n  private updateStatus(status: 'red' | 'yellow' | 'green', message?: string): void {\n    if (this.currentStatus !== status) {\n      this.currentStatus = status;\n      \n      if (message) {\n        this.addStatusMessage(message);\n      }\n      \n      // Update title and favicon\n      this.updateTitleAndFavicon();\n      \n      this.render();\n      \n      // Log version only on status changes\n      this.logVersionIfChanged();\n    }\n  }\n\n  private showEmotion(emotion: string, duration: number): void {\n    this.currentEmotion = emotion;\n    \n    // Update favicon to show emotion\n    this.updateTitleAndFavicon();\n    \n    this.render();\n    \n    // Clear emotion after duration\n    setTimeout(() => {\n      this.currentEmotion = null;\n      this.updateTitleAndFavicon(); // Restore status color\n      this.render();\n    }, duration);\n  }\n\n  private addStatusMessage(text: string): void {\n    const message: StatusMessage = {\n      text,\n      timestamp: Date.now(),\n      id: Math.random().toString(36).substr(2, 9)\n    };\n    \n    this.statusFeed.push(message);\n    \n    // Keep only recent messages\n    if (this.statusFeed.length > this.maxStatusMessages * 2) {\n      this.statusFeed = this.statusFeed.slice(-this.maxStatusMessages);\n    }\n    \n    this.render();\n  }\n\n  private getStatusColor(): string {\n    switch (this.currentStatus) {\n      case 'green': return 'status-healthy';\n      case 'yellow': return 'status-degraded';\n      case 'red': return 'status-error';\n      default: return 'status-error';\n    }\n  }\n\n  private logVersionIfChanged(): void {\n    // Only log version when status changes (not spam)\n    const version = this.getSystemVersion();\n    const lastVersion = localStorage.getItem('continuum-last-version');\n    \n    if (version && version !== lastVersion) {\n      console.log(`\uD83D\uDE80 Continuum ${lastVersion ? `${lastVersion} \u2192 ${version}` : `v${version}`}`);\n      localStorage.setItem('continuum-last-version', version);\n    }\n  }\n\n  private getSystemVersion(): string | null {\n    // Get version from continuum API or DOM\n    const continuum = (window as any).continuum;\n    return continuum?.version || '0.2.2177';\n  }\n\n  private setupStatusFeed(): void {\n    // Connect to WebSocket events for live status updates\n    const continuum = (window as any).continuum;\n    if (continuum) {\n      // Listen for connection events\n      continuum.on('connected', () => {\n        this.updateStatus('green', 'Connected');\n      });\n      \n      continuum.on('disconnected', () => {\n        this.updateStatus('red', 'Disconnected');\n      });\n      \n      continuum.on('reconnecting', () => {\n        this.updateStatus('yellow', 'Reconnecting...');\n      });\n    }\n  }\n\n  private updateTitleAndFavicon(): void {\n    const displayIcon = this.currentEmotion || this.getStatusIcon();\n    \n    // Update favicon\n    this.updateFavicon(displayIcon);\n    \n    // Update title (keep it simple)\n    document.title = 'continuum';\n  }\n\n  private getStatusIcon(): string {\n    switch (this.currentStatus) {\n      case 'green': return '\uD83D\uDFE2';\n      case 'yellow': return '\uD83D\uDFE1';\n      case 'red': return '\uD83D\uDD34';\n      default: return '\uD83D\uDD34';\n    }\n  }\n\n  private updateFavicon(icon: string): void {\n    const favicon = document.getElementById('favicon') as HTMLLinkElement;\n    if (favicon) {\n      const svg = `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>${icon}</text></svg>`;\n      favicon.href = `data:image/svg+xml,${encodeURIComponent(svg)}`;\n    }\n  }\n\n  private setupOrbEventListeners(): void {\n    // Orb click interactions\n    const orb = this.shadowRoot?.querySelector('.continuon-orb');\n    if (orb) {\n      orb.addEventListener('click', () => {\n        this.triggerEmotionDemo();\n      });\n    }\n  }\n\n  private triggerEmotionDemo(): void {\n    const emotions = ['\uD83D\uDE09', '\uD83C\uDF89', '\uD83D\uDE80', '\uD83D\uDCAB', '\u2728'];\n    const randomEmotion = emotions[Math.floor(Math.random() * emotions.length)];\n    this.showEmotion(randomEmotion, 2000);\n  }\n}\n\n// Register the widget\ncustomElements.define('continuon-widget', ContinuonWidget);", "/**\n * Persona Widget - Individual AI Persona Component\n * Represents a single AI persona with its capabilities and status\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\n\ninterface PersonaConfig {\n  id: string;\n  name: string;\n  specialization: string;\n  status: 'active' | 'training' | 'graduated' | 'offline';\n  avatar: string;\n  accuracy?: number;\n  description: string;\n  capabilities: string[];\n  lastActive?: Date;\n}\n\nexport class PersonaWidget extends BaseWidget {\n\n  private config: PersonaConfig | null = null;\n  private isInteracting: boolean = false;\n\n  constructor() {\n    super();\n    this.widgetName = 'Persona';\n    this.widgetIcon = '\uD83E\uDD16';\n    this.widgetTitle = 'AI Persona';\n  }\n\n  // Public method to configure the persona\n  public setPersona(config: PersonaConfig): void {\n    this.config = config;\n    this.widgetTitle = config.name;\n    this.render();\n  }\n\n\n  renderContent(): string {\n    if (!this.config) {\n      return `\n        <div class=\"persona-header\">\n          <div class=\"persona-avatar\">\u2753</div>\n          <div class=\"persona-info\">\n            <div class=\"persona-name\">No Persona Configured</div>\n          </div>\n        </div>\n        <div class=\"persona-description\">\n          Use setPersona() to configure this component.\n        </div>\n      `;\n    }\n\n    const lastActiveStr = this.config.lastActive \n      ? this.config.lastActive.toLocaleDateString()\n      : 'Never';\n\n    return `\n      ${this.isInteracting ? '<div class=\"interaction-indicator\"></div>' : ''}\n      \n      <div class=\"persona-header\">\n        <div class=\"persona-avatar\">${this.config.avatar}</div>\n        <div class=\"persona-info\">\n          <div class=\"persona-name\">${this.config.name}</div>\n          <div class=\"persona-status status-${this.config.status}\">${this.config.status}</div>\n        </div>\n      </div>\n\n      <div class=\"persona-specialization\">${this.config.specialization}</div>\n      \n      <div class=\"persona-description\">${this.config.description}</div>\n\n      <div class=\"persona-capabilities\">\n        ${this.config.capabilities.map(cap => `<span class=\"capability-tag\">${cap}</span>`).join('')}\n      </div>\n\n      <div class=\"persona-metrics\">\n        ${this.config.accuracy ? `<span class=\"accuracy\">${this.config.accuracy}% accuracy</span>` : '<span></span>'}\n        <span class=\"last-active\">Last: ${lastActiveStr}</span>\n      </div>\n    `;\n  }\n\n  setupEventListeners(): void {\n    this.addEventListener('click', () => {\n      if (this.config) {\n        console.log(`\uD83E\uDD16 Persona: Clicked on ${this.config.name}`);\n        this.handlePersonaClick();\n      }\n    });\n  }\n\n  private handlePersonaClick(): void {\n    if (!this.config) return;\n\n    // Send persona selection event\n    this.sendMessage({\n      type: 'persona_selected',\n      personaId: this.config.id,\n      persona: this.config\n    });\n\n    // Show interaction indicator\n    this.setInteracting(true);\n    setTimeout(() => this.setInteracting(false), 2000);\n  }\n\n  public setInteracting(isInteracting: boolean): void {\n    if (this.isInteracting !== isInteracting) {\n      this.isInteracting = isInteracting;\n      this.render();\n    }\n  }\n\n  // Static method to create persona from data\n  static create(config: PersonaConfig): PersonaWidget {\n    const widget = new PersonaWidget();\n    widget.setPersona(config);\n    return widget;\n  }\n}\n\n// Register the custom element - only register once per constructor\nif (!customElements.get('persona-widget')) {\n  customElements.define('persona-widget', PersonaWidget);\n  console.log('\u2705 PersonaWidget: Registered as persona-widget');\n}", "/**\n * Widget Server Integration Types - Strong typing for widget \u2194 server communication\n * Shared between browser widgets and server-side command handlers\n */\n\n// Base event structure for all widget-server communication\nexport interface BaseWidgetServerEvent {\n  readonly timestamp: number;\n  readonly sessionId?: string;\n  readonly widgetId: string;\n}\n\n// Session Events\nexport interface SessionCreatedEvent extends BaseWidgetServerEvent {\n  readonly type: 'session:created';\n  readonly sessionType: 'development' | 'production' | 'test';\n  readonly owner: string;\n  readonly capabilities: readonly string[];\n}\n\nexport interface SessionJoinedEvent extends BaseWidgetServerEvent {\n  readonly type: 'session:joined';\n  readonly sessionType: 'development' | 'production' | 'test';\n  readonly owner: string;\n  readonly joinedBy: string;\n  readonly userCount: number;\n}\n\n// Health Events\nexport interface HealthStatus {\n  readonly overall: 'healthy' | 'degraded' | 'unhealthy';\n  readonly score: number;\n  readonly components: readonly {\n    readonly name: string;\n    readonly status: 'healthy' | 'degraded' | 'unhealthy';\n    readonly lastCheck: string;\n    readonly details?: string;\n  }[];\n  readonly issues: readonly {\n    readonly severity: 'info' | 'warn' | 'error' | 'critical';\n    readonly component: string;\n    readonly message: string;\n    readonly timestamp: string;\n  }[];\n}\n\nexport interface HealthUpdatedEvent extends BaseWidgetServerEvent {\n  readonly type: 'health:updated';\n  readonly health: HealthStatus;\n  readonly previousHealth?: HealthStatus;\n  readonly changedComponents: readonly string[];\n}\n\n// Persona Data Types - Shared across all widgets\nexport interface PersonaData {\n  readonly id: string;\n  readonly name: string;\n  readonly status: 'training' | 'graduated' | 'failed' | 'loaded' | 'unknown';\n  readonly specialization: string;\n  readonly graduationScore?: number;\n  readonly currentScore?: number;\n  readonly threshold?: number;\n  readonly originalThreshold?: number;\n  readonly currentIteration?: number;\n  readonly totalIterations?: number;\n  readonly failureReason?: string;\n  readonly accuracy?: number;\n  readonly created?: string;\n  readonly lastUsed?: string;\n}\n\nexport type PersonaStatus = PersonaData['status'];\nexport type PersonaAction = 'deploy' | 'retrain' | 'share' | 'delete' | 'export';\n\n// Server-side validation and command schemas - shared between widgets and server commands\nexport interface PersonaCommandRequest {\n  readonly action: PersonaAction;\n  readonly personaId: string;\n  readonly params?: Record<string, unknown>;\n}\n\nexport interface PersonaCommandResponse {\n  readonly success: boolean;\n  readonly action: PersonaAction;\n  readonly personaId: string;\n  readonly result?: PersonaData;\n  readonly error?: string;\n  readonly timestamp: number;\n}\n\n// Validation functions that work on both server and client\nexport const PersonaValidation = {\n  // Server-side command validation\n  validatePersonaCommand(request: unknown): request is PersonaCommandRequest {\n    const req = request as PersonaCommandRequest;\n    return (\n      typeof req === 'object' &&\n      req !== null &&\n      typeof req.personaId === 'string' &&\n      req.personaId.length > 0 &&\n      ['deploy', 'retrain', 'share', 'delete', 'export'].includes(req.action)\n    );\n  },\n  \n  // Client-side data validation\n  validatePersonaData(data: unknown): data is PersonaData {\n    const persona = data as PersonaData;\n    return (\n      typeof persona === 'object' &&\n      persona !== null &&\n      typeof persona.id === 'string' &&\n      typeof persona.name === 'string' &&\n      typeof persona.specialization === 'string' &&\n      ['training', 'graduated', 'failed', 'loaded', 'unknown'].includes(persona.status)\n    );\n  },\n\n  // Shared business logic - works on both client and server\n  isPersonaReady(persona: PersonaData): boolean {\n    return persona.status === 'graduated' || persona.status === 'loaded';\n  },\n\n  canRetrain(persona: PersonaData): boolean {\n    return persona.status === 'failed' || persona.status === 'graduated';\n  },\n\n  getPersonaDisplayName(persona: PersonaData): string {\n    if (persona.name.includes('fine-tune-test-')) return 'Fine-Tune Test';\n    if (persona.name.includes('test-lawyer-')) return 'Legal Test';\n    return persona.name.replace(/_/g, ' ').replace(/-/g, ' ');\n  },\n\n  getPersonaStatusDisplay(status: PersonaStatus): string {\n    const statusMap: Record<PersonaStatus, string> = {\n      training: '\uD83D\uDD04 Training',\n      graduated: '\uD83C\uDF93 Graduated',\n      failed: '\u274C Failed',\n      loaded: '\u2705 Ready',\n      unknown: '\u2753 Unknown'\n    };\n    return statusMap[status];\n  },\n\n  getPersonaSpecializationDisplay(specialization: string): string {\n    return specialization.replace(/_/g, ' ').replace(/-/g, ' ');\n  },\n\n  getAvailableActions(persona: PersonaData): PersonaAction[] {\n    const actions: PersonaAction[] = ['export']; // Always available\n    \n    if (this.isPersonaReady(persona)) {\n      actions.push('deploy', 'share');\n    }\n    \n    if (this.canRetrain(persona)) {\n      actions.push('retrain');\n    }\n    \n    if (persona.status !== 'training') {\n      actions.push('delete');\n    }\n    \n    return actions;\n  }\n} as const;\n\n// Project Data Types - Shared across all widgets\nexport interface ProjectData {\n  readonly id: string;\n  readonly name: string;\n  readonly status: 'active' | 'completed' | 'paused' | 'archived';\n  readonly description?: string;\n  readonly created?: string;\n  readonly lastModified?: string;\n  readonly owner?: string;\n}\n\nexport type ProjectStatus = ProjectData['status'];\nexport type ProjectAction = 'open' | 'close' | 'archive' | 'delete' | 'export';\n\n// Data Events\nexport type DataSourceType = \n  | 'personas' \n  | 'projects' \n  | 'sessions' \n  | 'health'\n  | 'commands'\n  | 'daemons'\n  | 'widgets'\n  | 'logs'\n  | 'metrics';\n\nexport interface DataUpdatedEvent extends BaseWidgetServerEvent {\n  readonly type: 'data:updated';\n  readonly dataSource: DataSourceType;\n  readonly updateType: 'created' | 'updated' | 'deleted' | 'bulk_update';\n  readonly affectedItems: readonly string[];\n  readonly metadata?: Record<string, unknown>;\n}\n\n// Widget Request Types\nexport interface WidgetDataRequest {\n  readonly dataSource: DataSourceType;\n  readonly params?: Record<string, unknown>;\n  readonly filters?: {\n    readonly limit?: number;\n    readonly offset?: number;\n    readonly sortBy?: string;\n    readonly sortOrder?: 'asc' | 'desc';\n    readonly search?: string;\n  };\n}\n\nexport interface WidgetCommandRequest {\n  readonly command: string;\n  readonly params?: Record<string, unknown>;\n  readonly timeout?: number;\n  readonly priority?: 'low' | 'normal' | 'high';\n}\n\n// Widget Response Types\nexport interface WidgetDataResponse<T = unknown> {\n  readonly success: boolean;\n  readonly dataSource: DataSourceType;\n  readonly data?: T;\n  readonly error?: string;\n  readonly timestamp: number;\n  readonly metadata?: {\n    readonly totalCount?: number;\n    readonly hasMore?: boolean;\n    readonly fromCache?: boolean;\n  };\n}\n\nexport interface WidgetCommandResponse<T = unknown> {\n  readonly success: boolean;\n  readonly command: string;\n  readonly result?: T;\n  readonly error?: string;\n  readonly timestamp: number;\n  readonly executionTime?: number;\n}\n\n// Server Control Event Types\nexport interface WidgetServerControlEvent extends BaseWidgetServerEvent {\n  readonly eventType: 'screenshot' | 'refresh' | 'export' | 'validate' | 'fetch-data' | 'execute-command';\n  readonly data: unknown;\n}\n\nexport interface WidgetScreenshotEvent extends WidgetServerControlEvent {\n  readonly eventType: 'screenshot';\n  readonly data: {\n    readonly target?: 'widget' | 'page' | 'element';\n    readonly selector?: string;\n    readonly includeContext?: boolean;\n    readonly filename?: string;\n    readonly format?: 'png' | 'jpg' | 'webp';\n  };\n}\n\nexport interface WidgetRefreshEvent extends WidgetServerControlEvent {\n  readonly eventType: 'refresh';\n  readonly data: {\n    readonly preserveState?: boolean;\n    readonly refreshType?: 'soft' | 'hard';\n    readonly clearCache?: boolean;\n  };\n}\n\nexport interface WidgetExportEvent extends WidgetServerControlEvent {\n  readonly eventType: 'export';\n  readonly data: {\n    readonly format: 'json' | 'csv' | 'xml' | 'yaml';\n    readonly includeMetadata?: boolean;\n    readonly filename?: string;\n  };\n}\n\nexport interface WidgetValidateEvent extends WidgetServerControlEvent {\n  readonly eventType: 'validate';\n  readonly data: {\n    readonly validateAssets?: boolean;\n    readonly validateContent?: boolean;\n    readonly validateAPI?: boolean;\n    readonly strictMode?: boolean;\n  };\n}\n\nexport interface WidgetFetchDataEvent extends WidgetServerControlEvent {\n  readonly eventType: 'fetch-data';\n  readonly data: WidgetDataRequest;\n}\n\nexport interface WidgetExecuteCommandEvent extends WidgetServerControlEvent {\n  readonly eventType: 'execute-command';\n  readonly data: WidgetCommandRequest;\n}\n\n// Server event names for type safety\nexport type ServerEventName = \n  | 'session:created'\n  | 'session:joined' \n  | 'health:updated'\n  | 'data:updated';\n\n// Widget control event names for type safety\nexport type WidgetControlEventName =\n  | 'widget:screenshot'\n  | 'widget:refresh' \n  | 'widget:export'\n  | 'widget:validate'\n  | 'widget:fetch-data'\n  | 'widget:execute-command';\n\n// Widget event names for type safety  \nexport type WidgetEventName =\n  | 'server:session-created'\n  | 'server:session-joined'\n  | 'server:health-updated'\n  | 'server:data-updated';\n\n// Union types for type safety\nexport type ServerEvent = SessionCreatedEvent | SessionJoinedEvent | HealthUpdatedEvent | DataUpdatedEvent;\n\nexport type WidgetControlEvent = \n  | WidgetScreenshotEvent \n  | WidgetRefreshEvent \n  | WidgetExportEvent \n  | WidgetValidateEvent\n  | WidgetFetchDataEvent\n  | WidgetExecuteCommandEvent;\n\n// Event listener function types\nexport type ServerEventListener<T extends ServerEvent = ServerEvent> = (event: T) => void | Promise<void>;\nexport type WidgetEventListener<T extends WidgetControlEvent = WidgetControlEvent> = (event: T) => void | Promise<void>;\n\n// Widget capabilities interface\nexport interface WidgetCapabilities {\n  readonly canFetchData: readonly DataSourceType[];\n  readonly canExecuteCommands: readonly string[];\n  readonly respondsToEvents: readonly ServerEvent['type'][];\n  readonly supportsExport: readonly ('json' | 'csv' | 'xml' | 'yaml')[];\n  readonly requiresAuth: boolean;\n  readonly updateFrequency?: 'realtime' | 'periodic' | 'manual';\n}\n\n// Widget registration interface\nexport interface WidgetRegistration {\n  readonly widgetId: string;\n  readonly widgetName: string;\n  readonly version: string;\n  readonly capabilities: WidgetCapabilities;\n  readonly dependencies?: readonly string[];\n  readonly metadata?: Record<string, unknown>;\n}\n\n// Command data source mapping - commands declare what data they provide\nexport interface CommandDataSourceMapping {\n  readonly command: string;\n  readonly dataSource: DataSourceType;\n  readonly description?: string;\n  readonly aliases?: readonly string[];\n}\n\n// Event mapping configuration - dynamic event setup\nexport interface EventMappingConfig {\n  readonly serverEvent: ServerEventName;\n  readonly widgetEvent: WidgetEventName;\n  readonly enabled: boolean;\n}", "/**\n * SavedPersonas Widget - Modern TypeScript Web Component\n * Self-contained with embedded styles, full functionality, and tests\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\nimport { \n  DataSourceType, \n  DataUpdatedEvent, \n  WidgetCapabilities,\n  SessionCreatedEvent,\n  PersonaData,\n  PersonaAction,\n  PersonaValidation\n} from '../../../types/shared/WidgetServerTypes';\n\nexport class SavedPersonasWidget extends BaseWidget {\n  private personas: PersonaData[] = [];\n  private selectedPersona: PersonaData | null = null;\n  private dragState: any = null;\n\n  constructor() {\n    super();\n    this.widgetName = 'SavedPersonas';\n    this.widgetIcon = '\uD83D\uDC64';\n    this.widgetTitle = 'Saved Personas';\n  }\n\n  protected override getWidgetCapabilities(): WidgetCapabilities {\n    return {\n      canFetchData: ['personas'], // Uses dynamic discovery for personas data\n      canExecuteCommands: ['persona_deploy', 'persona_retrain', 'persona_share', 'persona_delete', 'persona_update_threshold'], \n      respondsToEvents: ['session:created', 'data:updated'], // Type-safe event names\n      supportsExport: ['json'], // Personas can be exported as JSON\n      requiresAuth: false,\n      updateFrequency: 'realtime' // Auto-refresh when personas change\n    };\n  }\n\n  protected override async initializeWidget(): Promise<void> {\n    await super.initializeWidget(); // Sets up typed event listeners automatically\n    \n    // Use dynamic discovery to fetch personas data with proper command parameters\n    this.fetchServerData('personas', {\n      params: {\n        action: 'list'\n      },\n      filters: {\n        limit: 50,\n        sortBy: 'lastUsed',\n        sortOrder: 'desc'\n      }\n    });\n  }\n\n  // TypeScript prevents mistakes - must use DataSourceType, gets typed data\n  protected override processServerData(dataSource: DataSourceType, data: unknown): void {\n    if (dataSource === 'personas') {\n      // Use shared validation logic - works on both server and client\n      if (Array.isArray(data)) {\n        this.personas = data.filter(PersonaValidation.validatePersonaData);\n        console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Loaded ${this.personas.length} validated personas via dynamic discovery`);\n      } else {\n        this.personas = [];\n        console.warn(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Invalid personas data received:`, data);\n      }\n      this.update(); // Re-render with new data\n    }\n  }\n\n  // TypeScript enforces correct event type - no more 'any' mistakes\n  protected override shouldAutoRefreshOnDataUpdate(event: DataUpdatedEvent): boolean {\n    return event.dataSource === 'personas' && event.updateType !== 'deleted';\n  }\n\n  // Type-safe session events - linter prevents property access mistakes\n  protected override onServerSessionCreated(event: SessionCreatedEvent): void {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: New ${event.sessionType} session by ${event.owner} - refreshing personas`);\n    this.fetchServerData('personas'); // Type-safe call\n  }\n\n  // Type-safe error handling with data source context  \n  protected override onDataFetchError(dataSource: DataSourceType, error: string): void {\n    if (dataSource === 'personas') {\n      this.personas = []; // Fallback to empty state\n      console.error(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Failed to load personas: ${error}`);\n      this.loadMockData(); // Fallback to mock data for demo\n      this.update();\n    }\n  }\n\n  renderContent(): string {\n    return `\n      <div class=\"widget-container\">\n        <div class=\"widget-header\">\n          <div class=\"header-title\">\n            <span>${this.widgetIcon}</span>\n            <span>${this.widgetTitle}</span>\n            <span class=\"persona-count\">${this.personas.length}</span>\n          </div>\n        </div>\n        <div class=\"widget-content\">\n          ${this.renderPersonas()}\n        </div>\n      </div>\n    `;\n  }\n\n  private renderPersonas(): string {\n    if (this.personas.length === 0) {\n      return `\n        <div class=\"empty-state\">\n          <div class=\"empty-icon\">\uD83D\uDC64</div>\n          <div class=\"empty-message\">\n            No personas found.<br>\n            Create your first AI persona to get started!\n          </div>\n        </div>\n      `;\n    }\n\n    return this.personas.map(persona => this.renderPersona(persona)).join('');\n  }\n\n  private renderPersona(persona: PersonaData): string {\n    const isSelected = this.selectedPersona?.id === persona.id;\n    \n    return `\n      <div class=\"persona-card ${isSelected ? 'selected' : ''}\" data-persona-id=\"${persona.id}\">\n        <div class=\"persona-header\">\n          <div class=\"persona-name\">${PersonaValidation.getPersonaDisplayName(persona)}</div>\n          <div class=\"persona-status ${persona.status}\">\n            ${PersonaValidation.getPersonaStatusDisplay(persona.status)}\n          </div>\n        </div>\n        \n        <div class=\"persona-specialization\">\n          ${PersonaValidation.getPersonaSpecializationDisplay(persona.specialization)}\n        </div>\n        \n        ${this.renderAcademyProgress(persona)}\n        \n        <div class=\"persona-actions\">\n          ${this.renderPersonaActions(persona)}\n        </div>\n      </div>\n    `;\n  }\n\n  // Dynamic action rendering based on shared business logic\n  private renderPersonaActions(persona: PersonaData): string {\n    const availableActions = PersonaValidation.getAvailableActions(persona);\n    \n    const actionLabels: Record<PersonaAction, string> = {\n      deploy: '\u2705 Deploy',\n      retrain: '\uD83D\uDD04 Retrain', \n      share: '\uD83D\uDD17 Share',\n      delete: '\uD83D\uDDD1\uFE0F Delete',\n      export: '\uD83D\uDCBE Export'\n    };\n\n    return availableActions\n      .map(action => `\n        <button class=\"persona-action ${action}\" \n                data-action=\"${action}\" \n                data-persona-id=\"${persona.id}\">\n          ${actionLabels[action]}\n        </button>\n      `)\n      .join('');\n  }\n\n  // Removed formatPersonaName and formatStatus - using shared PersonaValidation methods instead\n\n  private renderAcademyProgress(persona: PersonaData): string {\n    if (!persona.currentScore && !persona.graduationScore) return '';\n\n    const currentScore = persona.graduationScore || persona.currentScore || 0;\n    const threshold = persona.threshold || 75;\n    const normalizedScore = currentScore > 1 ? Math.min(100, currentScore) : currentScore * 100;\n    const normalizedThreshold = threshold > 1 ? Math.min(100, threshold) : threshold * 100;\n\n    return `\n      <div class=\"academy-progress\">\n        <div class=\"progress-header\">\n          <span class=\"score-label\">Score: ${normalizedScore.toFixed(1)}%</span>\n          <span class=\"threshold-label\">Target: ${normalizedThreshold.toFixed(1)}%</span>\n        </div>\n        <div class=\"progress-bar\" data-persona-id=\"${persona.id}\">\n          <div class=\"threshold-background\" style=\"width: ${normalizedThreshold}%\"></div>\n          <div class=\"progress-fill\" style=\"width: ${normalizedScore}%\"></div>\n          <div class=\"threshold-marker\" \n               style=\"left: calc(${normalizedThreshold}% - 6px)\" \n               data-threshold=\"${normalizedThreshold}\"\n               data-persona-id=\"${persona.id}\">\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  // Removed loadPersonas - now using dynamic discovery via fetchServerData in initializeWidget\n\n  private loadMockData(): void {\n    this.personas = [\n      {\n        id: 'persona-1',\n        name: 'Protocol Sheriff',\n        status: 'graduated',\n        specialization: 'protocol_enforcement',\n        graduationScore: 96.7,\n        threshold: 85,\n        accuracy: 96.7,\n        created: '2025-01-20',\n        lastUsed: '2025-01-26'\n      },\n      {\n        id: 'persona-2',\n        name: 'Code Specialist',\n        status: 'training',\n        specialization: 'code_analysis',\n        currentScore: 72.3,\n        threshold: 80,\n        currentIteration: 6,\n        totalIterations: 10,\n        created: '2025-01-22'\n      },\n      {\n        id: 'persona-3',\n        name: 'Legal Assistant',\n        status: 'failed',\n        specialization: 'legal_analysis',\n        graduationScore: 45.2,\n        threshold: 75,\n        failureReason: 'Low performance on contract analysis',\n        created: '2025-01-18'\n      }\n    ];\n  }\n\n  setupEventListeners(): void {\n    if (!this.shadowRoot) return;\n\n    // Persona card clicks\n    this.shadowRoot.querySelectorAll('.persona-card').forEach(card => {\n      card.addEventListener('click', (e) => {\n        const target = e.target as HTMLElement;\n        if (target.closest('.persona-action')) return; // Don't trigger on action buttons\n        \n        const personaId = (card as HTMLElement).dataset.personaId!;\n        this.selectPersona(personaId);\n      });\n    });\n\n    // Action button clicks\n    this.shadowRoot.querySelectorAll('.persona-action').forEach(button => {\n      button.addEventListener('click', (e) => {\n        e.stopPropagation();\n        const action = (button as HTMLElement).dataset.action! as PersonaAction;\n        const personaId = (button as HTMLElement).dataset.personaId!;\n        this.handlePersonaAction(action, personaId);\n      });\n    });\n\n    // Threshold marker dragging\n    this.shadowRoot.querySelectorAll('.threshold-marker').forEach(marker => {\n      marker.addEventListener('mousedown', (e) => this.handleThresholdDragStart(e as MouseEvent));\n    });\n  }\n\n  // Removed setupContinuumListeners - now using typed event handlers from BaseWidget\n\n  private selectPersona(personaId: string): void {\n    const persona = this.personas.find(p => p.id === personaId);\n    if (persona) {\n      this.selectedPersona = persona;\n      console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Selected persona:`, persona.name);\n      this.render();\n      \n      // Emit selection event\n      this.dispatchEvent(new CustomEvent('persona-selected', {\n        detail: { persona },\n        bubbles: true\n      }));\n    }\n  }\n\n  // Type-safe command execution with strongly-typed actions and elegant spread pattern\n  private async handlePersonaAction(action: PersonaAction, personaId: string): Promise<void> {\n    console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Action ${action} for persona ${personaId}`);\n    \n    try {\n      const baseParams = { \n        params: { personaId },\n        timeout: 15000,\n        priority: 'normal' as const\n      };\n\n      // TypeScript ensures only valid PersonaAction values can be passed\n      switch (action) {\n        case 'deploy':\n          this.executeServerCommand('persona_deploy', baseParams);\n          break;\n        case 'retrain':\n          this.executeServerCommand('persona_retrain', { \n            ...baseParams,\n            timeout: 30000 // Retrain takes longer\n          });\n          break;\n        case 'share':\n          this.executeServerCommand('persona_share', baseParams);\n          break;\n        case 'delete':\n          this.executeServerCommand('persona_delete', {\n            ...baseParams,\n            priority: 'high' // Delete operations should be prioritized\n          });\n          break;\n        case 'export':\n          this.triggerExport('json', { personaId }); // Use inherited server controls\n          break;\n      }\n    } catch (error) {\n      console.error(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Action ${action} failed:`, error);\n    }\n  }\n\n  // Type-safe command result processing\n  protected override processCommandResult(command: string, result: unknown): void {\n    switch (command) {\n      case 'persona_deploy':\n        console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Persona deployed:`, result);\n        this.fetchServerData('personas'); // Refresh list\n        break;\n      case 'persona_retrain':\n        console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Persona retraining started:`, result);\n        this.triggerRefresh({ preserveState: true }); // Use inherited server controls\n        break;\n      case 'persona_share':\n        console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Persona shared:`, result);\n        break;\n    }\n  }\n\n  private handleThresholdDragStart(event: MouseEvent): void {\n    const marker = event.target as HTMLElement;\n    const personaId = marker.dataset.personaId!;\n    const progressBar = marker.closest('.progress-bar') as HTMLElement;\n    \n    this.dragState = {\n      isDragging: true,\n      personaId,\n      marker,\n      progressBar,\n      startX: event.clientX,\n      barRect: progressBar.getBoundingClientRect()\n    };\n\n    marker.classList.add('dragging');\n    \n    document.addEventListener('mousemove', this.handleThresholdDrag.bind(this));\n    document.addEventListener('mouseup', this.handleThresholdDragEnd.bind(this));\n    \n    event.preventDefault();\n  }\n\n  private handleThresholdDrag(event: MouseEvent): void {\n    if (!this.dragState?.isDragging) return;\n\n    const { marker, progressBar, barRect } = this.dragState;\n    const mouseX = event.clientX;\n    const relativeX = mouseX - barRect.left;\n    const percentage = Math.max(0, Math.min(100, (relativeX / barRect.width) * 100));\n\n    marker.style.left = `calc(${percentage}% - 6px)`;\n    marker.dataset.threshold = percentage.toString();\n    \n    const thresholdBg = progressBar.querySelector('.threshold-background') as HTMLElement;\n    if (thresholdBg) {\n      thresholdBg.style.width = `${percentage}%`;\n    }\n  }\n\n  private handleThresholdDragEnd(event: MouseEvent): void {\n    if (!this.dragState?.isDragging) return;\n\n    const { marker, personaId, barRect } = this.dragState;\n    const mouseX = event.clientX;\n    const relativeX = mouseX - barRect.left;\n    const newThreshold = Math.max(0, Math.min(100, (relativeX / barRect.width) * 100));\n\n    marker.classList.remove('dragging');\n    \n    // Update persona threshold via server command (maintains data consistency)\n    const persona = this.personas.find(p => p.id === personaId);\n    if (persona) {\n      console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Updating threshold for ${PersonaValidation.getPersonaDisplayName(persona)} to ${newThreshold.toFixed(1)}%`);\n      \n      // Use server command to maintain shared state\n      this.executeServerCommand('persona_update_threshold', {\n        params: { \n          personaId, \n          threshold: newThreshold \n        },\n        timeout: 5000,\n        priority: 'normal' as const\n      });\n    }\n\n    document.removeEventListener('mousemove', this.handleThresholdDrag.bind(this));\n    document.removeEventListener('mouseup', this.handleThresholdDragEnd.bind(this));\n    \n    this.dragState = null;\n  }\n}\n\n// Register the custom element\nif (!customElements.get('saved-personas')) {\n  customElements.define('saved-personas', SavedPersonasWidget);\n}\n\nexport default SavedPersonasWidget;", "/**\n * Session Costs Widget - Display session usage metrics\n * ===================================================\n * Shows requests count and cost information in sidebar\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\n\ninterface SessionMetrics {\n  requests: number;\n  cost: number;\n  status: 'active' | 'paused' | 'ended';\n}\n\nexport class SessionCostsWidget extends BaseWidget {\n  private metrics: SessionMetrics = {\n    requests: 0,\n    cost: 0.0,\n    status: 'active'\n  };\n\n  constructor() {\n    super();\n    this.loadSessionMetrics();\n  }\n\n  static get widgetName(): string {\n    return 'session-costs';\n  }\n\n  protected getOwnCSS(): string[] {\n    return ['SessionCosts.css'];\n  }\n\n  protected renderOwnContent(): string {\n    return `\n      <div class=\"session-costs-container\">\n        <div class=\"section-header\">\n          <span class=\"section-icon\">\uD83D\uDCB0</span>\n          <span class=\"section-title\">Session Costs</span>\n          <span class=\"section-status status-${this.metrics.status}\">${this.getStatusText()}</span>\n        </div>\n        \n        <div class=\"metrics-display\">\n          <div class=\"metric-row\">\n            <span class=\"metric-label\">Requests</span>\n            <span class=\"metric-value\">${this.metrics.requests}</span>\n          </div>\n          <div class=\"metric-row\">\n            <span class=\"metric-label\">Cost</span>\n            <span class=\"metric-value highlight\">$${this.formatCost(this.metrics.cost)}</span>\n          </div>\n        </div>\n        \n        <div class=\"cost-actions\">\n          <button class=\"action-button\" data-action=\"refresh\">\uD83D\uDD04 Refresh</button>\n          <button class=\"action-button\" data-action=\"export\">\uD83D\uDCCA Export</button>\n        </div>\n      </div>\n    `;\n  }\n\n  private async loadSessionMetrics(): Promise<void> {\n    try {\n      // Get current session info\n      const sessionResponse = await this.executeCommand('session-info', {});\n      \n      if (sessionResponse?.success) {\n        this.metrics.requests = sessionResponse.data?.requests || 0;\n        this.metrics.cost = sessionResponse.data?.cost || 0.0;\n        this.metrics.status = sessionResponse.data?.status || 'active';\n      } else {\n        // Fallback to mock data if command fails\n        this.loadMockMetrics();\n      }\n      \n      this.updateContent();\n      \n    } catch (error) {\n      console.warn('\uD83D\uDCCA SessionCosts: Failed to load metrics, using mock data:', error);\n      this.loadMockMetrics();\n      this.updateContent();\n    }\n  }\n\n  private loadMockMetrics(): void {\n    this.metrics = {\n      requests: 47,\n      cost: 0.0000,\n      status: 'active'\n    };\n  }\n\n  private formatCost(cost: number): string {\n    return cost.toFixed(4);\n  }\n\n  private getStatusText(): string {\n    switch (this.metrics.status) {\n      case 'active': return 'Active';\n      case 'paused': return 'Paused';\n      case 'ended': return 'Ended';\n      default: return 'Unknown';\n    }\n  }\n\n  protected setupEventListeners(): void {\n    this.addEventListener('click', this.handleActionClick.bind(this));\n    \n    // Listen for session updates\n    this.notifySystem('session_updated', () => {\n      this.loadSessionMetrics();\n    });\n  }\n\n  private handleActionClick(event: Event): void {\n    const target = event.target as HTMLElement;\n    const action = target.dataset.action;\n    \n    switch (action) {\n      case 'refresh':\n        this.loadSessionMetrics();\n        break;\n      case 'export':\n        this.exportMetrics();\n        break;\n    }\n  }\n\n  private async exportMetrics(): Promise<void> {\n    try {\n      const exportData = {\n        sessionMetrics: this.metrics,\n        timestamp: new Date().toISOString(),\n        export_type: 'session_costs'\n      };\n      \n      await this.executeCommand('export-data', exportData);\n      console.log('\uD83D\uDCCA SessionCosts: Metrics exported successfully');\n      \n    } catch (error) {\n      console.error('\uD83D\uDCCA SessionCosts: Failed to export metrics:', error);\n    }\n  }\n\n  private updateContent(): void {\n    const container = this.shadowRoot?.querySelector('.session-costs-container');\n    if (container) {\n      container.innerHTML = this.renderOwnContent();\n      this.setupEventListeners();\n    }\n  }\n}\n\n// Register the custom element\ncustomElements.define('session-costs', SessionCostsWidget);", "/**\n * Sidebar Widget - Main Application Sidebar\n * Includes resize functionality, room tabs, and widget containers\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\n// import { universalUserSystem } from '../shared/UniversalUserSystem';\n\nexport class SidebarWidget extends BaseWidget {\n    private isResizing: boolean = false;\n    private startX: number = 0;\n    private startWidth: number = 0;\n    private _currentRoom: string = 'general';\n\n    public get currentRoom(): string {\n        return this._currentRoom;\n    }\n\n\n    constructor() {\n        super();\n        this.widgetName = 'Sidebar';\n        this.widgetIcon = '\uD83D\uDCCB';\n        this.widgetTitle = 'Application Sidebar';\n        // CSS loaded via declarative asset system\n    }\n\n\n    protected async initializeWidget(): Promise<void> {\n        // Widget initialization after DOM is ready\n        await this.loadSidebarConfig();\n        this.loadChildWidgets();\n        this.initializeContinuonOrb();\n    }\n\n    private async loadSidebarConfig(): Promise<void> {\n        try {\n            const configPath = this.getAssetPath('sidebar-config.json');\n            const response = await fetch(configPath);\n            if (response.ok) {\n                const config = await response.json();\n                console.log('\uD83D\uDCCB Sidebar config loaded:', config);\n                // Store config to pass to children after they're rendered\n                this.sidebarConfig = config;\n            } else {\n                console.warn(`Failed to load sidebar config from ${configPath}`);\n            }\n        } catch (error) {\n            console.error('Error loading sidebar config:', error);\n        }\n    }\n\n    private sidebarConfig: any = null;\n\n    setupEventListeners(): void {\n        this.setupResizeHandlers();\n        this.setupTabChangeListeners();\n        \n        // Configure child widgets after they're rendered\n        if (this.sidebarConfig) {\n            this.configureSidebarTabs();\n            this.configureSidebarPanels();\n        }\n        \n        console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Event listeners initialized`);\n    }\n\n    private setupTabChangeListeners(): void {\n        // Listen for tab-changed events from SidebarTabs\n        this.shadowRoot.addEventListener('tab-changed', (e: Event) => {\n            const customEvent = e as CustomEvent;\n            const { panelName } = customEvent.detail;\n            console.log(`\uD83D\uDD04 Sidebar received tab-changed: ${panelName}`);\n            this.switchToPanel(panelName);\n        });\n    }\n\n    private switchToPanel(panelName: string): void {\n        this._currentRoom = panelName;\n        \n        // Update both tabs and panels with new selected state\n        this.updateTabsSelection(panelName);\n        this.updatePanelsSelection(panelName);\n        \n        console.log(`\uD83D\uDD04 Switched to: ${panelName}`);\n        \n        // Emit room change event for other components\n        this.dispatchEvent(new CustomEvent('room-changed', {\n            detail: { room: panelName },\n            bubbles: true\n        }));\n    }\n\n    private updateTabsSelection(selectedPanel: string): void {\n        const sidebarTabs = this.shadowRoot?.querySelector('sidebar-tabs') as any;\n        if (sidebarTabs && this.sidebarConfig) {\n            // Update tabs with new selection\n            const tabContent = this.sidebarConfig.tabs.map((tab: any) => ({\n                title: tab.title,\n                panelName: tab.panelName,\n                dataKey: tab.panelName,\n                active: tab.panelName === selectedPanel\n            }));\n            \n            sidebarTabs.tabs = tabContent;\n        }\n    }\n\n    private updatePanelsSelection(selectedPanel: string): void {\n        const sidebarPanel = this.shadowRoot?.querySelector('sidebar-panel') as any;\n        if (sidebarPanel && this.sidebarConfig) {\n            // Update panels with new selection\n            const panelContent = Object.keys(this.sidebarConfig.sections).map(panelName => ({\n                panelName,\n                widgets: this.sidebarConfig.sections[panelName].widgets,\n                active: panelName === selectedPanel\n            }));\n            \n            sidebarPanel.panels = panelContent;\n            sidebarPanel.activePanel = selectedPanel;\n        }\n    }\n\n    private configureSidebarTabs(): void {\n        const sidebarTabs = this.shadowRoot?.querySelector('sidebar-tabs') as any;\n        if (sidebarTabs && this.sidebarConfig) {\n            console.log('\uD83D\uDD27 Configuring SidebarTabs with:', this.sidebarConfig.tabs);\n            \n            // Map to TabContent format with dataKey\n            const tabContent = this.sidebarConfig.tabs.map((tab: any) => ({\n                title: tab.title,\n                panelName: tab.panelName,\n                dataKey: tab.panelName, // Use panelName as dataKey\n                active: tab.panelName === this.sidebarConfig.defaultTab\n            }));\n            \n            // Set tabs property - this will auto-trigger render\n            sidebarTabs.tabs = tabContent;\n            \n            if (this.sidebarConfig.defaultTab) {\n                this._currentRoom = this.sidebarConfig.defaultTab;\n            }\n        }\n    }\n\n    private configureSidebarPanels(): void {\n        const sidebarPanel = this.shadowRoot?.querySelector('sidebar-panel') as any;\n        if (sidebarPanel && this.sidebarConfig) {\n            console.log('\uD83D\uDD27 Configuring SidebarPanel with:', this.sidebarConfig.sections);\n            \n            // Map sections to PanelContent format\n            const panelContent = Object.keys(this.sidebarConfig.sections).map(panelName => ({\n                panelName,\n                widgets: this.sidebarConfig.sections[panelName].widgets,\n                active: panelName === this.sidebarConfig.defaultTab\n            }));\n            \n            // Set panels property - this will auto-trigger render\n            sidebarPanel.panels = panelContent;\n            sidebarPanel.activePanel = this.sidebarConfig.defaultTab || 'general';\n        }\n    }\n\n    private setupResizeHandlers(): void {\n        const resizeHandle = this.shadowRoot.querySelector('.sidebar-resize-handle') as HTMLElement;\n        \n        if (!resizeHandle) {\n            console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: No resize handle found - skipping resize setup`);\n            return;\n        }\n\n        console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Setting up resize handlers...`);\n\n        resizeHandle.addEventListener('mousedown', (e: MouseEvent) => {\n            this.isResizing = true;\n            this.startX = e.clientX;\n            this.startWidth = this.offsetWidth;\n            \n            // Prevent text selection during resize\n            document.body.classList.add('resizing');\n            document.body.style.userSelect = 'none';\n            document.body.style.cursor = 'col-resize';\n            \n            e.preventDefault();\n            e.stopPropagation();\n        });\n\n        // Use arrow functions to avoid potential context issues\n        const mouseMoveHandler = (e: MouseEvent) => {\n            if (!this.isResizing) return;\n\n            const newWidth = this.startWidth + (e.clientX - this.startX);\n            const minWidth = 250;\n            const maxWidth = 800;\n\n            if (newWidth >= minWidth && newWidth <= maxWidth) {\n                this.style.width = newWidth + 'px';\n            }\n            \n            e.preventDefault();\n        };\n\n        const mouseUpHandler = (e: MouseEvent) => {\n            if (this.isResizing) {\n                this.isResizing = false;\n                document.body.classList.remove('resizing');\n                document.body.style.userSelect = '';\n                document.body.style.cursor = '';\n                \n                e.preventDefault();\n            }\n        };\n\n        document.addEventListener('mousemove', mouseMoveHandler);\n        document.addEventListener('mouseup', mouseUpHandler);\n        \n        console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: Resize handlers setup complete`);\n    }\n\n    // Room switching now handled by tab-changed events and panel system\n\n    private initializeContinuonOrb(): void {\n        console.log(`\uD83D\uDD2E ${this.widgetName}: Initializing sophisticated Continuon consciousness...`);\n        \n        // Initialize emotional state\n        this.updateOrbEmotion('calm', 'System awakening...');\n        \n        // Start the consciousness monitoring system\n        this.startConsciousnessMonitoring();\n        \n        // Set up event listeners for system awareness\n        this.setupSystemAwareness();\n        \n        // Start breathing animation (idle state)\n        this.startBreathing();\n    }\n    \n    private updateOrbEmotion(emotion: 'calm' | 'excited' | 'focused' | 'concerned' | 'distressed', message: string): void {\n        const orbCenter = this.shadowRoot.querySelector('.orb-center') as HTMLElement;\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        \n        if (orbCenter && orbRing) {\n            // Remove all emotional states\n            orbCenter.classList.remove('emotion-calm', 'emotion-excited', 'emotion-focused', 'emotion-concerned', 'emotion-distressed');\n            orbRing.classList.remove('ring-calm', 'ring-excited', 'ring-focused', 'ring-concerned', 'ring-distressed');\n            \n            // Apply emotional state\n            orbCenter.classList.add(`emotion-${emotion}`);\n            orbRing.classList.add(`ring-${emotion}`);\n            \n            // Update emotion indicator\n            const emotionSpan = orbCenter.querySelector('.orb-emotion') as HTMLElement;\n            if (emotionSpan) {\n                const emotionSymbols = {\n                    calm: '\u25CF',      // Steady presence\n                    excited: '\u2726',   // Sparkle\n                    focused: '\u25C6',   // Diamond focus\n                    concerned: '\u25D0', // Half circle\n                    distressed: '\u25EF' // Empty circle\n                };\n                emotionSpan.textContent = emotionSymbols[emotion];\n            }\n            \n            // Store emotional context\n            orbCenter.setAttribute('data-emotion', emotion);\n            orbCenter.setAttribute('data-message', message);\n        }\n    }\n    \n    private startConsciousnessMonitoring(): void {\n        // Monitor system activity every 2 seconds\n        setInterval(() => {\n            this.assessSystemConsciousness();\n        }, 2000);\n    }\n    \n    private assessSystemConsciousness(): void {\n        // Check various system indicators to determine emotional state\n        if ((window as any).continuum) {\n            const continuum = (window as any).continuum;\n            \n            // Check connection health\n            const isConnected = continuum.isConnected();\n            \n            if (!isConnected) {\n                this.updateOrbEmotion('distressed', 'Lost connection to system...');\n                this.pulseDistress();\n                return;\n            }\n            \n            // Check for recent activity (commands, messages, etc.)\n            const hasRecentActivity = this.checkRecentActivity();\n            \n            if (hasRecentActivity) {\n                this.updateOrbEmotion('focused', 'Processing system activity...');\n                this.pulseActivity();\n            } else {\n                this.updateOrbEmotion('calm', 'System monitoring - all peaceful');\n                this.maintainCalm();\n            }\n        }\n    }\n    \n    private setupSystemAwareness(): void {\n        // Simple widget-based approach - no complex event dependencies\n        console.log(`\uD83E\uDDE0 ${this.widgetName}: Setting up system awareness with simple notifications`);\n        \n        // Notify system that we're ready for awareness\n        this.notifySystem('widget_ready', { \n            type: 'continuum-sidebar', \n            capabilities: ['system-awareness', 'emotional-feedback', 'user-interaction'] \n        });\n        \n        // Set up user interactions with orb\n        const orb = this.shadowRoot.querySelector('.continuon-orb-integrated') as HTMLElement;\n        if (orb) {\n            orb.addEventListener('click', () => {\n                this.updateOrbEmotion('focused', 'Attention focused on user interaction');\n                this.acknowledgeInteraction();\n                this.notifySystem('user_interaction', { type: 'click', target: 'orb' });\n            });\n            \n            orb.addEventListener('mouseenter', () => {\n                this.increaseAwareness();\n                this.notifySystem('user_interaction', { type: 'hover_start', target: 'orb' });\n            });\n            \n            orb.addEventListener('mouseleave', () => {\n                this.resumeNormalAwareness();\n                this.notifySystem('user_interaction', { type: 'hover_end', target: 'orb' });\n            });\n        }\n        \n        // Start with neutral awareness state\n        this.updateOrbEmotion('calm', 'System awareness initialized - observing environment');\n        this.startBreathing();\n        \n        console.log(`\u2705 ${this.widgetName}: System awareness configured with graceful API handling`);\n    }\n\n    /**\n     * Override system status handler to react with appropriate emotions\n     */\n    protected onSystemStatus(status: string, data?: any): void {\n        switch (status) {\n            case 'command_success':\n                this.updateOrbEmotion('excited', `Command executed: ${data?.command || 'operation'}`);\n                this.sparkle();\n                break;\n            case 'command_failure':\n                this.updateOrbEmotion('concerned', `Command failed: ${data?.error || 'unknown error'}`);\n                this.pulseWarning();\n                break;\n            case 'connection_established':\n                this.updateOrbEmotion('excited', 'Connection established - full awareness achieved!');\n                this.celebrateConnection();\n                break;\n            case 'connection_lost':\n                this.updateOrbEmotion('distressed', 'Connection lost - consciousness fading...');\n                this.fadeConsciousness();\n                break;\n            default:\n                console.log(`\uD83C\uDF9B\uFE0F ${this.widgetName}: System status ${status}`, data);\n        }\n    }\n    \n    private startBreathing(): void {\n        // Gentle breathing animation during calm states\n        const orbGlow = this.shadowRoot.querySelector('.orb-glow') as HTMLElement;\n        if (orbGlow) {\n            orbGlow.style.animation = 'breathe 4s ease-in-out infinite';\n        }\n    }\n    \n    private sparkle(): void {\n        // Brief sparkle effect for successful operations\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animation = 'sparkle 0.8s ease-out';\n            setTimeout(() => {\n                orbRing.style.animation = 'pulse 2s infinite ease-in-out';\n            }, 800);\n        }\n    }\n    \n    private pulseActivity(): void {\n        // Faster pulse for active states\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animationDuration = '1s';\n        }\n    }\n    \n    private maintainCalm(): void {\n        // Return to calm breathing\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animationDuration = '2s';\n        }\n    }\n    \n    private pulseDistress(): void {\n        // Erratic pulse for distressed states\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animation = 'distress-pulse 0.5s infinite ease-in-out';\n        }\n    }\n    \n    private celebrateConnection(): void {\n        // Special celebration animation\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animation = 'celebrate 2s ease-out';\n            setTimeout(() => {\n                orbRing.style.animation = 'pulse 2s infinite ease-in-out';\n            }, 2000);\n        }\n    }\n    \n    private acknowledgeInteraction(): void {\n        // Quick acknowledgment pulse\n        const orbCenter = this.shadowRoot.querySelector('.orb-center') as HTMLElement;\n        if (orbCenter) {\n            orbCenter.style.transform = 'scale(1.2)';\n            orbCenter.style.transition = 'transform 0.2s ease-out';\n            setTimeout(() => {\n                orbCenter.style.transform = 'scale(1)';\n            }, 200);\n        }\n    }\n    \n    private checkRecentActivity(): boolean {\n        // Check for signs of recent system activity\n        const errorCount = (window as any).continuumErrorCount || 0;\n        \n        // Simple heuristic - this could be much more sophisticated\n        return errorCount === 0; // Healthy system = activity\n    }\n    \n    private pulseWarning(): void {\n        // Warning pulse for concerning states\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animation = 'warning-pulse 1.5s ease-in-out';\n            setTimeout(() => {\n                orbRing.style.animation = 'pulse 2s infinite ease-in-out';\n            }, 1500);\n        }\n    }\n    \n    private fadeConsciousness(): void {\n        // Fading animation for disconnection\n        const orbCenter = this.shadowRoot.querySelector('.orb-center') as HTMLElement;\n        const orbGlow = this.shadowRoot.querySelector('.orb-glow') as HTMLElement;\n        if (orbCenter && orbGlow) {\n            orbCenter.style.opacity = '0.3';\n            orbGlow.style.opacity = '0.1';\n        }\n    }\n    \n    private increaseAwareness(): void {\n        // Heightened awareness on hover\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animationDuration = '0.8s';\n        }\n    }\n    \n    private resumeNormalAwareness(): void {\n        // Return to normal awareness\n        const orbRing = this.shadowRoot.querySelector('.orb-ring') as HTMLElement;\n        if (orbRing) {\n            orbRing.style.animationDuration = '2s';\n        }\n    }\n\n    private loadChildWidgets(): void {\n        // Child widgets are loaded by the main application\n        // This sidebar provides the container for them\n        console.log('\u2705 Sidebar container ready for child widgets');\n        \n        // Configure persona widgets with data\n        setTimeout(() => {\n            this.setupPersonaWidgets();\n        }, 500); // Wait for widgets to be rendered\n    }\n\n    private setupPersonaWidgets(): void {\n        const personaWidgets = this.shadowRoot.querySelectorAll('persona-widget');\n        console.log(`\uD83E\uDD16 Found ${personaWidgets.length} persona widgets to configure`);\n        \n        personaWidgets.forEach((widget: Element) => {\n            const personaWidget = widget as any; // PersonaWidget instance\n            const personaType = widget.getAttribute('data-persona');\n            \n            if (personaType && personaWidget.setPersona) {\n                const personaConfig = this.getPersonaConfig(personaType);\n                personaWidget.setPersona(personaConfig);\n                console.log(`\uD83E\uDD16 Configured persona widget: ${personaType}`);\n            }\n        });\n    }\n\n    private getPersonaConfig(personaType: string): any {\n        const configs = {\n            designer: {\n                id: 'designer-001',\n                name: 'UX Designer',\n                specialization: 'User Experience & Interface Design',\n                status: 'active' as const,\n                avatar: '\uD83C\uDFA8',\n                accuracy: 92,\n                description: 'Specializes in creating intuitive user interfaces and experiences',\n                capabilities: ['UI Design', 'UX Research', 'Prototyping', 'Design Systems'],\n                lastActive: new Date(Date.now() - 5 * 60 * 1000) // 5 minutes ago\n            },\n            developer: {\n                id: 'developer-001', \n                name: 'Full-Stack Developer',\n                specialization: 'TypeScript & System Architecture',\n                status: 'active' as const,\n                avatar: '\u26A1',\n                accuracy: 88,\n                description: 'Expert in TypeScript, React, and distributed system design',\n                capabilities: ['TypeScript', 'React', 'Node.js', 'System Design'],\n                lastActive: new Date(Date.now() - 2 * 60 * 1000) // 2 minutes ago\n            },\n            tester: {\n                id: 'tester-001',\n                name: 'QA Engineer', \n                specialization: 'Automated Testing & Quality Assurance',\n                status: 'active' as const,\n                avatar: '\uD83D\uDD0D',\n                accuracy: 95,\n                description: 'Ensures code quality through comprehensive testing strategies',\n                capabilities: ['Test Automation', 'QA Strategy', 'Bug Analysis', 'Performance Testing'],\n                lastActive: new Date(Date.now() - 10 * 60 * 1000) // 10 minutes ago\n            }\n        };\n        \n        return configs[personaType as keyof typeof configs] || {\n            id: `${personaType}-unknown`,\n            name: `Unknown ${personaType}`,\n            specialization: 'General AI Assistant',\n            status: 'offline' as const,\n            avatar: '\u2753',\n            description: 'Configuration needed',\n            capabilities: [],\n            lastActive: undefined\n        };\n    }\n\n    // Content rendering now handled by sidebar-panel widget\n\n    // HTML content now loaded from SidebarWidget.html file\n    // BaseWidget will automatically load and use it\n}\n\n// Register the custom element\n// Prevent duplicate widget registration\nif (!customElements.get('continuum-sidebar')) {\n    customElements.define('continuum-sidebar', SidebarWidget);\n}", "/**\n * SidebarHeader Widget - Continuum Logo and Orb\n * Displays the continuum logo with animated orb\n * HTML content loaded from SidebarHeader.html\n * CSS loaded from SidebarHeader.css\n */\nimport { BaseWidget } from '../shared/BaseWidget';\n\nexport class SidebarHeader extends BaseWidget {\n    constructor() {\n        super();\n        this.widgetName = 'SidebarHeader';\n        this.widgetIcon = '\uD83C\uDF10';\n        this.widgetTitle = 'Continuum Header';\n    }\n\n    protected async initializeWidget(): Promise<void> {\n        this.initializeOrb();\n    }\n\n    private initializeOrb(): void {\n        // Initialize orb consciousness and animations\n        this.updateOrbEmotion('calm', 'System ready');\n        this.startOrbAnimations();\n    }\n\n    private updateOrbEmotion(emotion: 'calm' | 'excited' | 'focused', message: string): void {\n        const orbCenter = this.shadowRoot?.querySelector('.orb-center') as HTMLElement;\n        const orbEmotion = this.shadowRoot?.querySelector('.orb-emotion') as HTMLElement;\n        \n        if (orbCenter && orbEmotion) {\n            orbCenter.setAttribute('data-emotion', emotion);\n            orbCenter.setAttribute('data-message', message);\n            \n            const emotionSymbols = {\n                calm: '\u25CF',\n                excited: '\u2726',\n                focused: '\u25C6'\n            };\n            \n            orbEmotion.textContent = emotionSymbols[emotion];\n        }\n    }\n\n    private startOrbAnimations(): void {\n        const orbGlow = this.shadowRoot?.querySelector('.orb-glow') as HTMLElement;\n        if (orbGlow) {\n            orbGlow.style.animation = 'breathe 4s ease-in-out infinite';\n        }\n    }\n\n    // HTML content loaded from SidebarHeader.html\n    // CSS loaded from SidebarHeader.css\n}\n\n// Register the custom element\nif (!customElements.get('sidebar-header')) {\n    customElements.define('sidebar-header', SidebarHeader);\n}", "/**\n * SidebarPanel Widget - Panel Content for Sidebar Sections\n * Renders widgets dynamically based on JSON configuration\n */\nimport { BaseWidget } from '../shared/BaseWidget';\n\nexport interface PanelWidget {\n    readonly type: string;\n    readonly config: Record<string, any>;\n}\n\nexport interface PanelContent {\n    readonly panelName: string;\n    readonly widgets: PanelWidget[];\n    readonly active?: boolean;\n}\n\nexport class SidebarPanelWidget extends BaseWidget {\n    private _panels: PanelContent[] = [];\n    private _activePanel: string = 'general';\n\n    public set panels(newPanels: PanelContent[]) {\n        this._panels = newPanels;\n        // Auto-render when panels are set\n        this.render();\n    }\n\n    public get panels(): PanelContent[] {\n        return this._panels;\n    }\n\n    public set activePanel(panelName: string) {\n        this._activePanel = panelName;\n        this.render();\n    }\n\n    public get activePanel(): string {\n        return this._activePanel;\n    }\n\n\n    constructor() {\n        super();\n        this.widgetName = 'SidebarPanelWidget';\n        this.widgetIcon = '\uD83D\uDCC4';\n        this.widgetTitle = 'Sidebar Panel Widget';\n    }\n\n    protected async initializeWidget(): Promise<void> {\n        this.render();\n        console.log('\uD83D\uDDC2\uFE0F SidebarPanelWidget widget ready');\n    }\n\n    protected setupEventListeners(): void {\n        // Panel widgets will handle their own events\n        console.log('\uD83D\uDDC2\uFE0F SidebarPanelWidget: Event listeners setup');\n    }\n\n    public switchPanel(panelName: string): void {\n        // Validate that the panel exists\n        const panel = this.panels.find(p => p.panelName === panelName);\n        if (!panel) {\n            console.error(`Invalid panel name: ${panelName}`);\n            return;\n        }\n\n        this._activePanel = panelName;\n        this.updateActivePanel();\n        this.emitPanelChange(panel);\n    }\n\n    private updateActivePanel(): void {\n        const panelElements = this.shadowRoot?.querySelectorAll('.sidebar-panel');\n        panelElements?.forEach(panel => {\n            const panelElement = panel as HTMLElement;\n            const panelName = panelElement.dataset.panel;\n            \n            if (panelName === this._activePanel) {\n                panelElement.style.display = 'block';\n            } else {\n                panelElement.style.display = 'none';\n            }\n        });\n    }\n\n    private emitPanelChange(panel: PanelContent): void {\n        this.dispatchEvent(new CustomEvent('panel-changed', {\n            detail: { \n                panel,\n                panelName: panel.panelName,\n                widgets: panel.widgets\n            },\n            bubbles: true\n        }));\n        \n        console.log(`\uD83D\uDD04 Panel switched to: ${panel.panelName}`);\n    }\n\n    public getActivePanel(): PanelContent | undefined {\n        return this.panels.find(p => p.panelName === this.activePanel);\n    }\n\n    protected renderContent(): string {\n        console.log('\uD83D\uDDC2\uFE0F SidebarPanelWidget renderContent() called');\n        console.log('\uD83D\uDDC2\uFE0F Current panels array:', this.panels);\n        console.log('\uD83D\uDDC2\uFE0F Active panel:', this._activePanel);\n        \n        const content = `\n            <div class=\"sidebar-panels\">\n                ${this.panels.map(panel => this.renderPanel(panel)).join('')}\n            </div>\n        `;\n        \n        console.log('\uD83D\uDDC2\uFE0F Generated HTML content:', content);\n        return content;\n    }\n\n    private renderPanel(panel: PanelContent): string {\n        const isActive = panel.panelName === this._activePanel;\n        \n        return `\n            <div class=\"sidebar-panel ${isActive ? 'active' : ''}\" \n                 data-panel=\"${panel.panelName}\"\n                 style=\"display: ${isActive ? 'block' : 'none'}\">\n                ${this.renderPanelWidgets(panel.widgets)}\n            </div>\n        `;\n    }\n\n    private renderPanelWidgets(widgets: PanelWidget[]): string {\n        return widgets.map(widget => this.renderWidget(widget)).join('');\n    }\n\n    private renderWidget(widget: PanelWidget): string {\n        return `<${widget.type}></${widget.type}>`;\n    }\n\n    // All widgets now rendered generically as <widget-type></widget-type>\n\n}\n\n// Register the custom element\nif (!customElements.get('sidebar-panel')) {\n    customElements.define('sidebar-panel', SidebarPanelWidget);\n}", "/**\n * SidebarTabs Widget - Tab Control for Sidebar Sections\n * Controls which section is active in the sidebar with strong typing\n */\nimport { BaseWidget } from '../shared/BaseWidget';\n\nexport interface TabContent {\n    readonly title: string;\n    readonly panelName: string;\n    readonly dataKey: string;\n    readonly active?: boolean;\n}\n\nexport class SidebarTabs extends BaseWidget {\n    private _tabs: TabContent[] = [];\n\n    public set tabs(newTabs: TabContent[]) {\n        this._tabs = newTabs;\n        // Auto-render when tabs are set\n        this.render();\n    }\n\n    public get tabs(): TabContent[] {\n        return this._tabs;\n    }\n\n    constructor() {\n        super();\n        this.widgetName = 'SidebarTabs';\n        this.widgetIcon = '\uD83D\uDCD1';\n        this.widgetTitle = 'Sidebar Tabs';\n    }\n\n    protected async initializeWidget(): Promise<void> {\n        this.render();\n        console.log('\uD83D\uDD27 SidebarTabs widget ready');\n    }\n\n    protected setupEventListeners(): void {\n        const tabElements = this.shadowRoot?.querySelectorAll('.room-tab');\n        tabElements?.forEach(tab => {\n            tab.addEventListener('click', (e: Event) => {\n                const target = e.target as HTMLElement;\n                const panelName = target.dataset.room;\n                if (panelName) {\n                    this.switchTab(panelName);\n                }\n            });\n        });\n    }\n\n    private switchTab(panelName: string): void {\n        // Validate that the panel exists\n        const tab = this.tabs.find(t => t.panelName === panelName);\n        if (!tab) {\n            console.error(`Invalid panel name: ${panelName}`);\n            return;\n        }\n\n        // Only emit event - don't manage internal state\n        // Parent will update our data with new active states\n        this.emitTabChange(tab);\n    }\n\n    private emitTabChange(tab: TabContent): void {\n        this.dispatchEvent(new CustomEvent('tab-changed', {\n            detail: { \n                tab,\n                panelName: tab.panelName,\n                title: tab.title,\n                dataKey: tab.dataKey\n            },\n            bubbles: true\n        }));\n        \n        console.log(`\uD83D\uDD04 Tab switched to: ${tab.title} (${tab.panelName})`);\n    }\n\n    public get activeTab(): TabContent | undefined {\n        return this.tabs.find(t => t.active);\n    }\n\n    protected renderContent(): string {\n        console.log('\uD83D\uDCD1 SidebarTabs renderContent() called');\n        console.log('\uD83D\uDCD1 Current tabs array:', this.tabs);\n        \n        const content = `\n            <div class=\"room-tabs\">\n                ${this.tabs.map(tab => `\n                    <div class=\"room-tab ${tab.active ? 'active' : ''}\" \n                         data-room=\"${tab.panelName}\">\n                        ${tab.title}\n                    </div>\n                `).join('')}\n            </div>\n        `;\n        \n        console.log('\uD83D\uDCD1 Generated HTML content:', content);\n        return content;\n    }\n}\n\n// Register the custom element\nif (!customElements.get('sidebar-tabs')) {\n    customElements.define('sidebar-tabs', SidebarTabs);\n}", "/**\n * Users & Agents Widget - Display and manage AI agents and users\n * =============================================================\n * Shows search, user list with avatars, and agent management\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\n\ninterface User {\n  id: string;\n  name: string;\n  type: 'USER' | 'AI';\n  specialization?: string;\n  status: 'active' | 'training' | 'graduated' | 'offline';\n  lastActive: string;\n  avatar: string;\n  accuracy?: number;\n}\n\nexport class UsersAgentsWidget extends BaseWidget {\n  private users: User[] = [];\n  private searchQuery: string = '';\n  private selectedUser: string | null = null;\n\n  constructor() {\n    super();\n    this.loadUsers();\n  }\n\n  static get widgetName(): string {\n    return 'user-selector';\n  }\n\n  protected getOwnCSS(): string[] {\n    return ['UsersAgents.css'];\n  }\n\n  protected renderOwnContent(): string {\n    const filteredUsers = this.getFilteredUsers();\n    \n    return `\n      <div class=\"users-agents-container\">\n        <div class=\"section-header\">\n          <span class=\"section-icon\">\uD83D\uDC65</span>\n          <span class=\"section-title\">USERS & AGENTS</span>\n          <button class=\"collapse-button\" data-action=\"toggle\">\u25BC</button>\n        </div>\n        \n        <div class=\"widget-content\">\n          <div class=\"search-container\">\n            <input \n              type=\"text\" \n              class=\"search-input\" \n              placeholder=\"Search agents...\"\n              value=\"${this.searchQuery}\"\n              data-action=\"search\"\n            />\n            <span class=\"search-icon\">\uD83D\uDD0D</span>\n          </div>\n          \n          <div class=\"users-list\">\n            ${filteredUsers.map(user => this.renderUser(user)).join('')}\n          </div>\n          \n          <div class=\"actions-footer\">\n            <button class=\"action-button\" data-action=\"add-agent\">+ Add Agent</button>\n            <button class=\"action-button\" data-action=\"manage\">\u2699\uFE0F Manage</button>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  private renderUser(user: User): string {\n    const isSelected = user.id === this.selectedUser;\n    const statusIcon = this.getStatusIcon(user.status);\n    const userBadge = user.type === 'USER' ? 'USER' : 'AI';\n    \n    return `\n      <div class=\"user-item ${isSelected ? 'selected' : ''}\" data-user-id=\"${user.id}\">\n        <div class=\"user-avatar\">\n          <span class=\"avatar-icon\">${user.avatar}</span>\n          <span class=\"status-indicator status-${user.status}\">${statusIcon}</span>\n        </div>\n        \n        <div class=\"user-info\">\n          <div class=\"user-header\">\n            <span class=\"user-name\">${user.name}</span>\n            <span class=\"user-badge badge-${user.type.toLowerCase()}\">${userBadge}</span>\n          </div>\n          \n          <div class=\"user-details\">\n            <span class=\"user-specialization\">${user.specialization || 'General'}</span>\n            ${user.accuracy ? `<span class=\"user-accuracy\">${user.accuracy}%</span>` : ''}\n          </div>\n          \n          <div class=\"user-activity\">\n            <span class=\"last-active\">Last active: ${this.formatTime(user.lastActive)}</span>\n          </div>\n        </div>\n        \n        <div class=\"user-actions\">\n          <button class=\"star-button\" data-action=\"star\" data-user-id=\"${user.id}\">\u2B50</button>\n          <button class=\"more-button\" data-action=\"more\" data-user-id=\"${user.id}\">\u22EF</button>\n        </div>\n      </div>\n    `;\n  }\n\n  private async loadUsers(): Promise<void> {\n    try {\n      const response = await this.executeCommand('personas', { action: 'list' });\n      \n      if (response?.personas) {\n        this.users = response.personas.map((persona: any) => ({\n          id: persona.id,\n          name: persona.name,\n          type: persona.id === 'joel' ? 'USER' : 'AI',\n          specialization: persona.specialization,\n          status: persona.status === 'active' ? 'active' : 'offline',\n          lastActive: persona.lastUsed,\n          avatar: persona.avatar || (persona.id === 'joel' ? '\uD83D\uDC64' : '\uD83E\uDD16'),\n          accuracy: persona.accuracy\n        }));\n      } else {\n        this.loadMockUsers();\n      }\n      \n      this.updateContent();\n      \n    } catch (error) {\n      console.warn('\uD83D\uDC65 UsersAgents: Failed to load users, using mock data:', error);\n      this.loadMockUsers();\n      this.updateContent();\n    }\n  }\n\n  private loadMockUsers(): void {\n    this.users = [\n      {\n        id: 'claude-code',\n        name: 'Claude Code',\n        type: 'AI',\n        specialization: 'AI Assistant',\n        status: 'active',\n        lastActive: '8:19:21 AM',\n        avatar: '\uD83E\uDD16',\n        accuracy: 96.5\n      },\n      {\n        id: 'joel',\n        name: 'joel',\n        type: 'USER',\n        specialization: 'Project Owner',\n        status: 'active',\n        lastActive: '8:19:21 AM',\n        avatar: '\uD83D\uDC64'\n      },\n      {\n        id: 'auto-route',\n        name: 'Auto Route',\n        type: 'AI',\n        specialization: 'Smart agent selection',\n        status: 'active',\n        lastActive: '8:18:45 AM',\n        avatar: '\uD83C\uDFAF',\n        accuracy: 94.2\n      },\n      {\n        id: 'codeai',\n        name: 'CodeAI',\n        type: 'AI',\n        specialization: 'Code analysis & debugging',\n        status: 'training',\n        lastActive: '8:17:30 AM',\n        avatar: '\uD83D\uDD27',\n        accuracy: 97.8\n      },\n      {\n        id: 'generalai',\n        name: 'GeneralAI',\n        type: 'AI',\n        specialization: 'General assistance',\n        status: 'active',\n        lastActive: '8:16:15 AM',\n        avatar: '\uD83C\uDF1F',\n        accuracy: 95.1\n      },\n      {\n        id: 'plannerai',\n        name: 'PlannerAI',\n        type: 'AI',\n        specialization: 'Strategy & web commands',\n        status: 'graduated',\n        lastActive: '8:15:00 AM',\n        avatar: '\uD83D\uDCCB',\n        accuracy: 93.6\n      }\n    ];\n  }\n\n  private getFilteredUsers(): User[] {\n    if (!this.searchQuery) return this.users;\n    \n    const query = this.searchQuery.toLowerCase();\n    return this.users.filter(user => \n      user.name.toLowerCase().includes(query) ||\n      user.specialization?.toLowerCase().includes(query)\n    );\n  }\n\n  private getStatusIcon(status: string): string {\n    switch (status) {\n      case 'active': return '\uD83D\uDFE2';\n      case 'training': return '\uD83D\uDFE1';\n      case 'graduated': return '\uD83C\uDF93';\n      case 'offline': return '\u26AA';\n      default: return '\u2753';\n    }\n  }\n\n  private formatTime(timeStr: string): string {\n    // Simple time formatting - could be enhanced\n    return timeStr;\n  }\n\n  protected setupEventListeners(): void {\n    this.addEventListener('click', this.handleClick.bind(this));\n    this.addEventListener('input', this.handleInput.bind(this));\n    \n    // Listen for persona updates\n    this.notifySystem('personas_updated', () => {\n      this.loadUsers();\n    });\n  }\n\n  private handleClick(event: Event): void {\n    const target = event.target as HTMLElement;\n    const action = target.dataset.action;\n    const userId = target.dataset.userId;\n    \n    switch (action) {\n      case 'toggle':\n        this.toggleCollapse();\n        break;\n      case 'star':\n        this.starUser(userId!);\n        break;\n      case 'more':\n        this.showUserMenu(userId!);\n        break;\n      case 'add-agent':\n        this.addAgent();\n        break;\n      case 'manage':\n        this.openManagement();\n        break;\n      default:\n        // Check if clicking on user item\n        const userItem = target.closest('.user-item') as HTMLElement;\n        if (userItem) {\n          this.selectUser(userItem.dataset.userId!);\n        }\n    }\n  }\n\n  private handleInput(event: Event): void {\n    const target = event.target as HTMLInputElement;\n    if (target.dataset.action === 'search') {\n      this.searchQuery = target.value;\n      this.updateUsersList();\n    }\n  }\n\n  public toggleCollapse(): void {\n    const content = this.shadowRoot?.querySelector('.widget-content') as HTMLElement;\n    const button = this.shadowRoot?.querySelector('.collapse-button') as HTMLElement;\n    \n    if (content && button) {\n      const isCollapsed = content.style.display === 'none';\n      content.style.display = isCollapsed ? 'block' : 'none';\n      button.textContent = isCollapsed ? '\u25BC' : '\u25B2';\n    }\n  }\n\n  private selectUser(userId: string): void {\n    this.selectedUser = userId;\n    this.updateUsersList();\n    \n    // Emit user selection event\n    this.dispatchEvent(new CustomEvent('user-selected', {\n      detail: { userId },\n      bubbles: true\n    }));\n  }\n\n  private starUser(userId: string): void {\n    console.log(`\uD83D\uDC65 Starring user: ${userId}`);\n    // TODO: Implement starring functionality\n  }\n\n  private showUserMenu(userId: string): void {\n    console.log(`\uD83D\uDC65 Showing menu for user: ${userId}`);\n    // TODO: Implement user context menu\n  }\n\n  private addAgent(): void {\n    console.log('\uD83D\uDC65 Adding new agent');\n    // TODO: Implement add agent functionality\n  }\n\n  private openManagement(): void {\n    console.log('\uD83D\uDC65 Opening user management');\n    // TODO: Implement management interface\n  }\n\n  private updateUsersList(): void {\n    const usersList = this.shadowRoot?.querySelector('.users-list');\n    if (usersList) {\n      const filteredUsers = this.getFilteredUsers();\n      usersList.innerHTML = filteredUsers.map(user => this.renderUser(user)).join('');\n    }\n  }\n\n  private updateContent(): void {\n    const container = this.shadowRoot?.querySelector('.users-agents-container');\n    if (container) {\n      container.innerHTML = this.renderOwnContent();\n      this.setupEventListeners();\n    }\n  }\n}\n\n// Register the custom element\ncustomElements.define('user-selector', UsersAgentsWidget);", "/**\n * VersionWidget - Dynamic version display\n * Shows current system version with real-time updates\n */\n\nimport { BaseWidget } from '../shared/BaseWidget';\n\nexport class VersionWidget extends BaseWidget {\n  \n  private currentVersion: string = 'Loading...';\n  private lastUpdate: Date = new Date();\n\n  constructor() {\n    super();\n    this.widgetName = 'VersionWidget';\n    this.widgetIcon = '\uD83C\uDFF7\uFE0F';\n    this.widgetTitle = 'System Version';\n  }\n\n  protected async initializeWidget(): Promise<void> {\n    await this.loadCSS();\n    await this.fetchCurrentVersion(); // Get real version first\n    this.setupVersionMonitoring();\n    this.render();\n  }\n\n  private setupVersionMonitoring(): void {\n    // Listen for version updates\n    document.addEventListener('continuum:version-update', (e: Event) => {\n      const customEvent = e as CustomEvent;\n      this.updateVersion(customEvent.detail.version);\n    });\n\n    // Check for version from continuum API\n    const continuum = (window as any).continuum;\n    if (continuum?.version) {\n      this.currentVersion = continuum.version;\n    }\n\n    // Monitor for version changes every 30 seconds\n    setInterval(() => {\n      this.checkForVersionUpdates();\n    }, 30000);\n  }\n\n  private async fetchCurrentVersion(): Promise<void> {\n    try {\n      const continuum = (window as any).continuum;\n      const result = await continuum.info();\n      this.currentVersion = result.version;\n      this.lastUpdate = new Date();\n    } catch (error) {\n      console.warn('Could not get version:', error);\n      this.currentVersion = 'Unknown';\n    }\n  }\n\n  private async checkForVersionUpdates(): Promise<void> {\n    const previousVersion = this.currentVersion;\n    await this.fetchCurrentVersion();\n    \n    if (this.currentVersion !== previousVersion) {\n      this.render();\n      this.showUpdateAnimation();\n    }\n  }\n\n  private updateVersion(newVersion: string): void {\n    if (newVersion !== this.currentVersion) {\n      console.log(`\uD83C\uDFF7\uFE0F Version: ${this.currentVersion} \u2192 ${newVersion}`);\n      this.currentVersion = newVersion;\n      this.lastUpdate = new Date();\n      this.render();\n      this.showUpdateAnimation();\n    }\n  }\n\n  renderContent(): string {\n    const updateTime = this.lastUpdate.toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n\n    return `\n      <div class=\"version-container\">\n        <div class=\"version-info\">\n          <span class=\"version-label\">v</span>\n          <span class=\"version-number\">${this.currentVersion}</span>\n        </div>\n        <div class=\"version-meta\">\n          <span class=\"last-update\">Updated ${updateTime}</span>\n        </div>\n      </div>\n    `;\n  }\n\n  setupEventListeners(): void {\n    // Click to copy version to clipboard\n    const container = this.shadowRoot?.querySelector('.version-container');\n    if (container) {\n      container.addEventListener('click', () => {\n        this.copyVersionToClipboard();\n      });\n    }\n  }\n\n  private copyVersionToClipboard(): void {\n    const versionText = `Continuum v${this.currentVersion}`;\n    \n    if (navigator.clipboard) {\n      navigator.clipboard.writeText(versionText).then(() => {\n        this.showCopyFeedback();\n      }).catch(err => {\n        console.error('Failed to copy version:', err);\n      });\n    }\n  }\n\n  private showCopyFeedback(): void {\n    const container = this.shadowRoot?.querySelector('.version-container') as HTMLElement;\n    if (container) {\n      container.classList.add('copied');\n      setTimeout(() => {\n        container.classList.remove('copied');\n      }, 1000);\n    }\n  }\n\n  private showUpdateAnimation(): void {\n    const container = this.shadowRoot?.querySelector('.version-container') as HTMLElement;\n    if (container) {\n      container.classList.add('updated');\n      setTimeout(() => {\n        container.classList.remove('updated');\n      }, 600);\n    }\n  }\n}\n\n// Register the custom element\ncustomElements.define('version-widget', VersionWidget);", "\n// Auto-generated widget imports and asset manifest\n// This file is generated by esbuild-widget-discovery-plugin.js\n// Do not edit manually - changes will be overwritten\n\nimport './components/ActiveProjects/ActiveProjectsWidget.ts';\n\nimport './components/Chat/ChatWidget.ts';\n\nimport './components/ChatRoom/ChatRoom.ts';\n\nimport './components/Continuon/ContinuonWidget.ts';\n\nimport './components/Persona/PersonaWidget.ts';\n\nimport './components/SavedPersonas/SavedPersonasWidget.ts';\n\nimport './components/SessionCosts/SessionCostsWidget.ts';\n\nimport './components/Sidebar/SidebarWidget.ts';\n\nimport './components/SidebarHeader/SidebarHeader.ts';\n\nimport './components/SidebarPanelWidget/SidebarPanelWidget.ts';\n\nimport './components/SidebarTabs/SidebarTabs.ts';\n\nimport './components/UsersAgents/UsersAgentsWidget.ts';\n\nimport './components/Version/VersionWidget.ts';\n\n\n// Smart Asset Manifest - Only lists files that actually exist (Zero 404s!)\nexport const WIDGET_ASSETS = {\n  \"ActiveProjectsWidget\": {\n    \"css\": [\n      \"ActiveProjectsWidget.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"ActiveProjects\"\n  },\n  \"ChatWidget\": {\n    \"css\": [\n      \"ChatWidget.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"Chat\"\n  },\n  \"ContinuonWidget\": {\n    \"css\": [\n      \"ContinuonWidget.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"Continuon\"\n  },\n  \"PersonaWidget\": {\n    \"css\": [\n      \"PersonaWidget.css\",\n      \"persona-animations.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"Persona\"\n  },\n  \"SavedPersonasWidget\": {\n    \"css\": [\n      \"SavedPersonas.css\",\n      \"SavedPersonasWidget.css\",\n      \"styles.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"SavedPersonas\"\n  },\n  \"SessionCostsWidget\": {\n    \"css\": [\n      \"SessionCosts.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"SessionCosts\"\n  },\n  \"SidebarWidget\": {\n    \"css\": [\n      \"SidebarWidget.css\"\n    ],\n    \"html\": [\n      \"SidebarWidget.html\"\n    ],\n    \"js\": [],\n    \"directoryName\": \"Sidebar\"\n  },\n  \"SidebarHeader\": {\n    \"css\": [\n      \"SidebarHeader.css\"\n    ],\n    \"html\": [\n      \"SidebarHeader.html\"\n    ],\n    \"js\": [],\n    \"directoryName\": \"SidebarHeader\"\n  },\n  \"SidebarPanelWidget\": {\n    \"css\": [\n      \"SidebarPanelWidget.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"SidebarPanelWidget\"\n  },\n  \"SidebarTabs\": {\n    \"css\": [\n      \"SidebarTabs.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"SidebarTabs\"\n  },\n  \"UsersAgentsWidget\": {\n    \"css\": [\n      \"UsersAgents.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"UsersAgents\"\n  },\n  \"VersionWidget\": {\n    \"css\": [\n      \"VersionWidget.css\"\n    ],\n    \"html\": [],\n    \"js\": [],\n    \"directoryName\": \"Version\"\n  }\n};\n\n// Make WIDGET_ASSETS globally available for widgets\nwindow.WIDGET_ASSETS = WIDGET_ASSETS;\n\nconsole.log('\uD83C\uDFA8 Widget Discovery: 13 widgets registered');\nconsole.log('\uD83D\uDCC1 Asset Manifest: Zero 404s guaranteed!', WIDGET_ASSETS);\n", "/**\n * Continuum Browser Client - Module Entry Point\n * Creates and exports the single global continuum instance\n */\n\nimport { ContinuumBrowserClient } from './ContinuumBrowserClient';\nimport { WidgetServerControls } from '../components/shared/WidgetServerControls';\n\n// Trigger widget discovery plugin to automatically import all widgets\nimport 'widget-discovery';\n\n// Import screenshot client functionality\nimport '../../commands/browser/screenshot/client/ScreenshotClient';\n\n// Create single global instance\nconst continuum = new ContinuumBrowserClient();\n\n// Expose as the ONLY global\n(window as any).continuum = continuum;\n\n// Expose WidgetServerControls for dynamic widget-server integration\n(window as any).WidgetServerControls = WidgetServerControls;\n\nconsole.log('\uD83C\uDF10 Continuum Browser Client: Single global instance created');\nconsole.log('\uD83C\uDFAE Widget Server Controls: Dynamic command discovery system initialized');\n\nexport default continuum;\nexport { ContinuumBrowserClient };\nexport type { ContinuumAPI, ContinuumState, CommandResult } from './types/BrowserClientTypes';\nexport type { WebSocketMessage, ClientInitData, CommandExecuteData } from './types/WebSocketTypes';\nexport type { ConsoleCommand } from './types/ConsoleTypes';"],
  "mappings": "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",
  "names": ["Console", "Level", "result", "generateUUID", "message", "data", "message", "event", "message", "data", "params", "params", "data", "params", "params", "result", "params", "params", "result", "params", "result", "_params", "params", "data", "result", "message", "ArtifactType", "FileSystemOperation", "DirectoryOperation", "params", "operation", "pathUtils", "params", "continuum", "params", "result", "operation", "continuum", "result", "event", "result", "params", "continuum", "params", "message", "result", "event", "continuum", "event", "result", "data", "result", "constructor", "event", "data", "result", "continuum", "message", "params", "data", "continuum", "event", "data", "data", "message", "event", "result", "continuum", "event", "message", "continuum", "data", "data", "event", "result", "event", "message", "continuum", "data", "message", "event", "continuum", "result"]
}
