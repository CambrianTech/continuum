#!/usr/bin/env sh
# CONTINUUM PRE-PUSH VALIDATION: STRICT ENFORCEMENT FOR PRODUCTION
# Once modules graduate, they must remain PERFECT forever

printf "\rContinuum Pre-Push Validation - STRICT ENFORCEMENT\n" >&2
echo "ğŸš€ Production-ready validation - Zero tolerance for regressions"
echo ""

# ğŸ“ GRADUATED MODULES: MUST BE PERFECT FOREVER
echo "ğŸ“ GRADUATED MODULE ENFORCEMENT - Zero tolerance:"
echo "   ğŸ” Checking all graduated modules for regressions..."

# ğŸ¯ PER-MODULE QUALITY ENFORCEMENT (PUSH MODE: Strict)
echo "ğŸ¯ Per-module quality enforcement - STRICT PRODUCTION MODE..."
npm run test:quality:push || {
    echo "âŒ PUSH BLOCKED: Quality standards not met!"
    echo "ğŸ“ Graduated and candidate modules must maintain perfect quality"
    echo "ğŸ’¡ Fix quality issues before pushing to production"
    exit 1
}

# ğŸ§ª INTEGRATION TESTS: PRODUCTION READINESS
echo "ğŸ§ª INTEGRATION TESTS - Production readiness validation:"
npm run test:integration:layer2-3 --silent || {
    echo "âŒ PUSH BLOCKED: Integration test failures detected!"
    echo "ğŸ­ Production requires all integration tests to pass"
    echo "ğŸ’¡ Fix integration issues before pushing"
    exit 1
}

# ğŸ“Š MODULE COMPLIANCE: STRICT VALIDATION
echo "ğŸ“Š MODULE COMPLIANCE - Strict validation:"
npm run test:compliance:strict --silent || {
    echo "âŒ PUSH BLOCKED: Module compliance failures detected!"
    echo "ğŸ¯ Production requires strict module compliance"
    echo "ğŸ’¡ Fix compliance issues or update whitelist appropriately"
    exit 1
}

# âœ… ALL VALIDATIONS PASSED
echo ""
echo "âœ… PRODUCTION VALIDATION COMPLETE!"
echo "ğŸ“ All graduated modules maintain perfect compliance"
echo "ğŸ”§ All graduated directories maintain perfect code quality"
echo "ğŸ§ª All integration tests pass"
echo "ğŸ“Š All module compliance requirements met"
echo ""
echo "ğŸš€ SAFE TO PUSH TO PRODUCTION!"
echo ""