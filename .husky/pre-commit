#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Run TypeScript compilation check first (fastest failure)
echo "ğŸ” Checking TypeScript compilation..."
npx tsc --noEmit --project . || {
    echo "âŒ TypeScript compilation failed! Fix errors before committing."
    exit 1
}

# Run critical integration tests
echo "ğŸ§ª Running integration tests..."
npm run test:integration:all || {
    echo "âŒ Integration tests failed! Fix failing tests before committing."
    exit 1
}

# Run system-level tests
echo "ğŸŒ Running system tests..."
npm run test:system || {
    echo "âŒ System tests failed! Fix failing tests before committing."
    exit 1
}

echo "âœ… All tests passed! Proceeding with commit..."