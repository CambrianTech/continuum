# Run TypeScript compilation check first (fastest failure)
echo "ğŸ” Checking TypeScript compilation..."
npx tsc --noEmit --project . || {
    echo "âš ï¸  TypeScript compilation has errors. Consider fixing them."
    # Don't block commit for now - we're in active development
}

# Run critical integration tests
echo "ğŸ§ª Running core integration tests..."

# Run event bus test (critical for daemon communication)
npm run test:integration:eventbus || {
    echo "âŒ Event bus tests failed! Fix failing tests before committing."
    exit 1
}

# Run module structure test (ensures all daemons are properly configured)
npm run test:integration:modules || {
    echo "âŒ Module structure tests failed! Fix failing tests before committing."
    exit 1
}

# Run type safety test (ensures no 'any' types)
npm run test:integration:types || {
    echo "âŒ Type safety tests failed! Fix failing tests before committing."
    exit 1
}

echo "âœ… Core tests passed! Proceeding with commit..."