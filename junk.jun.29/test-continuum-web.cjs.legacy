#!/usr/bin/env node
/**
 * Test script to verify Continuum web interface is working
 */

const http = require('http');

console.log('üß™ Testing Continuum Web Interface...');

// Test the /ask endpoint
function testWebRequest(task) {
  return new Promise((resolve, reject) => {
    const url = `http://localhost:5555/ask?task=${encodeURIComponent(task)}`;
    
    console.log(`üì® Testing: ${task}`);
    
    http.get(url, (res) => {
      let data = '';
      
      res.on('data', (chunk) => {
        data += chunk;
      });
      
      res.on('end', () => {
        try {
          const result = JSON.parse(data);
          console.log(`‚úÖ Response received:`, {
            role: result.role,
            hasResult: !!result.result,
            resultLength: result.result ? result.result.length : 0,
            cost: result.costs?.total
          });
          resolve(result);
        } catch (error) {
          console.log(`‚ùå Failed to parse response:`, data);
          reject(error);
        }
      });
    }).on('error', (err) => {
      console.log(`‚ùå Request failed:`, err.message);
      reject(err);
    });
  });
}

async function runTests() {
  try {
    console.log('‚è∞ Waiting 2 seconds for server to be ready...');
    await new Promise(resolve => setTimeout(resolve, 2000));
    
    // Test 1: Simple task (should go to PlannerAI with new routing)
    await testWebRequest('hello');
    
    // Test 2: Complex task (should definitely go to PlannerAI)
    await testWebRequest('how does this system work?');
    
    // Test 3: Code task (should go to CodeAI)
    await testWebRequest('write some code');
    
    // Test 4: System awareness (should coordinate multiple AIs)
    await testWebRequest('who are you all?');
    
    console.log('üéâ All tests completed!');
  } catch (error) {
    console.error('‚ùå Test failed:', error.message);
  }
}

runTests();