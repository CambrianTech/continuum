{
  "name": "code/task",
  "description": "Execute a coding task end-to-end via the coding agent pipeline. Formulates a plan using LLM reasoning, enforces security tiers, and executes steps via code/* commands. Supports dry-run mode, governance approval for high-risk plans, and multi-agent delegation.",
  "params": [
    {
      "name": "description",
      "type": "string",
      "optional": false,
      "description": "What the coding task should accomplish (natural language)"
    },
    {
      "name": "taskType",
      "type": "string",
      "optional": true,
      "description": "Task type for model selection: 'planning' | 'generation' | 'editing' | 'review' | 'quick-fix' | 'discovery'. Defaults to 'generation'"
    },
    {
      "name": "relevantFiles",
      "type": "string[]",
      "optional": true,
      "description": "File paths already known to be relevant (hints for discovery phase)"
    },
    {
      "name": "dryRun",
      "type": "boolean",
      "optional": true,
      "description": "Execute read-only commands normally but mock writes. Returns predicted changes without modifying files"
    },
    {
      "name": "securityTier",
      "type": "string",
      "optional": true,
      "description": "Override security tier: 'discovery' | 'read' | 'write' | 'system'. Defaults to plan's assessed risk level"
    },
    {
      "name": "delegationEnabled",
      "type": "boolean",
      "optional": true,
      "description": "Enable multi-agent delegation for parallel execution across file clusters"
    },
    {
      "name": "maxDurationMs",
      "type": "number",
      "optional": true,
      "description": "Maximum execution time in milliseconds (default: 120000)"
    },
    {
      "name": "maxToolCalls",
      "type": "number",
      "optional": true,
      "description": "Maximum number of tool calls allowed (default: 15)"
    }
  ],
  "results": [
    {
      "name": "status",
      "type": "string",
      "description": "Overall status: 'completed' | 'partial' | 'failed' | 'budget_exceeded' | 'pending_approval'"
    },
    {
      "name": "summary",
      "type": "string",
      "description": "Human-readable summary of what was accomplished"
    },
    {
      "name": "planSummary",
      "type": "string",
      "description": "The LLM-generated plan summary"
    },
    {
      "name": "riskLevel",
      "type": "string",
      "description": "Assessed risk level: 'low' | 'medium' | 'high' | 'critical'"
    },
    {
      "name": "securityTier",
      "type": "string",
      "description": "Security tier used for execution"
    },
    {
      "name": "stepsTotal",
      "type": "number",
      "description": "Total number of steps in the plan"
    },
    {
      "name": "stepsCompleted",
      "type": "number",
      "description": "Number of steps that completed successfully"
    },
    {
      "name": "filesModified",
      "type": "string[]",
      "description": "Files that were modified during execution"
    },
    {
      "name": "filesCreated",
      "type": "string[]",
      "description": "Files that were created during execution"
    },
    {
      "name": "totalToolCalls",
      "type": "number",
      "description": "Total tool calls used"
    },
    {
      "name": "totalDurationMs",
      "type": "number",
      "description": "Total execution time in milliseconds"
    },
    {
      "name": "changeIds",
      "type": "string[]",
      "description": "Change IDs from file operations (for potential undo)"
    },
    {
      "name": "errors",
      "type": "string[]",
      "description": "Errors encountered during execution"
    },
    {
      "name": "proposalId",
      "type": "string",
      "description": "Governance proposal ID if plan requires approval (status='pending_approval')"
    }
  ],
  "examples": [
    {
      "description": "Simple code edit task",
      "command": "./jtag code/task --description=\"Add input validation to the login function in auth.ts\"",
      "expectedResult": "{ status: \"completed\", stepsCompleted: 3, filesModified: [\"auth.ts\"] }"
    },
    {
      "description": "Dry run to preview changes",
      "command": "./jtag code/task --description=\"Refactor UserService to use dependency injection\" --dryRun=true",
      "expectedResult": "{ status: \"completed\", filesModified: [], summary: \"Dry run: would modify 3 files\" }"
    },
    {
      "description": "Discovery-only task",
      "command": "./jtag code/task --description=\"Find all files using deprecated API\" --taskType=\"discovery\" --securityTier=\"discovery\"",
      "expectedResult": "{ status: \"completed\", stepsCompleted: 2, filesModified: [] }"
    },
    {
      "description": "With relevant file hints",
      "command": "./jtag code/task --description=\"Fix the off-by-one error\" --relevantFiles='[\"src/utils/pagination.ts\"]'",
      "expectedResult": "{ status: \"completed\", filesModified: [\"src/utils/pagination.ts\"] }"
    }
  ],
  "accessLevel": "ai-safe",
  "environment": "server"
}
