/**
 * {{WIDGET_NAME}}Widget - {{DESCRIPTION}}
 *
 * Structure:
 * - public/{{KEBAB_NAME}}-widget.html - Template
 * - public/{{KEBAB_NAME}}-widget.scss - Styles (compiled to .css)
 * - {{WIDGET_NAME}}Widget.ts - Logic (this file)
 *
 * Generated by WidgetGenerator
 */

import { BaseWidget } from '../shared/BaseWidget';
import { PositronWidgetState } from '../shared/services/state/PositronWidgetState';

export class {{WIDGET_NAME}}Widget extends BaseWidget {
  constructor() {
    super({
      widgetName: '{{WIDGET_NAME}}Widget',
      template: '{{KEBAB_NAME}}-widget.html',
      styles: '{{KEBAB_NAME}}-widget.css',
      enableAI: false,
      enableDatabase: false,
      enableRouterEvents: false,
      enableScreenshots: false
    });
  }

  protected async onWidgetInitialize(): Promise<void> {
    console.log('ðŸ”§ {{WIDGET_NAME}}Widget: Initializing...');
    this.emitPositronContext();
  }

  /**
   * Override path resolution - directory is '{{KEBAB_NAME}}' (kebab-case)
   */
  protected resolveResourcePath(filename: string): string {
    return `widgets/{{KEBAB_NAME}}/public/${filename}`;
  }

  private emitPositronContext(): void {
    PositronWidgetState.emit(
      {
        widgetType: '{{KEBAB_NAME}}',
        title: '{{DISPLAY_NAME}}',
        metadata: {}
      },
      { action: 'viewing', target: '{{DISPLAY_NAME_LOWER}}' }
    );
  }

  protected async renderWidget(): Promise<void> {
    // Inject loaded template and styles into shadow DOM
    if (this.shadowRoot && (this.templateHTML || this.templateCSS)) {
      const styleTag = this.templateCSS ? `<style>${this.templateCSS}</style>` : '';
      this.shadowRoot.innerHTML = styleTag + (this.templateHTML || '');
    }

    // Render dynamic content
    this.renderContent();

    // Set up event listeners after DOM is ready
    this.setupEventListeners();
  }

  private renderContent(): void {
    // TODO: Implement dynamic content rendering
    // Example: this.shadowRoot?.querySelector('.content')?.innerHTML = '...';
  }

  private setupEventListeners(): void {
    // TODO: Add event listeners for widget interactions
    // Example:
    // this.shadowRoot?.querySelector('#my-button')?.addEventListener('click', () => {
    //   this.handleClick();
    // });
  }

  protected async onWidgetCleanup(): Promise<void> {
    console.log('ðŸ§¹ {{WIDGET_NAME}}Widget: Cleanup complete');
  }
}

// Registration handled by centralized BROWSER_WIDGETS registry
