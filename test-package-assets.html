<!DOCTYPE html>
<html>
<head>
    <title>Test Package.json Asset System</title>
</head>
<body>
    <h1>Testing Package.json Asset System</h1>
    <div id="test-results"></div>
    
    <script type="module">
        // Test the asset system directly
        async function testAssetSystem() {
            const results = document.getElementById('test-results');
            
            // Test 1: Can we read the ChatWidget package.json?
            try {
                const response = await fetch('/src/ui/components/Chat/package.json');
                if (response.ok) {
                    const packageData = await response.json();
                    results.innerHTML += `<p>âœ… Package.json loaded: ${JSON.stringify(packageData.files)}</p>`;
                    
                    // Test 2: Are the assets accessible?
                    if (packageData.files) {
                        for (const file of packageData.files) {
                            if (!file.endsWith('.ts')) {
                                const assetPath = `/dist/ui/components/Chat/${file}`;
                                try {
                                    const assetResponse = await fetch(assetPath);
                                    if (assetResponse.ok) {
                                        results.innerHTML += `<p>âœ… Asset accessible: ${assetPath}</p>`;
                                    } else {
                                        results.innerHTML += `<p>âŒ Asset not found: ${assetPath} (${assetResponse.status})</p>`;
                                    }
                                } catch (error) {
                                    results.innerHTML += `<p>âŒ Asset error: ${assetPath} - ${error.message}</p>`;
                                }
                            }
                        }
                    }
                } else {
                    results.innerHTML += `<p>âŒ Package.json not accessible: ${response.status}</p>`;
                }
            } catch (error) {
                results.innerHTML += `<p>âŒ Package.json error: ${error.message}</p>`;
            }
            
            // Test 3: Load the actual widget and check if it uses assets
            try {
                results.innerHTML += `<h2>Loading ChatWidget to test asset system...</h2>`;
                
                // Import the ChatWidget
                const { ChatWidget } = await import('/dist/ui/components/Chat/ChatWidget.js');
                results.innerHTML += `<p>âœ… ChatWidget imported successfully</p>`;
                
                // Test the static methods
                const basePath = ChatWidget.getBasePath();
                results.innerHTML += `<p>ğŸ“ Base path: ${basePath}</p>`;
                
                const widgetFiles = await ChatWidget.getWidgetFiles();
                results.innerHTML += `<p>ğŸ“¦ Widget files: ${JSON.stringify(widgetFiles)}</p>`;
                
                const widgetAssets = await ChatWidget.getWidgetAssets();
                results.innerHTML += `<p>ğŸ¨ Widget assets: ${JSON.stringify(widgetAssets)}</p>`;
                
                // Test creating the widget
                const widget = new ChatWidget();
                document.body.appendChild(widget);
                results.innerHTML += `<p>âœ… ChatWidget created and added to DOM</p>`;
                
            } catch (error) {
                results.innerHTML += `<p>âŒ Widget test error: ${error.message}</p>`;
            }
        }
        
        // Run the tests
        testAssetSystem();
    </script>
</body>
</html>