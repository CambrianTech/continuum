#!/usr/bin/env node

/**
 * JTAG - Simple Widget Analysis Tool
 * ==================================
 * Provides browser JTAG probe command (no browser launching)
 */

const commands = {
  help() {
    console.log(`
üõ∏ JTAG - Widget Analysis Tool

Usage: ./jtag <command>

Commands:
  widgets                    Show browser JTAG command for widget analysis
  probe                      Show browser JTAG command for custom probing
  help                       Show this help

Note: Use 'npm jtag' to start system + get JTAG commands
      Use './jtag widgets' if system already running

Browser Command (copy to DevTools):
  fetch("/src/ui/jtag-probe.js").then(r=>r.text()).then(eval)
`);
  },

  widgets() {
    console.log('üõ∏ JTAG Widget Analysis');
    console.log('=======================');
    console.log('');
    console.log('1. Ensure system is running (npm start or npm jtag)');
    console.log('2. Open browser DevTools (F12)');
    console.log('3. Paste this command:');
    console.log('');
    console.log('   fetch("/src/ui/jtag-probe.js").then(r=>r.text()).then(eval)');
    console.log('');
    console.log('This will analyze all widget shadow DOM states.');
  },

  probe() {
    console.log('üõ∏ JTAG Custom Probe');
    console.log('====================');
    console.log('');
    console.log('Available browser commands:');
    console.log('');
    console.log('  window.jtag.widgets()     - Widget analysis');
    console.log('  window.jtag.shadowDOM()   - Shadow DOM analysis');
    console.log('  window.jtag.health()      - System health check');
    console.log('  window.jtag.network()     - Network status');
    console.log('  window.jtag.performance() - Performance metrics');
    console.log('');
    console.log('Example: window.jtag.widgets({ autoLog: true })');
  }
};

// Parse command line
const [,, command] = process.argv;

if (!command || command === 'help') {
  commands.help();
} else if (commands[command]) {
  commands[command]();
} else {
  console.log(`‚ùå Unknown command: ${command}`);
  console.log('Run ./jtag help for available commands');
  process.exit(1);
}